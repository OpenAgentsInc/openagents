appId: com.openagents.app
name: Bridge Connect (Manual Host/Token)
---
- launchApp
- openLink: "exp://localhost:8081"
- runFlow:
    when:
      visible:
        id: header-menu-button
    commands:
      - tapOn:
          id: header-menu-button
      - extendedWaitUntil:
          visible:
            id: drawer-settings
          timeout: 30000
      - tapOn:
          id: drawer-settings
- runFlow:
    when:
      notVisible:
        id: settings-status
    commands:
      - openLink: "exp://localhost:8081/--/settings"
  - extendedWaitUntil:
      visible:
        id: settings-status
      timeout: 90000
  - runFlow:
      when:
        notVisible:
          id: settings-status
      commands:
        - runFlow:
            when:
              visible:
                id: header-menu-button
            commands:
              - tapOn:
                  id: header-menu-button
              - extendedWaitUntil:
                  visible:
                    id: drawer-settings
                  timeout: 30000
              - tapOn:
                  id: drawer-settings
        - extendedWaitUntil:
            visible:
              id: settings-status
            timeout: 90000
- extendedWaitUntil:
    visible:
      id: settings-status
    timeout: 90000
# Fill host and token (from user-provided bridge)
- tapOn:
    id: settings-host-input
- inputText:
    id: settings-host-input
    text: "192.168.1.11:8788"
- tapOn:
    id: settings-token-input
- inputText:
    id: settings-token-input
    text: "2d716c46ffb7b1c788db80b8cc21a027101dfad9372659339a48bd0d48ddf7ce"
- tapOn:
    id: settings-apply
- runFlow:
    when:
      visible:
        id: settings-connect
    commands:
      - tapOn:
          id: settings-connect
# Accept either Connected pill or header indicator as success
- extendedWaitUntil:
    visible:
      id: header-connection-indicator
    timeout: 120000
