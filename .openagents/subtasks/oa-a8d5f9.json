{
  "taskId": "oa-a8d5f9",
  "taskTitle": "Integrate HUD server into mainview/index.ts",
  "subtasks": [
    {
      "id": "oa-a8d5f9-sub-001",
      "description": "Implement: Integrate HUD server into mainview/index.ts\n\nStart HUD WebSocket server in Electrobun mainview and wire messages to UI state.\n\n## File: src/mainview/index.ts\n\n## Changes\n\n### 1. Import and start server\n```typescript\nimport { startHudServer, type HudMessage } from \"../hud/index.js\";\n\n// Start HUD server on app init\nconst hudServer = startHudServer({\n  port: 4242,\n  onMessage: handleHudMessage,\n  onAgentConnect: (agentId) => console.log(`Agent connected: ${agentId}`),\n  onAgentDisconnect: (agentId) => console.log(`Agent disconnected: ${agentId}`),\n});\n```\n\n### 2. Handle incoming messages\n```typescript\nfunction handleHudMessage(msg: HudMessage, agentId: string) {\n  switch (msg.type) {\n    case \"task_selected\":\n      updateCurrentTask(msg.taskId, msg.title);\n      break;\n    case \"subtask_start\":\n      addSubtaskToLog(msg.subtaskId, msg.description);\n      break;\n    case \"subtask_complete\":\n      markSubtaskComplete(msg.subtaskId, msg.success);\n      break;\n    case \"text\":\n      appendStreamingText(msg.text);\n      break;\n    case \"tool_call\":\n      addToolCallToLog(msg.tool, msg.input);\n      break;\n    // ... handle other message types\n  }\n}\n```\n\n### 3. Remove polling\nReplace the existing 5-second polling mechanism with message-driven updates.\n\n### 4. Graceful shutdown\n```typescript\n// On app exit\nhudServer.stop();\n```\n\n## UI Updates to Consider\n- Real-time event log panel\n- Streaming text output area\n- Tool call visualization\n- Task/subtask progress indicators\n- Agent connection status\n\n## Reference\n- Current mainview state management\n- src/flow/mechacoder-state.ts for state loading patterns\n- HUD server API from src/hud/server.ts",
      "status": "done",
      "startedAt": "2025-12-03T08:11:54.731Z",
      "claudeCode": {
        "sessionId": "c2c4bf12-233f-466d-bba0-154efe63360e"
      },
      "completedAt": "2025-12-03T08:13:31.693Z"
    }
  ],
  "createdAt": "2025-12-03T08:11:54.731Z",
  "updatedAt": "2025-12-03T08:11:54.731Z"
}