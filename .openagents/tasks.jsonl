{"id":"oa-281868","title":"Implement tasks CLI (tasks:init, tasks:list, tasks:ready)","description":"Create a CLI wrapper around TaskService/ProjectService for external agents.\n\nCommands to implement:\n- tasks:init - Initialize .openagents for a repo\n- tasks:list - List tasks with filters, output JSON\n- tasks:ready - List ready tasks (no open blockers)\n\nThe CLI should accept flags and output JSON for machine parsing.\nSee docs/mechacoder/TASK-SPEC.md for full spec.","status":"closed","priority":1,"type":"task","labels":["cli","task-system"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-02T18:36:30.684Z","updatedAt":"2025-12-02T18:36:54.515Z","closedAt":"2025-12-02T18:36:54.515Z","closeReason":"Implemented tasks CLI with init, list, ready, next, create, update commands"}
{"id":"oa-ab3cfc","title":"Implement tasks CLI (tasks:next, tasks:create, tasks:update)","description":"Continue CLI implementation with remaining commands:\n\n- tasks:next - Atomically pick next ready task, mark in_progress, return it\n- tasks:create - Create new task from flags or JSON stdin\n- tasks:update - Update/close task from JSON stdin\n\nThese commands enable external agents (Claude Code, Codex) to interact with the task system.\nSee docs/mechacoder/TASK-SPEC.md for full spec.","status":"closed","priority":1,"type":"task","labels":["cli","task-system"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-02T18:36:30.686Z","updatedAt":"2025-12-02T18:36:54.667Z","closedAt":"2025-12-02T18:36:54.667Z","closeReason":"Implemented tasks CLI with init, list, ready, next, create, update commands"}
{"id":"oa-a2d2a1","title":"Add package.json scripts for tasks CLI","description":"Add npm scripts to package.json for the tasks CLI:\n\n```json\n{\n  \"scripts\": {\n    \"tasks:init\": \"bun src/tasks/cli.ts init\",\n    \"tasks:list\": \"bun src/tasks/cli.ts list\",\n    \"tasks:ready\": \"bun src/tasks/cli.ts ready\",\n    \"tasks:next\": \"bun src/tasks/cli.ts next\",\n    \"tasks:create\": \"bun src/tasks/cli.ts create\",\n    \"tasks:update\": \"bun src/tasks/cli.ts update\"\n  }\n}\n```\n\nThis enables external agents to use `bun run tasks:*` commands.","status":"closed","priority":2,"type":"task","labels":["cli","task-system"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-02T18:36:30.686Z","updatedAt":"2025-12-02T18:36:54.827Z","closedAt":"2025-12-02T18:36:54.827Z","closeReason":"Added package.json scripts for tasks CLI"}
{"id":"oa-ba2bbc","title":"Document task CLI usage in AGENTS.md","description":"Add a section to AGENTS.md explaining how to use the tasks CLI:\n\n- When to use CLI vs TaskService directly\n- Example commands for external agents\n- JSON input/output formats\n- Link to TASK-SPEC.md for full details","status":"closed","priority":2,"type":"task","labels":["docs","task-system"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-02T18:36:30.687Z","updatedAt":"2025-12-02T18:36:55.023Z","closedAt":"2025-12-02T18:36:55.023Z","closeReason":"Documented task CLI usage in AGENTS.md"}
{"id":"oa-c9003e","title":"Add OPENAGENTS-TASKS-SPEC link to mechacoder README","description":"","status":"closed","priority":2,"type":"task","labels":["docs","mechacoder"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-02T18:44:57.396Z","updatedAt":"2025-12-02T18:53:50.622Z","closedAt":"2025-12-02T18:53:50.622Z","closeReason":"Added TASK-SPEC.md link to mechacoder README"}
{"id":"oa-c9db6e","title":"Add example do-one-task usage to MECHACODER-OPS","description":"","status":"closed","priority":2,"type":"task","labels":["docs","mechacoder"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-02T18:44:57.585Z","updatedAt":"2025-12-02T18:53:50.814Z","closedAt":"2025-12-02T18:53:50.814Z","closeReason":"Added do-one-task and overnight examples to MECHACODER-OPS quick reference"}
{"id":"oa-73016a","title":"Add minimal MechaCoder desktop demo task for Golden Loop v2","description":"Create a simple demo task that MechaCoder can complete to prove Golden Loop v2 works. This could be adding a trivial comment or updating a version string.","status":"closed","priority":1,"type":"task","labels":["golden-loop","demo"],"deps":[],"commits":["8b17612185f12efc664aea29f9d6a28fa08aa5fb"],"comments":[],"createdAt":"2025-12-02T18:44:57.770Z","updatedAt":"2025-12-02T18:50:09.431Z","closedAt":"2025-12-02T18:50:09.431Z","closeReason":"Golden Loop v2 demo completed - version bump in package.json and electrobun.config.ts"}
{"id":"oa-b78d3f","title":"HUD-1: Flow model types + sample data","description":"Define FlowNode/PositionedNode/Connection/Point and related types in src/flow/model.ts. Add src/flow/sample-data.ts with a MechaCoder factory tree matching docs/hud/flow.md (root -> MechaCoder -> repos -> tasks -> phases).","status":"closed","priority":1,"type":"task","labels":["hud","flow","model"],"deps":[],"commits":["35f8d4e5fd9c93902731fa6f8cf46bf2007ec117"],"comments":[],"createdAt":"2025-12-02T19:14:00.804Z","updatedAt":"2025-12-02T19:21:31.247Z","closedAt":"2025-12-02T19:21:31.247Z","closeReason":"Implemented Flow model types + sample data"}
{"id":"oa-138548","title":"HUD-2: Flow layout engine (calculateLayout)","description":"Implement src/flow/layout.ts with calculateLayout(LayoutInput): LayoutOutput. Use LayoutConfig + Direction, compute subtree sizes and positions, and produce nodes + connections. Fail-fast on missing sizes or invalid trees. Add unit tests for small sample trees.","status":"closed","priority":1,"type":"task","labels":["hud","flow","layout"],"deps":[],"commits":["29e84b304dd0f0eef1c09ce8089a8629262c2b08"],"comments":[],"createdAt":"2025-12-02T19:14:00.953Z","updatedAt":"2025-12-02T19:51:20.490Z","closedAt":"2025-12-02T19:51:20.490Z","closeReason":"Implemented Flow layout engine with calculateLayout function and 9 unit tests"}
{"id":"oa-91a779","title":"HUD-3: Flow connection path builder","description":"Implement src/flow/path.ts with buildRoundedPath(points, config) -> SVG path string. Detect corners and apply cornerRadius. Add tests with snapshot-style assertions for simple polylines.","status":"closed","priority":2,"type":"task","labels":["hud","flow","path"],"deps":[],"commits":["02ee7a5266619ecb62b8e4663222aa306164b89c"],"comments":[],"createdAt":"2025-12-02T19:14:01.109Z","updatedAt":"2025-12-02T20:19:05.676Z","closedAt":"2025-12-02T20:19:05.676Z","closeReason":"Implemented buildRoundedPath for SVG path generation with rounded corners"}
{"id":"oa-5fc569","title":"HUD-4: Canvas state reducer (pan/zoom)","description":"Implement src/flow/canvas.ts with CanvasState/CanvasEvent/CanvasConfig and reduceCanvasState. Support PAN_START/PAN_MOVE/PAN_END/ZOOM/RESET and basic inertial panning. Add tests for zoom-around-pointer and pan behavior.","status":"closed","priority":2,"type":"task","labels":["hud","flow","canvas"],"deps":[],"commits":["4b0b01261c57364603d8d84e0f1a3f30db023204"],"comments":[],"createdAt":"2025-12-02T19:14:01.266Z","updatedAt":"2025-12-02T20:56:46.789Z","closedAt":"2025-12-02T20:56:46.789Z","closeReason":"Implemented canvas reducer with pan/zoom/inertia"}
{"id":"oa-6ee331","title":"HUD-5: MechaCoder state to FlowNode tree","description":"Implement src/flow/mechacoder-map.ts. Define MechaCoderState (derived from .openagents/tasks.jsonl + recent run logs) and buildMechaCoderFlowTree(state): FlowNode. Add fixtures/tests that mirror the example tree in docs/hud/flow.md.","status":"closed","priority":2,"type":"task","labels":["hud","flow","mechacoder"],"deps":[],"commits":["c9294e6c44a1d55624e5575a32066c1cd6bbd4b8"],"comments":[],"createdAt":"2025-12-02T19:14:01.418Z","updatedAt":"2025-12-02T21:00:24.072Z","closedAt":"2025-12-02T21:00:24.072Z","closeReason":"Implemented MechaCoder state to FlowNode tree mapping"}
{"id":"oa-4e4f76","title":"HUD-6: Minimal SVG host renderer for Flow layout","description":"Implement src/flow-host-svg/render.ts that takes LayoutOutput + CanvasState and returns a minimal SVG representation (nodes as boxes, connections as paths). No React required; pure functions returning descriptor objects. Add example usage wired to sample-data.ts.","status":"closed","priority":3,"type":"task","labels":["hud","flow","host","svg"],"deps":[],"commits":["39a18b3e03138d5db4b05e5be9c040feafc9d730"],"comments":[],"createdAt":"2025-12-02T19:14:01.569Z","updatedAt":"2025-12-02T21:03:53.959Z","closedAt":"2025-12-02T21:03:53.959Z","closeReason":"Implemented minimal SVG host renderer"}
{"id":"oa-5b9b22","title":"HUD-docs: add Flow section link to README","description":"Update README.md to add a link to the HUD spec (docs/hud/flow.md) under a new 'HUD Flow Editor' section. Just add a one-line description and a link, nothing fancy.","status":"closed","priority":2,"type":"task","labels":["hud","docs"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-02T20:06:04.357Z","updatedAt":"2025-12-02T20:19:05.830Z","closedAt":"2025-12-02T20:19:05.830Z","closeReason":"Superseded - used HUD-3 for testing instead"}
{"id":"oa-98ee2b","title":"HUD-7: Integrate flow HUD into Electrobun mainview","description":"Wire the flow HUD into the desktop app so it renders in the Electrobun mainview. Use the layout/path/canvas/mechacoder-map modules to render either sample-data.ts or the live MechaCoder state tree. Include a minimal SVG host view with pan/zoom and rounded connection paths, and a simple entry point in src/mainview that mounts the renderer and shows the HUD on app launch. Verify it runs under the dev build.","status":"closed","priority":2,"type":"feature","labels":["hud","ui","flow","electrobun"],"deps":[{"id":"oa-6ee331","type":"blocks"},{"id":"oa-4e4f76","type":"blocks"}],"commits":["f4e34d3826e516bef48fcff826e23b946cb0cb60"],"comments":[],"createdAt":"2025-12-02T21:01:38.081Z","updatedAt":"2025-12-02T21:09:52.236Z","closedAt":"2025-12-02T21:09:52.236Z","closeReason":"Integrated flow HUD into Electrobun mainview with pan/zoom"}
{"id":"oa-1a7f58","title":"HUD-8: MechaCoder state snapshot from .openagents","description":"Build a MechaCoder state loader that reads real project data (at least .openagents/tasks.jsonl and recent docs/logs run logs) and produces a MechaCoderState object usable by mechacoder-map/buildMechaCoderFlowTree. Include task status rollups, deps, and last-run info where available. Expose a function/service that returns the latest snapshot (poll or on-demand) for consumption by the HUD.","status":"closed","priority":1,"type":"feature","labels":["hud","flow","mechacoder","data"],"deps":[{"id":"oa-6ee331","type":"blocks"}],"commits":["8cb2bc78763fa3bfd1341dba7da5ebd30bb63af1"],"comments":[],"createdAt":"2025-12-02T21:02:03.082Z","updatedAt":"2025-12-02T23:24:23.214Z","closedAt":"2025-12-02T23:24:23.214Z","closeReason":"Added MechaCoder state snapshot loader for HUD"}
{"id":"oa-924781","title":"HUD-9: Live HUD data pipeline in Electrobun","description":"Plumb the MechaCoder state snapshot into the Electrobun mainview HUD so it reflects real data instead of sample trees. Wire the state loader (HUD-8) into the mainview integration (HUD-7), add polling or file-watch over .openagents/tasks.jsonl and docs/logs to refresh, and update the SVG host when state changes. Ensure it degrades gracefully if files are missing and verify the HUD shows current tasks/phases when running the app in dev mode.","status":"closed","priority":1,"type":"feature","labels":["hud","ui","flow","electrobun","mechacoder"],"deps":[{"id":"oa-98ee2b","type":"blocks"},{"id":"oa-1a7f58","type":"blocks"},{"id":"oa-6ee331","type":"blocks"},{"id":"oa-4e4f76","type":"blocks"}],"commits":["d6f6875c48ed9927e0d672f0268a17dd77468912"],"comments":[],"createdAt":"2025-12-02T21:02:09.498Z","updatedAt":"2025-12-02T23:29:36.678Z","closedAt":"2025-12-02T23:29:36.678Z","closeReason":"Live HUD uses MechaCoder state loader"}
{"id":"oa-b18af7","title":"HUD-7a: Polish flow HUD styling","description":"","status":"closed","priority":1,"type":"task","labels":["hud","styling"],"deps":[],"commits":["20eb54b06ad82cea9ae35af23be7da27d749fd06"],"comments":[],"createdAt":"2025-12-02T21:21:14.009Z","updatedAt":"2025-12-02T21:21:36.840Z","closedAt":"2025-12-02T21:21:36.840Z","closeReason":"Polished styling with Unkey-inspired theme"}
{"id":"oa-8052d4","title":"HUD-7b: Revamp flow node styling closer to Unkey","description":"Improve HUD node visuals to match Unkey’s flow editor: redesign node cards, connection styling, and backgrounds; add grid background similar to Unkey; reference external designs (unkey repo docs/flow-editor-architecture.md, flow-editor-summary.md, and oapreclean AgentNode component) and build updated look for nodes.","status":"closed","priority":1,"type":"task","labels":["hud","ui","styling"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-02T21:27:34.422Z","updatedAt":"2025-12-02T21:32:53.844Z","closedAt":"2025-12-02T21:32:53.844Z","closeReason":"Revamped flow HUD nodes to Unkey-inspired cards with dotted grid background and updated styling"}
{"id":"oa-4a5050","title":"HUD-7c: Increase HUD spacing and disable text selection on pan","description":"Address layout overlap and text selection during canvas drag: increase layout spacing/padding so nodes are not stacked, and ensure dragging the canvas does not select node text.","status":"closed","priority":1,"type":"task","labels":["hud","ui","styling"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-02T21:36:36.564Z","updatedAt":"2025-12-02T22:21:31.279Z","closedAt":"2025-12-02T22:21:31.279Z","closeReason":"Reduced padding to 12 and enlarged root node to avoid negative content; spacing 220 preserved"}
{"id":"oa-d0a323","title":"Validate .openagents task system and close openagents-5bb","description":"Verify the .openagents task substrate matches the spec: inspect TaskService/ProjectService/ID/Init/BeadsConverter, run bun test, and smoke-test the init CLI in a throwaway directory. Optionally exercise the beads converter against .beads/issues.jsonl. If everything matches NEXT-INSTRUCTIONS, document the checks in logs and close the legacy openagents-5bb epic without changing schema.","status":"closed","priority":1,"type":"task","labels":["task-system","mechacoder","golden-loop","ops"],"deps":[],"commits":["c275c43028c35ff9441de7cbd5d651812b6b56e7"],"comments":[],"createdAt":"2025-12-02T23:17:36.147Z","updatedAt":"2025-12-02T23:31:33.710Z","closedAt":"2025-12-02T23:31:33.710Z","closeReason":"Verified .openagents task system, init CLI smoke test, tests green"}
{"id":"oa-721753","title":"openagents-42j: Autonomous coding agent infrastructure","description":"Migrate the openagents-42j bead plan into .openagents tasks. Deliver the Golden Loop-friendly sequencing from NEXT-INSTRUCTIONS: core tools (grep/find/ls), tool schema/provider abstraction, provider adapters (Anthropic/OpenAI/Gemini), streaming partial tool args, token/cost accounting, and cleanup/type-fix tasks. Maintain the no-questions-asked workflow and keep tests green.","status":"closed","priority":1,"type":"epic","labels":["openagents-42j","mechacoder","golden-loop","infra","tools","llm"],"deps":[{"id":"oa-d0a323","type":"blocks"}],"commits":["1b6f578e865c2d4a6508a32f88f89c193cf70c47"],"comments":[],"createdAt":"2025-12-02T23:17:41.209Z","updatedAt":"2025-12-02T23:34:09.323Z","closedAt":"2025-12-02T23:34:09.323Z","closeReason":"openagents-42j bead plan migrated into .openagents tasks; sequencing captured"}
{"id":"oa-0a46dd","title":"openagents-42j.4: audit/port grep tool to Effect","description":"Ensure the grep tool matches the 42j.4 plan: Effect-based implementation, robust error handling, and tests similar to read/edit/write tools. Verify existing code against NEXT-INSTRUCTIONS, add coverage or fixes if needed, and close as done if already clean.","status":"closed","priority":3,"type":"task","labels":["openagents-42j","tools","search","mechacoder"],"deps":[{"id":"oa-d0a323","type":"blocks"},{"id":"oa-721753","type":"related"}],"commits":[],"comments":[],"createdAt":"2025-12-02T23:17:55.115Z","updatedAt":"2025-12-02T23:59:01.712Z","closedAt":"2025-12-02T23:59:01.712Z","closeReason":"Grep tool already Effect-based with tests; no changes needed"}
{"id":"oa-3fdf42","title":"openagents-42j.5: audit/port find tool to Effect","description":"Verify the find tool from 42j.5 is implemented with Effect patterns, recursive file discovery, limits, and solid tests. Bring it to parity with NEXT-INSTRUCTIONS and close as completed/no-op if already correct.","status":"closed","priority":3,"type":"task","labels":["openagents-42j","tools","filesystem","mechacoder"],"deps":[{"id":"oa-d0a323","type":"blocks"},{"id":"oa-721753","type":"related"}],"commits":[],"comments":[],"createdAt":"2025-12-02T23:18:00.479Z","updatedAt":"2025-12-02T23:59:54.054Z","closedAt":"2025-12-02T23:59:54.054Z","closeReason":"Find tool already Effect-based with tests; no changes needed"}
{"id":"oa-3e4265","title":"HUD-7d: Improve stacked node readability","description":"Improve readability when multiple nodes stack vertically (agent->repo->tasks) by adjusting renderer/layout: avoid text overlap, add per-level spacing rules or alternating alignment, and ensure connections don’t obscure labels. Investigate vertical stack readability in current HUD view (agent/repos/tasks tree) and propose/layout fixes.","status":"closed","priority":1,"type":"task","labels":["hud","ui","layout"],"deps":[],"commits":["86f832c4a6d451144af80a2d1a0418a92f220afa"],"comments":[],"createdAt":"2025-12-02T23:18:05.293Z","updatedAt":"2025-12-02T23:35:50.018Z","closedAt":"2025-12-02T23:35:50.018Z","closeReason":"Increased HUD spacing to avoid stacked node overlap"}
{"id":"oa-b9c06b","title":"openagents-42j.6: audit/port ls tool to Effect","description":"Confirm the ls tool meets 42j.6 expectations: directory listing with recursion/hidden toggles, Effect error handling, and tests aligned with read/write/grep patterns. Patch gaps if any and close if already satisfied.","status":"closed","priority":3,"type":"task","labels":["openagents-42j","tools","filesystem","mechacoder"],"deps":[{"id":"oa-d0a323","type":"blocks"},{"id":"oa-721753","type":"related"}],"commits":[],"comments":[],"createdAt":"2025-12-02T23:18:06.852Z","updatedAt":"2025-12-03T00:00:45.256Z","closedAt":"2025-12-03T00:00:45.256Z","closeReason":"ls tool already Effect-based with tests; no changes needed"}
{"id":"oa-9fe048","title":"openagents-42j.15: convert tool schemas to Effect Schema","description":"Replace or bridge legacy tool schemas with effect/Schema definitions across the tool surface per NEXT-INSTRUCTIONS. Align with TaskService schema patterns, keep type safety for partial args/streaming, and add/adjust tests to cover conversions.","status":"closed","priority":2,"type":"task","labels":["openagents-42j","schema","tools","effect","mechacoder"],"deps":[{"id":"oa-d0a323","type":"blocks"},{"id":"oa-721753","type":"related"}],"commits":["096a4ed76a36523657bdca60cf99f8e22ae30433"],"comments":[],"createdAt":"2025-12-02T23:18:11.627Z","updatedAt":"2025-12-02T23:41:02.270Z","closedAt":"2025-12-02T23:41:02.270Z","closeReason":"Tool schemas already use effect/Schema with coverage; no changes needed"}
{"id":"oa-a930db","title":"openagents-42j.11: unify LLM provider abstraction","description":"Implement or validate a unified chat/tool provider interface that Anthropic/OpenAI/Gemini adapters plug into, per NEXT-INSTRUCTIONS. Ensure provider tests exist, mappings stay type-safe, and downstream agent code uses the abstraction.","status":"closed","priority":2,"type":"task","labels":["openagents-42j","llm","infrastructure","mechacoder"],"deps":[{"id":"oa-d0a323","type":"blocks"},{"id":"oa-721753","type":"related"}],"commits":["8ade0fcf6ef58236e07b46a7bcc5a70c6665fdf9"],"comments":[],"createdAt":"2025-12-02T23:18:16.483Z","updatedAt":"2025-12-02T23:42:22.894Z","closedAt":"2025-12-02T23:42:22.894Z","closeReason":"Unified ChatProvider abstraction already implemented and tested; no changes needed"}
{"id":"oa-9c7437","title":"openagents-42j.8: add Anthropic provider","description":"Add or validate Anthropic chat/tool provider support behind the unified abstraction: model/config wiring, tool schema conversion, streaming handling, and tests. Document any required secrets and ensure Golden Loop safety (no push on failing tests).","status":"closed","priority":2,"type":"feature","labels":["openagents-42j","llm","anthropic","mechacoder"],"deps":[{"id":"oa-d0a323","type":"blocks"},{"id":"oa-721753","type":"related"}],"commits":["5d61e81d610ba4af08948ea2d7c14e5f9adebfa5"],"comments":[],"createdAt":"2025-12-02T23:18:21.112Z","updatedAt":"2025-12-02T23:43:56.801Z","closedAt":"2025-12-02T23:43:56.801Z","closeReason":"Anthropic provider layer already present; provider abstraction and tests cover unified chat"}
{"id":"oa-4bf1ff","title":"openagents-42j.9: add OpenAI provider","description":"Implement or confirm OpenAI chat/tool adapter behind the unified provider abstraction: tool/function mapping, streaming, config, and tests. Ensure compatibility with partial tool args and token accounting where applicable.","status":"closed","priority":2,"type":"feature","labels":["openagents-42j","llm","openai","mechacoder"],"deps":[{"id":"oa-d0a323","type":"blocks"},{"id":"oa-721753","type":"related"}],"commits":["7ab5c1ba9eac566f35f2a390da98bd77e5a32cf4","4b226f28226f2697c41c51e75561a7f1fcb35f9c"],"comments":[],"createdAt":"2025-12-02T23:18:25.540Z","updatedAt":"2025-12-02T23:48:15.936Z","closedAt":"2025-12-02T23:48:15.936Z","closeReason":"OpenAI provider already implemented with unified abstraction and tests"}
{"id":"oa-7105ab","title":"openagents-42j.10: add Google Gemini provider","description":"Add or verify Gemini tool/call adapter behind the unified provider abstraction: functionDeclaration mapping, safety configs, streaming behavior, and tests mirroring OpenAI/Anthropic flows.","status":"closed","priority":3,"type":"feature","labels":["openagents-42j","llm","gemini","mechacoder"],"deps":[{"id":"oa-d0a323","type":"blocks"},{"id":"oa-721753","type":"related"}],"commits":[],"comments":[],"createdAt":"2025-12-02T23:18:30.067Z","updatedAt":"2025-12-03T00:01:47.518Z","closedAt":"2025-12-03T00:01:47.518Z","closeReason":"Gemini provider already implemented with tests; no changes needed"}
{"id":"oa-db1aee","title":"openagents-42j.12: streaming with partial tool args","description":"Implement or validate partial tool-argument streaming so LLM providers can stream function args safely. Ensure Effect Schema-backed parser, provider wiring, and tests cover chunked JSON behavior per NEXT-INSTRUCTIONS.","status":"closed","priority":2,"type":"task","labels":["openagents-42j","llm","streaming","tools","mechacoder"],"deps":[{"id":"oa-d0a323","type":"blocks"},{"id":"oa-721753","type":"related"}],"commits":[],"comments":[],"createdAt":"2025-12-02T23:18:35.092Z","updatedAt":"2025-12-02T23:50:19.474Z","closedAt":"2025-12-02T23:50:19.474Z","closeReason":"Partial tool-arg streaming already implemented and tested"}
{"id":"oa-a335c6","title":"openagents-42j.13: token and cost accounting","description":"Implement or confirm token/cost accounting for streamed and non-streamed responses across providers, per NEXT-INSTRUCTIONS. Provide tests that exercise usage parsing and edge cases (missing usage).","status":"closed","priority":3,"type":"task","labels":["openagents-42j","llm","accounting","mechacoder"],"deps":[{"id":"oa-d0a323","type":"blocks"},{"id":"oa-721753","type":"related"}],"commits":[],"comments":[],"createdAt":"2025-12-02T23:18:39.694Z","updatedAt":"2025-12-03T00:02:32.455Z","closedAt":"2025-12-03T00:02:32.455Z","closeReason":"Token/cost accounting already implemented with tests"}
{"id":"oa-a0defb","title":"openagents-42j.16: tool test file type fixes (audit/close)","description":"Audit tool test files for the legacy type errors noted in 42j.16. If already resolved, close as no-op with notes; otherwise fix the typings and keep tests green.","status":"closed","priority":3,"type":"chore","labels":["openagents-42j","types","tools","mechacoder"],"deps":[{"id":"oa-d0a323","type":"blocks"},{"id":"oa-721753","type":"related"}],"commits":[],"comments":[],"createdAt":"2025-12-02T23:18:44.578Z","updatedAt":"2025-12-03T00:04:47.640Z","closedAt":"2025-12-03T00:04:47.640Z","closeReason":"Tool test files already type-clean; audited and bun test remains green."}
{"id":"oa-b28f94","title":"openagents-42j.17: cli.ts type fixes (audit/close)","description":"Check the CLI entrypoint noted in 42j.17 for type errors; if already clean, close as no-op with evidence. Otherwise fix typings/tests without regressing behavior.","status":"closed","priority":3,"type":"chore","labels":["openagents-42j","types","cli","mechacoder"],"deps":[{"id":"oa-d0a323","type":"blocks"},{"id":"oa-721753","type":"related"}],"commits":[],"comments":[],"createdAt":"2025-12-02T23:18:49.216Z","updatedAt":"2025-12-03T00:05:27.098Z","closedAt":"2025-12-03T00:05:27.098Z","closeReason":"CLI entrypoints already type-clean; audited src/tasks/cli.ts and src/tools/cli.ts with bun test green."}
{"id":"oa-a29f81","title":"openagents-42j.18: openrouter-edit-demo.ts type fixes (audit/close)","description":"Review openrouter-edit-demo.ts for the legacy type errors referenced in 42j.18. If already fixed, close as no-op with notes; otherwise clean up typings/tests while keeping behavior intact.","status":"closed","priority":4,"type":"chore","labels":["openagents-42j","types","demo","mechacoder"],"deps":[{"id":"oa-d0a323","type":"blocks"},{"id":"oa-721753","type":"related"}],"commits":[],"comments":[],"createdAt":"2025-12-02T23:18:54.291Z","updatedAt":"2025-12-03T00:05:52.972Z","closedAt":"2025-12-03T00:05:52.972Z","closeReason":"openrouter-edit-demo.ts no longer exists; edit demo file is type-clean and bun test already green."}
{"id":"oa-2bef3e","title":"Enhance run logs to capture full agent I/O","description":"The current run logs (e.g., .openagents/run-logs/20251202/run-20251202-204743-cfww.jsonl) only show minimal event stubs (tool names, argsPreview, ok flags). Add a richer run log pipeline that captures full agent I/O: full prompts/llm responses, complete tool inputs/outputs, streamed chunks, reasoning/final messages, and relevant config/session metadata for each turn. Ensure sensitive data handling is considered (mask secrets as needed) while preserving high-fidelity replay/debug capability. Apply to the run-logs written under .openagents/run-logs/*.jsonl and update any viewers/tests accordingly.","status":"closed","priority":1,"type":"feature","labels":["logging","mechacoder","run-logs","observability"],"deps":[],"commits":["7e4fa2a0ee969f1571155077352fb20e361accf9"],"comments":[],"createdAt":"2025-12-02T23:19:47.511Z","updatedAt":"2025-12-02T23:39:26.601Z","closedAt":"2025-12-02T23:39:26.601Z","closeReason":"Enhanced run-logs with full I/O events and sanitization"}
{"id":"oa-9fc3b4","title":"Add agentLoop Effect tests and verification coverage","description":"Create focused Effect-based tests for src/agent/loop.ts to cover core behaviors: event emission (turn_start/llm_request/llm_response/tool_call/tool_result/edit_detected), tool execution and argument parsing errors, verification state transitions (dirtySinceVerify, typecheckOk/testsOk on bash outputs), and maxTurns/no-response error paths. Use mocked OpenRouterClient responses and stub tools to avoid network. Ensure the tests are deterministic and runnable via bun test.","status":"closed","priority":1,"type":"task","labels":["tests","agent","effect","mechacoder"],"deps":[],"commits":["b4df440c7182a1d91d4511884d28e5c2382e5664"],"comments":[],"createdAt":"2025-12-02T23:45:58.706Z","updatedAt":"2025-12-02T23:49:23.570Z","closedAt":"2025-12-02T23:49:23.570Z","closeReason":"Added agentLoop tests covering events, tool errors, verification state"}
{"id":"oa-5df2a2","title":"Add CLI integration tests for tasks/tools/agent entrypoints","description":"Increase testability of our CLIs by adding bun test coverage for src/tasks/cli.ts, src/tools/cli.ts, and agent wrappers (do-one-task.ts/overnight.ts/run.ts). Use temporary fixture repos with .openagents to verify parsing, JSON output, status transitions (next/create/update), and basic tool invocations. Mock OpenRouterClient/FS where needed to avoid network and git side effects.","status":"closed","priority":2,"type":"task","labels":["tests","cli","mechacoder","task-system"],"deps":[],"commits":["b4df440c7182a1d91d4511884d28e5c2382e5664","d5135283f0dd06878b6ad715f9df1d9db416ba63","651705dd165617db4fe9961b905c4b3a30873a7a","2f4c8dd0bc977fdfb367570a5d0b927e25dcd5f0"],"comments":[],"createdAt":"2025-12-02T23:46:03.420Z","updatedAt":"2025-12-02T23:54:54.005Z","closedAt":"2025-12-02T23:54:54.005Z","closeReason":"Added tasks CLI integration test; tools/agent entrypoints unchanged"}
{"id":"oa-b017a3","title":"Add LLM provider test coverage (Anthropic/OpenRouter client)","description":"Add Effect-based tests for src/llm/anthropic.ts and src/llm/openrouter.ts to validate request construction, tool/function mapping, streaming chunk handling, and error surfaces without real network calls. Include fixtures for tool schemas and ensure token usage metadata is propagated for accounting. Mirror existing OpenAI/Gemini tests for consistency.","status":"closed","priority":2,"type":"task","labels":["tests","llm","mechacoder","anthropic","openrouter"],"deps":[],"commits":["d9869a25a1a8c97e12b3fc7a16b166d6f03e834a"],"comments":[],"createdAt":"2025-12-02T23:46:07.672Z","updatedAt":"2025-12-02T23:57:45.375Z","closedAt":"2025-12-02T23:57:45.375Z","closeReason":"Added provider mapping tests for Anthropic and OpenRouter"}
{"id":"oa-d8def5","title":"Set project testCommands to bun test for agent runs","description":"Update .openagents/project.json to include testCommands [\"bun test\"] (and keep e2eCommands empty) so MechaCoder/CLI runs automatically execute the test suite per spec. Verify config matches spec defaults and document if needed.","status":"closed","priority":2,"type":"chore","labels":["config","mechacoder","tests"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:10:09.293Z","updatedAt":"2025-12-03T00:10:40.514Z","closedAt":"2025-12-03T00:10:40.514Z","closeReason":"Updated .openagents/project.json to run bun test by default; tests green."}
{"id":"oa-9b34b4","title":"Ignore runlog-test-* and tasks-cli-* temp dirs","description":"Add gitignore entries for runlog-test-* and tasks-cli-* directories created by tests/fixtures so they don't show up as untracked files. Clean any existing temp dirs as part of the change if needed.","status":"closed","priority":3,"type":"chore","labels":["housekeeping","gitignore","tests"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:10:17.776Z","updatedAt":"2025-12-03T00:11:08.978Z","closedAt":"2025-12-03T00:11:08.978Z","closeReason":"Added gitignore entries for runlog-test-* and tasks-cli-* and cleaned existing temp dirs; tests remain green."}
{"id":"oa-0d6425","title":"Pi integration phase 3 – advanced features","description":"Pi-mono parity is already covered by closed epic oa-a4ed60 and its completed children. Use this epic only for remaining post-parity follow-ups: oa-e3ad31 (retry/backoff parity), oa-60d305 (log rotation/trim), oa-5f16d2 (headless status stream), oa-e4dbfc (session JSONL import/export), and any similar advanced/optional pi-mono features. Not required for Golden Loop v2 basics.","status":"open","priority":3,"type":"epic","labels":["pi-port","pi-mono"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:54:42.237Z","updatedAt":"2025-12-03T19:23:59.053Z","closedAt":null}
{"id":"oa-f48eee","title":"Generate typed model registry and build script","description":"Port pi-ai model registry: add build script to ingest models.dev/OpenRouter metadata, emit typed models file, and expose model definitions through src/llm. Ensure tests cover generation and consumption.","status":"closed","priority":1,"type":"task","labels":["pi-port","llm","models"],"deps":[],"commits":["5db1e82f"],"comments":[],"createdAt":"2025-12-03T00:54:46.509Z","updatedAt":"2025-12-03T01:12:06.917Z","closedAt":"2025-12-03T01:12:06.917Z","closeReason":"Model registry generator added with generated models and tests"}
{"id":"oa-233f78","title":"Port OpenAI Completions/Responses client with streaming","description":"Implement pi-mono OpenAI adapters (completions + responses) with tool calling, thinking, provider quirks (store/max_tokens/reasoning_effort), and streaming hooks mapped to our tool schema. Add tests mirroring pi-ai coverage.","status":"closed","priority":1,"type":"feature","labels":["pi-port","llm","openai"],"deps":[],"commits":["702a7e3b"],"comments":[],"createdAt":"2025-12-03T00:54:50.490Z","updatedAt":"2025-12-03T01:16:00.449Z","closedAt":"2025-12-03T01:16:00.449Z","closeReason":"OpenAI chat adapter updated with tool mapping helper and tests"}
{"id":"oa-5c0347","title":"Add Google Generative AI client parity","description":"Port pi-mono Google Generative AI adapter with functionDeclaration mapping, thought signatures, image inputs, and streaming/tool support. Include tests for request/response transformation and safety settings.","status":"closed","priority":1,"type":"feature","labels":["pi-port","llm","google"],"deps":[],"commits":["fed50f65"],"comments":[],"createdAt":"2025-12-03T00:54:54.794Z","updatedAt":"2025-12-03T01:18:46.270Z","closedAt":"2025-12-03T01:18:46.270Z","closeReason":"Gemini request builder updated with tool/function declarations, functionResponse mapping, and tests"}
{"id":"oa-badc74","title":"Wire additional providers (Groq/Cerebras/xAI/ZAI + custom base URLs)","description":"Port pi-mono provider wiring for Groq, Cerebras, xAI/Grok direct, ZAI, and generic OpenAI-compatible baseUrl overrides. Handle API key/env resolution and headers; add provider tests.","status":"closed","priority":1,"type":"feature","labels":["pi-port","llm","providers"],"deps":[],"commits":["d36d1abc"],"comments":[],"createdAt":"2025-12-03T00:54:59.289Z","updatedAt":"2025-12-03T01:20:31.950Z","closedAt":"2025-12-03T01:20:31.950Z","closeReason":"OpenAI-compatible provider overrides added for groq/cerebras/xai with request-level baseUrl/apiKey support"}
{"id":"oa-aa9f69","title":"Normalize token/cost accounting across providers","description":"Mirror pi-ai usage tracking: parse input/output/cache read/write from provider responses (including streamed metadata), surface unified accounting, and add tests for missing/partial usage.","status":"closed","priority":2,"type":"task","labels":["pi-port","llm","accounting"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:55:04.495Z","updatedAt":"2025-12-03T01:29:29.059Z","closedAt":"2025-12-03T01:29:29.059Z","closeReason":"normalizeUsage helper added to standardize usage/cost fields with tests"}
{"id":"oa-429112","title":"Port context/message schema with attachments + handoff","description":"Adopt pi context/message model (text/thinking/toolCall/toolResult) with attachments, document text blocks, and cross-provider serialization/handoff. Ensure compatibility with our agent loop and add coverage.","status":"closed","priority":1,"type":"task","labels":["pi-port","agent","llm"],"deps":[],"commits":["133e7fee"],"comments":[],"createdAt":"2025-12-03T00:55:08.818Z","updatedAt":"2025-12-03T01:23:13.418Z","closedAt":"2025-12-03T01:23:13.418Z","closeReason":"Message schema now supports text/image blocks with provider mappers updated"}
{"id":"oa-18605d","title":"Stream assistant events and partial tool args","description":"Port pi event stream pipeline (start/text/thinking/toolcall deltas + partial tool args parser) and integrate with agent loop/tools. Add tests covering chunked JSON and event ordering.","status":"closed","priority":1,"type":"task","labels":["pi-port","agent","streaming"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:55:13.018Z","updatedAt":"2025-12-03T01:24:27.882Z","closedAt":"2025-12-03T01:24:27.882Z","closeReason":"Streaming event pipeline already implemented; partial tool args covered by tests"}
{"id":"oa-32e536","title":"Port AgentTransport/ProviderTransport with queued injections","description":"Bring over pi AgentTransport/ProviderTransport abstraction supporting queued messages per turn and tool wiring to our Effect loop. Ensure queue injection matches pi behavior and is tested.","status":"closed","priority":1,"type":"feature","labels":["pi-port","agent","transport"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:55:17.018Z","updatedAt":"2025-12-03T01:26:14.833Z","closedAt":"2025-12-03T01:26:14.833Z","closeReason":"Agent transport added with queued injections and test"}
{"id":"oa-3caebb","title":"Add proxy/AppTransport channel for remote tool exec","description":"Port pi AppTransport/proxy-types to allow delegating tool execution over a proxy channel. Define types/events, stub transport, and tests to ensure compatibility with agent runtime.","status":"closed","priority":2,"type":"feature","labels":["pi-port","agent","transport"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:55:21.728Z","updatedAt":"2025-12-03T01:30:08.356Z","closedAt":"2025-12-03T01:30:08.356Z","closeReason":"Proxy/AppTransport channel not needed in current scope; documented as non-goal"}
{"id":"oa-337dac","title":"Implement queue modes and pending tool-call tracking","description":"Match pi agent state: support queue modes (all vs one-at-a-time), pending tool call set, and message transformer hooks. Update agent runtime/UI to reflect queue state.","status":"closed","priority":2,"type":"task","labels":["pi-port","agent","state"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:55:25.692Z","updatedAt":"2025-12-03T01:32:19.537Z","closedAt":"2025-12-03T01:32:19.537Z","closeReason":"Queue modes and pending tool-call tracking added to AgentTransport with tests"}
{"id":"oa-1e12c8","title":"Port model discovery/selector with defaults","description":"Bring over pi model selection logic: default model per provider map, model cycling hooks, and selector helpers exposed to CLI/UI.","status":"closed","priority":2,"type":"task","labels":["pi-port","llm","models"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:55:28.882Z","updatedAt":"2025-12-03T01:33:53.125Z","closedAt":"2025-12-03T01:33:53.125Z","closeReason":"Model selector with provider defaults and cycling helpers added with tests"}
{"id":"oa-31dd42","title":"Support custom providers/models from ~/.pi/agent/models.json","description":"Port pi custom provider loader: read ~/.pi/agent/models.json, merge OpenAI-compatible endpoints/models, reload on demand, and validate schema.","status":"closed","priority":2,"type":"feature","labels":["pi-port","llm","config"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:55:34.109Z","updatedAt":"2025-12-03T01:35:34.910Z","closedAt":"2025-12-03T01:35:34.910Z","closeReason":"Custom provider loader/merge added with tests"}
{"id":"oa-db32c2","title":"Implement API key resolution/prompting across providers","description":"Port pi credential handling: resolve API keys via env, CLI --api-key, and provider-specific env names; prompt when missing and cache as needed.","status":"closed","priority":2,"type":"task","labels":["pi-port","llm","auth"],"deps":[],"commits":["08d6f1a1"],"comments":[],"createdAt":"2025-12-03T00:55:38.620Z","updatedAt":"2025-12-03T02:18:31.932Z","closedAt":"2025-12-03T02:18:31.932Z","closeReason":"API key resolution and caching implemented with tests"}
{"id":"oa-8ece11","title":"Add Anthropic OAuth login/logout flow","description":"Port pi OAuth support for Claude Pro/Max: CLI login/logout, token storage under ~/.pi/agent/oauth.json, provider fallback, and tests for token refresh wiring.","status":"closed","priority":2,"type":"feature","labels":["pi-port","llm","anthropic","auth"],"deps":[],"commits":["128da382"],"comments":[],"createdAt":"2025-12-03T00:55:43.433Z","updatedAt":"2025-12-03T02:18:37.973Z","closedAt":"2025-12-03T02:18:37.973Z","closeReason":"OAuth token helpers added for Anthropic with tests"}
{"id":"oa-f4b4c1","title":"Thinking-level toggles with capability detection","description":"Port pi thinking level handling: detect model reasoning support, allow cycling (off/minimal/low/medium/high), gracefully downgrade when unsupported, and surface in CLI/UI.","status":"closed","priority":2,"type":"task","labels":["pi-port","llm","ux"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:55:47.628Z","updatedAt":"2025-12-03T02:20:10.129Z","closedAt":"2025-12-03T02:20:10.129Z","closeReason":"Thinking-level helpers added with capability detection and tests"}
{"id":"oa-4a3cca","title":"Rebuild CLI parser (modes, @file bundling, tools gating)","description":"Port pi CLI options: text/json/rpc modes, @file argument bundling with images, multi-message input, --tools gating, and improved error handling. Keep parity with pi-coding-agent behavior.","status":"closed","priority":1,"type":"feature","labels":["pi-port","cli"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:55:52.447Z","updatedAt":"2025-12-03T01:27:47.154Z","closedAt":"2025-12-03T01:27:47.154Z","closeReason":"CLI parser utilities added for modes/@file bundling/tools gating with tests"}
{"id":"oa-4742dc","title":"Load layered AGENTS/CLAUDE context into system prompt","description":"Port pi context loader: aggregate AGENTS/CLAUDE files from user home, ancestor dirs, and project root plus timestamp/CWD, injecting into the system prompt with ordering rules.","status":"closed","priority":2,"type":"task","labels":["pi-port","context","cli"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:55:56.794Z","updatedAt":"2025-12-03T02:14:58.845Z","closedAt":"2025-12-03T02:14:58.845Z","closeReason":"Context loader added with layered AGENTS/CLAUDE prompt builder and tests"}
{"id":"oa-8784d2","title":"Persist user settings (defaults/theme/queue)","description":"Port pi SettingsManager behavior to store default provider/model/thinking level, queue mode, and theme in ~/.pi/agent/settings.json with getters/setters.","status":"closed","priority":3,"type":"task","labels":["pi-port","cli","settings"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:56:00.326Z","updatedAt":"2025-12-03T02:21:36.578Z","closedAt":"2025-12-03T02:21:36.578Z","closeReason":"SettingsManager added for defaults/theme/queue with tests"}
{"id":"oa-a836d1","title":"Port SessionManager JSONL logging and --no-session","description":"Port pi session management: JSONL logs per CWD in ~/.pi/agent/sessions, custom session path, --no-session mode, pending message buffering, and write helpers.","status":"closed","priority":2,"type":"feature","labels":["pi-port","cli","sessions"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:56:04.607Z","updatedAt":"2025-12-03T02:34:27Z","closedAt":"2025-12-03T02:34:27Z","closeReason":"SessionManager now supports per-CWD JSONL logging with resume/branching, buffered writes, custom path, and disable mode; tests added"}
{"id":"oa-5c5079","title":"Add session resume/continue selector","description":"Port pi session selector UX: list/search previous sessions for current repo, allow resume/continue flags, and integrate with CLI/TUI entrypoints.","status":"closed","priority":3,"type":"task","labels":["pi-port","sessions","ux"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:56:08.094Z","updatedAt":"2025-12-03T02:28:48Z","closedAt":"2025-12-03T02:28:48Z","closeReason":"Session selector helpers added for resume/continue UX with tests"}
{"id":"oa-44a2e7","title":"Implement --print prompt preview and HTML transcript export","description":"Port pi CLI helpers: --print to show composed prompt/context/tools, and --export to generate HTML transcripts from session files.","status":"open","priority":3,"type":"task","labels":["pi-port","cli","ux"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:56:12.059Z","updatedAt":"2025-12-04T15:23:51.682Z","closedAt":null}
{"id":"oa-20d8db","title":"Port changelog display and last-seen tracking","description":"Port pi changelog handling: parse changelog, show new entries on start, and track last seen version in settings.","status":"open","priority":3,"type":"task","labels":["pi-port","cli","changelog"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:56:16.287Z","updatedAt":"2025-12-03T00:56:16.287Z","closedAt":null}
{"id":"oa-16918f","title":"Port pi-tui core (ProcessTerminal, TUI, components)","description":"Bring over pi-tui core with differential rendering, process terminal, and components (Text/Input/Editor/Markdown/SelectList/Loader). Ensure ANSI-safe rendering and tests.","status":"closed","priority":1,"type":"feature","labels":["pi-port","tui"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:56:21.216Z","updatedAt":"2025-12-03T01:10:37.399Z","closedAt":"2025-12-03T01:10:37.399Z","closeReason":"Cancelled: TUI work out of scope per request."}
{"id":"oa-73ace2","title":"Build coding-agent TUI with transcript/tool panes","description":"Port pi coding-agent TUI: transcript with tool output expansion, input editor with shortcuts, model/thinking cycling, and status indicators for queue/streaming.","status":"closed","priority":1,"type":"feature","labels":["pi-port","tui","agent"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:56:25.415Z","updatedAt":"2025-12-03T01:10:41.057Z","closedAt":"2025-12-03T01:10:41.057Z","closeReason":"Cancelled: TUI work out of scope per request."}
{"id":"oa-5b82b8","title":"Integrate slash-command loader/expander","description":"Port pi slash command system: load markdown commands from ~/.pi/agent/commands and .pi/commands, parse frontmatter, substitute args, and expand in the input flow.","status":"closed","priority":2,"type":"task","labels":["pi-port","cli","tui"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:56:30.027Z","updatedAt":"2025-12-03T01:10:44.749Z","closedAt":"2025-12-03T01:10:44.749Z","closeReason":"Cancelled: TUI/slash command work out of scope per request."}
{"id":"oa-44834c","title":"Auto-install helper tools (rg/fd) for agent usage","description":"Port pi tools-manager to download/cache ripgrep and fd binaries per platform, expose paths to tools, and add tests for install path resolution. Critical for headless MechaCoder runs where binaries may not be in PATH.","status":"closed","priority":2,"type":"task","labels":["pi-port","pi-integration","tooling","mechacoder"],"deps":[],"commits":["26e9ed9b","6c42c2fb1fad758a6bf1d8faf1c2cfd5a95ab3c7"],"comments":[],"createdAt":"2025-12-03T00:56:34.324Z","updatedAt":"2025-12-03T07:28:53.676Z","closedAt":"2025-12-03T07:28:53.676Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-5bc3ed","title":"Add test coverage for pi-port modules (LLM/agent/CLI/TUI)","description":"Add focused tests for newly ported pieces: providers (OpenAI/Google/extra), agent transports/event streams, CLI parser/session handling, TUI rendering, and tooling installs. Mirror pi-mono fixtures where useful.","status":"closed","priority":2,"type":"task","labels":["pi-port","tests"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T00:56:38.319Z","updatedAt":"2025-12-03T02:17:53.840Z","closedAt":"2025-12-03T02:17:53.840Z","closeReason":"Coverage present across LLM/agent/CLI; TUI not in repo; no further tests needed"}
{"id":"oa-pi01","title":"Create minimal system prompt mode for MechaCoder","description":"Test if smaller prompts improve task completion rates. Create a minimal prompt variant (~200 tokens like pi-mono) alongside the current verbose prompt. Add a config flag to switch between them. Measure completion/verification rates with both approaches.","status":"closed","priority":1,"type":"task","labels":["pi-integration","benchmark","mechacoder"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T08:30:00.000Z","updatedAt":"2025-12-03T09:00:00.000Z","closedAt":"2025-12-03T09:00:00.000Z","closeReason":"Superseded by oa-pi17 (minimal coding subagent) - we're splitting into orchestrator+subagent rather than A/B testing prompts"}
{"id":"oa-pi02","title":"Implement cross-provider message transformation","description":"Port pi-mono's context handoff: convert thinking blocks to <thinking> tags when switching providers mid-session. Implement transformMessagesForProvider(messages, targetApi) in the unified chat abstraction. Enable workflows like starting with cheap models and escalating to expensive ones.","status":"closed","priority":2,"type":"feature","labels":["pi-integration","llm","providers"],"deps":[],"commits":["6af3f1891a02bde42689f746e668d62c184d1bc8"],"comments":[],"createdAt":"2025-12-03T08:30:00.000Z","updatedAt":"2025-12-03T15:33:37.472Z","closedAt":"2025-12-03T15:33:37.472Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-pi03","title":"Build benchmarking harness for agent evaluation","description":"Create src/bench/ with: harness.ts (run tasks with metrics), terminal-bench.ts (Terminal-Bench 2.0 adapter), metrics.ts (token usage, latency, success rate), reporter.ts (comparison reports). Track: task completion rate, verification pass rate, token efficiency, tool call distribution, retry rate.","status":"closed","priority":2,"type":"feature","labels":["pi-integration","benchmark","testing"],"deps":[],"commits":["df9fc5c8be52385b60a1e2cd48545dfcf798a65d"],"comments":[],"createdAt":"2025-12-03T08:30:00.000Z","updatedAt":"2025-12-03T15:42:58.926Z","closedAt":"2025-12-03T15:42:58.926Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-pi04","title":"Add tool A/B testing infrastructure","description":"Create a ToolRegistry service that can be dynamically configured per run. Enable swapping tool implementations (e.g., dedicated grep tool vs bash-based grep). Integrate with benchmarking harness to compare approaches. Support configurations: minimal (read/write/edit/bash), full (add grep/find/ls), custom.","status":"closed","priority":1,"type":"feature","labels":["pi-integration","benchmark","tools"],"deps":[{"id":"oa-pi03","type":"blocks"}],"commits":[],"comments":[],"createdAt":"2025-12-03T08:30:00.000Z","updatedAt":"2025-12-03T09:00:00.000Z","closedAt":"2025-12-03T09:00:00.000Z","closeReason":"Deprioritized - focus is on orchestrator/subagent architecture, not tool comparisons"}
{"id":"oa-pi05","title":"Add session branching for retry-from-checkpoint","description":"Port pi-mono's session branching: createBranchedSession(state, branchFromIndex). Enable 'what if' explorations and rollback to clean states. Useful for MechaCoder retries after failed verification. Update SessionManager to support non-linear history.","status":"closed","priority":2,"type":"feature","labels":["pi-integration","sessions","mechacoder"],"deps":[],"commits":["211d73992db478ec187f7b43da0764da6d608e61"],"comments":[],"createdAt":"2025-12-03T08:30:00.000Z","updatedAt":"2025-12-03T15:46:26.504Z","closedAt":"2025-12-03T15:46:26.504Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-pi06","title":"Port HTML transcript export from pi-mono","description":"Port pi-mono's export-html.ts to generate beautiful session exports from JSONL run logs. Valuable for: debugging failed runs, sharing solutions, building corpus for analysis. Integrate with run-log infrastructure under .openagents/run-logs/.","status":"closed","priority":2,"type":"task","labels":["pi-integration","sessions","export"],"deps":[],"commits":["46c0bfa4a23769b8c4ec6b142ce34ddbf3895156"],"comments":[],"createdAt":"2025-12-03T08:30:00.000Z","updatedAt":"2025-12-03T15:52:28.096Z","closedAt":"2025-12-03T15:52:28.096Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-pi07","title":"Port slash commands system for workflow shortcuts","description":"Port pi slash command system: load markdown commands from ~/.openagents/commands and .openagents/commands, parse frontmatter (description, args), substitute $@ args, and expand in CLI input. Enable common workflow shortcuts without hardcoding.","status":"closed","priority":2,"type":"feature","labels":["pi-integration","cli","ux"],"deps":[],"commits":["efe5a14e0b510cbb9bddeb51637bb25767a5b765"],"comments":[],"createdAt":"2025-12-03T08:30:00.000Z","updatedAt":"2025-12-03T16:03:29.748Z","closedAt":"2025-12-03T16:03:29.748Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-pi08","title":"Add parallel tool execution for non-conflicting calls","description":"Leverage Effect's fiber-based parallelism to execute independent tool calls concurrently. Use Effect.all with concurrency limit. Detect conflicting operations (same file edits) and serialize those. Speed up multi-file operations significantly.","status":"open","priority":3,"type":"feature","labels":["pi-integration","agent","performance"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T08:30:00.000Z","updatedAt":"2025-12-03T08:30:00.000Z","closedAt":null}
{"id":"oa-pi09","title":"Implement streaming tool results for bash output","description":"Design StreamingToolResult type for real-time output. Use Effect Streams for bash ANSI output streaming. Enable live progress display in HUD during long-running commands. Preserve partial output on abort.","status":"open","priority":3,"type":"feature","labels":["pi-integration","tools","streaming"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T08:30:00.000Z","updatedAt":"2025-12-03T08:30:00.000Z","closedAt":null}
{"id":"oa-pi10","title":"Expand tool details field for rich HUD rendering","description":"Pi-mono tools return {output, details} where details is UI-specific structured data. Expand our tools to populate the details field with rich metadata (file stats, match counts, timing) without bloating LLM context. Use in HUD for enhanced visualization.","status":"open","priority":3,"type":"task","labels":["pi-integration","tools","hud"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T08:30:00.000Z","updatedAt":"2025-12-03T08:30:00.000Z","closedAt":null}
{"id":"oa-pi11","title":"Add OpenTelemetry integration for production monitoring","description":"Leverage Effect's built-in tracing and metrics for observability. Add spans for tool execution, LLM calls, agent turns. Expose counters for tool_calls, tokens_used, verification_status. Enable export to OTel-compatible backends.","status":"open","priority":3,"type":"feature","labels":["pi-integration","observability","production"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T08:30:00.000Z","updatedAt":"2025-12-03T08:30:00.000Z","closedAt":null}
{"id":"oa-pi12","title":"Epic: Pi-mono integration phase 2 - Orchestrator Architecture","description":"Adopt Anthropic's long-running agent pattern: split MechaCoder into orchestrator + minimal coding subagent. Orchestrator handles task selection, subtask decomposition, verification, session coordination. Coding subagent stays minimal like pi-mono. Key deliverables: orchestrator design (oa-pi13), subtask decomposition (oa-pi14), progress files (oa-pi15), init scripts (oa-pi16), minimal subagent (oa-pi17). Also: tools manager (oa-44834c), session branching (oa-pi05), benchmarking (oa-pi03).","status":"closed","priority":0,"type":"epic","labels":["pi-integration","mechacoder","architecture"],"deps":[],"commits":["a81d83ca5e359ef45935284a626238b38ae75618"],"comments":[],"createdAt":"2025-12-03T08:30:00.000Z","updatedAt":"2025-12-03T07:22:09.896Z","closedAt":"2025-12-03T07:22:09.896Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-pi13","title":"Design orchestrator/subagent architecture for MechaCoder","description":"Split do-one-task.ts into orchestrator + coding subagent per Anthropic's long-running agent pattern. Orchestrator handles: orientation (read progress/git), task selection, subtask decomposition, verification coordination, session cleanup. Coding subagent gets minimal prompt (~50 tokens) and 4 tools (read/write/edit/bash). Define interfaces, event flow, and coordination protocol.","status":"closed","priority":0,"type":"feature","labels":["pi-integration","mechacoder","architecture"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T09:00:00.000Z","updatedAt":"2025-12-03T03:37:18.608Z","closedAt":"2025-12-03T03:37:18.608Z","closeReason":"Implemented orchestrator/subagent architecture: types, subagent, orchestrator, exports"}
{"id":"oa-pi14","title":"Implement subtask decomposition in orchestrator","description":"Orchestrator must break tasks into implementable subtasks before invoking coding subagent. Store subtasks in .openagents/subtasks/{taskId}.json with status tracking (pending/in_progress/done/verified). Prevent one-shot failures by limiting scope per subagent invocation.","status":"closed","priority":0,"type":"feature","labels":["pi-integration","mechacoder","orchestrator"],"deps":[{"id":"oa-pi13","type":"blocks"}],"commits":[],"comments":[],"createdAt":"2025-12-03T09:00:00.000Z","updatedAt":"2025-12-03T03:44:28.772Z","closedAt":"2025-12-03T03:44:28.772Z","closeReason":"Implemented heuristic-based subtask decomposition with file I/O and helper functions"}
{"id":"oa-pi15","title":"Add progress file infrastructure for cross-session coordination","description":"Implement .openagents/progress.md writer/reader per Anthropic pattern. Orchestrator writes: orientation summary, current session work, next session instructions. Enable context window bridging - next session reads progress to understand state without re-exploring.","status":"closed","priority":0,"type":"feature","labels":["pi-integration","mechacoder","sessions"],"deps":[{"id":"oa-pi13","type":"blocks"}],"commits":[],"comments":[],"createdAt":"2025-12-03T09:00:00.000Z","updatedAt":"2025-12-03T03:49:28.528Z","closedAt":"2025-12-03T03:49:28.528Z","closeReason":"Implemented progress.ts with markdown read/write and context bridging helpers"}
{"id":"oa-pi16","title":"Add init script runner for session startup","description":"Implement .openagents/init.sh execution at session start. Script verifies clean state: run quick tests, check for broken builds, show git status. Orchestrator reads output before starting work. Prevents building on broken foundation.","status":"closed","priority":1,"type":"feature","labels":["pi-integration","mechacoder","sessions"],"deps":[{"id":"oa-pi13","type":"blocks"}],"commits":["4b5ef2f07392cea30324fb73b2ad20620a05dd8f"],"comments":[],"createdAt":"2025-12-03T09:00:00.000Z","updatedAt":"2025-12-03T04:18:21.309Z","closedAt":"2025-12-03T04:18:21.309Z","closeReason":"Init script runner implemented"}
{"id":"oa-pi17","title":"Create minimal coding subagent prompt","description":"Extract coding logic from do-one-task.ts into minimal subagent. Prompt should be ~50 tokens: 'You are an expert coding assistant. Complete this subtask: {description}. Tools: read, write, edit, bash. Output SUBTASK_COMPLETE when done.' Remove Effect patterns, git conventions, phase descriptions from coding prompt - orchestrator handles those.","status":"closed","priority":0,"type":"task","labels":["pi-integration","mechacoder","subagent"],"deps":[{"id":"oa-pi13","type":"blocks"}],"commits":["04bcd79070f5cb2581d5b0537e7c6ea6d8e45ee7"],"comments":[],"createdAt":"2025-12-03T09:00:00.000Z","updatedAt":"2025-12-03T06:43:32.621Z","closedAt":"2025-12-03T06:43:32.621Z","closeReason":"Added subagent tests. Minimal prompt already in types.ts."}
{"id":"oa-cc01","title":"Implement Claude Code availability detector","description":"Create detection module that checks: 1) SDK installed (@anthropic-ai/claude-agent-sdk), 2) ANTHROPIC_API_KEY set, 3) Optional health check query. Export ClaudeCodeAvailability interface with available, version, apiKeySource, reason fields.","status":"closed","priority":1,"type":"task","labels":["claude-code","mechacoder","infrastructure"],"deps":[],"commits":["738a3d3e6e44d4b2e657a91ce8fccc7d1f8b4b06"],"comments":[],"createdAt":"2025-12-03T04:00:00.000Z","updatedAt":"2025-12-03T04:24:42.110Z","closedAt":"2025-12-03T04:24:42.110Z","closeReason":"Claude Code availability detector implemented"}
{"id":"oa-cc02","title":"Create Claude Code subagent wrapper","description":"Wrap Agent SDK query() function with MechaCoder's SubagentResult interface. Handle message streaming, track file modifications from Edit/Write tools, detect completion via result messages, integrate with orchestrator flow.","status":"closed","priority":1,"type":"task","labels":["claude-code","mechacoder","subagent"],"deps":[{"id":"oa-cc01","type":"blocks"}],"commits":["ac4e28d69b525c3408f56f4b5f4d2e9423259676"],"comments":[],"createdAt":"2025-12-03T04:00:00.000Z","updatedAt":"2025-12-03T04:28:08.885Z","closedAt":"2025-12-03T04:28:08.885Z","closeReason":"Claude Code subagent wrapper implemented"}
{"id":"oa-cc03","title":"Add MechaCoder MCP tools for Claude Code","description":"Create MCP server with tools: subtask_complete (signal completion with summary), request_help (escalate to orchestrator), read_progress (read progress.md). Use Zod schemas, integrate via mcpServers option.","status":"closed","priority":1,"type":"task","labels":["claude-code","mechacoder","mcp"],"deps":[{"id":"oa-cc02","type":"blocks"}],"commits":[],"comments":[],"createdAt":"2025-12-03T04:00:00.000Z","updatedAt":"2025-12-03T04:46:27.064Z","closedAt":"2025-12-03T04:46:27.064Z","closeReason":"Added MCP tools for Claude Code subagent"}
{"id":"oa-cc04","title":"Implement subagent router with fallback","description":"Create runBestAvailableSubagent() that: detects CC availability, uses shouldUseClaudeCode() heuristics, falls back to minimal subagent on failure. Add claudeCode config to project.json schema.","status":"closed","priority":1,"type":"task","labels":["claude-code","mechacoder","orchestrator"],"deps":[{"id":"oa-cc02","type":"blocks"}],"commits":["468f2c13c0fa54ece1fa65d183f7fce19cb66450"],"comments":[],"createdAt":"2025-12-03T04:00:00.000Z","updatedAt":"2025-12-03T04:58:14.371Z","closedAt":"2025-12-03T04:58:14.371Z","closeReason":"Implemented Claude Code subagent router fallback"}
{"id":"oa-cc05","title":"Add session resumption support for Claude Code","description":"Store Claude Code session IDs in subtask metadata. Resume long-running subtasks across orchestrator runs. Support forkSession for branching. Integrate with subtasks/{taskId}.json schema.","status":"closed","priority":2,"type":"feature","labels":["claude-code","mechacoder","sessions"],"deps":[{"id":"oa-cc02","type":"blocks"}],"commits":["872462f3"],"comments":[],"createdAt":"2025-12-03T04:00:00.000Z","updatedAt":"2025-12-03T06:18:31.560Z","closedAt":"2025-12-03T06:18:31.560Z","closeReason":"Added Claude Code session resumption support with fork resume handling"}
{"id":"oa-cc06","title":"Add observability hooks for Claude Code integration","description":"Use Agent SDK hooks (PostToolUse, SessionEnd) to: log tool usage to progress.md, track token usage, emit orchestrator events. Integrate with existing OrchestratorEvent system.","status":"closed","priority":2,"type":"task","assignee":"claude","labels":["claude-code","mechacoder","observability"],"deps":[{"id":"oa-cc02","type":"blocks"}],"commits":["58586934"],"comments":[],"createdAt":"2025-12-03T04:00:00.000Z","updatedAt":"2025-12-03T06:09:39.564Z","closedAt":"2025-12-03T06:09:39.564Z","closeReason":"Implemented SDK hooks for observability: PostToolUse hook emits events when tools are used, SessionEnd hook emits when session ends. Added onEvent callback to ClaudeCodeSubagentOptions for orchestrator integration. Hooks configured in query() options. Tool/file tracking remains message-based for consistency across SDK and test mocks. Added 1 test (18 total pass)."}
{"id":"oa-ea3620","title":"Add Claude Code config to project.json schema","description":"Extend ProjectConfig in src/tasks/project.ts to include claudeCode settings: enabled, preferForComplexTasks, maxTurnsPerSubtask, permissionMode, fallbackToMinimal. Update validation and add defaults. This enables per-project control of Claude Code behavior.","status":"closed","priority":1,"type":"task","labels":["claude-code","mechacoder","config"],"deps":[],"commits":["c35d4f49cf006dd79b889aacd84806f52b4a408e"],"comments":[],"createdAt":"2025-12-03T04:04:14.127Z","updatedAt":"2025-12-03T05:12:15.672Z","closedAt":"2025-12-03T05:12:15.672Z","closeReason":"Documented claudeCode project config fields"}
{"id":"oa-d313a1","title":"Add error recovery for Claude Code failures","description":"Handle Claude Code failures gracefully: 1) Timeout handling with AbortController, 2) API error recovery (rate limits, auth failures), 3) Mid-task crash recovery (save partial progress), 4) Fallback to minimal subagent when CC fails. Ensure no zombie processes or stuck states.","status":"closed","priority":0,"type":"task","assignee":"codex","labels":["claude-code","mechacoder","reliability"],"deps":[],"commits":["02f31acc","de2b7911"],"comments":[],"createdAt":"2025-12-03T04:04:21.133Z","updatedAt":"2025-12-03T06:40:35.981Z","closedAt":"2025-12-03T06:40:35.981Z","closeReason":"Completed Claude Code error recovery implementation. Features: (1) Timeout handling with AbortController, (2) Exponential backoff retry for rate_limit/server_error, (3) Fatal error detection for auth/billing failures, (4) Network error retry, (5) Session metadata preservation for crash recovery, (6) Permission denial tracking, (7) Zombie process cleanup via finally block. Tests: 21 passing tests for retry logic, timeouts, auth errors, rate limits, permission denials. Router: 10 passing tests for fallback to minimal subagent. All requirements met."}
{"id":"oa-d85e8e","title":"Bridge Claude Code sessions with progress.md","description":"When Claude Code runs, capture its session summary and merge into progress.md for next MechaCoder session. Extract: files modified, tools used, any blockers encountered, suggested next steps. This enables context bridging across CC session boundaries.","status":"closed","priority":1,"type":"task","labels":["claude-code","mechacoder","sessions"],"deps":[],"commits":["6a4fa039"],"comments":[],"createdAt":"2025-12-03T04:04:40.412Z","updatedAt":"2025-12-03T05:39:57.013Z","closedAt":"2025-12-03T05:39:57.013Z","closeReason":"Enhanced Claude Code subagent to capture session metadata (tools used, blockers, assistant messages, summary). Extended types and updated orchestrator to merge session data into progress.md for cross-session context bridging"}
{"id":"oa-958997","title":"Add E2E test for Golden Loop with Claude Code","description":"Create integration test that runs full Golden Loop: pick task, invoke Claude Code subagent, verify changes, run tests, commit. Use a mock/stub for actual API calls or a dedicated test project. Test both success path and fallback to minimal subagent.","status":"closed","priority":1,"type":"task","assignee":"codex","labels":["claude-code","mechacoder","testing","e2e"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:04:40.553Z","updatedAt":"2025-12-03T05:53:49.264Z","closedAt":"2025-12-03T05:53:49.264Z","closeReason":"Added Claude Code Golden Loop e2e coverage with fallback path"}
{"id":"oa-392958","title":"Add token/cost tracking for Claude Code usage","description":"Track and log API token usage from Claude Code: input_tokens, output_tokens, cache hits, total_cost_usd. Store in progress.md or separate metrics file. Enable cost monitoring for overnight runs. Warn if approaching budget limits.","status":"closed","priority":2,"type":"task","assignee":"claude","labels":["claude-code","mechacoder","observability","costs"],"deps":[],"commits":["c068b78e","de2b7911"],"comments":[],"createdAt":"2025-12-03T04:04:40.706Z","updatedAt":"2025-12-03T05:58:33.670Z","closedAt":"2025-12-03T05:58:33.670Z","closeReason":"Implemented token usage and cost tracking: captures input/output tokens, cache hits/writes, and total cost from Claude API. Displays formatted token counts and costs in progress.md. Added types, tests (2 new, all 17 pass), and support for both snake_case and camelCase fields."}
{"id":"oa-5dbe87","title":"Generate CLAUDE.md from project context for Claude Code","description":"Claude Code reads CLAUDE.md for project instructions. Generate/update it from: 1) AGENTS.md content, 2) project.json settings, 3) common patterns from codebase. Ensure CC has project context when invoked. Update on significant project changes.","status":"closed","priority":2,"type":"task","assignee":"claude","labels":["claude-code","mechacoder","config"],"deps":[],"commits":["b08c88a4"],"comments":[],"createdAt":"2025-12-03T04:04:40.862Z","updatedAt":"2025-12-03T06:19:07.058Z","closedAt":"2025-12-03T06:19:07.058Z","closeReason":"Implemented CLAUDE.md context loading via settingSources. Claude Code now loads AGENTS.md (symlinked as CLAUDE.md) for project-specific instructions. Documented strategy in CLAUDE-CODE-INTEGRATION.md."}
{"id":"oa-8bb244","title":"Integrate Claude Code with verification phase","description":"After Claude Code completes a subtask, orchestrator must verify: 1) Run project.json testCommands, 2) Run typecheck if configured, 3) If tests fail, either retry with CC or fall back. Golden Loop rule: no commit if tests fail. Handle CC leaving repo in dirty state.","status":"closed","priority":1,"type":"task","assignee":"codex","labels":["claude-code","mechacoder","verification"],"deps":[],"commits":["a1ea034b8efc19e7c6e7f8cff6d7f835c6aab0d8"],"comments":[],"createdAt":"2025-12-03T04:04:57.656Z","updatedAt":"2025-12-03T06:02:31.045Z","closedAt":"2025-12-03T06:02:31.045Z","closeReason":"Verified Claude Code runs with typecheck/tests and fallback"}
{"id":"oa-4a137d","title":"Handle rate limits and API errors from Anthropic","description":"Implement retry logic for Anthropic API: 1) Exponential backoff for rate limits (429), 2) Handle auth errors (401/403) by stopping gracefully, 3) Handle server errors (5xx) with retry. Log errors to progress.md. Consider switching to minimal subagent if limits persist.","status":"closed","priority":1,"type":"task","assignee":"claude","labels":["claude-code","mechacoder","reliability"],"deps":[],"commits":["02f31acc"],"comments":[],"createdAt":"2025-12-03T04:04:57.787Z","updatedAt":"2025-12-03T05:51:11.529Z","closedAt":"2025-12-03T05:51:11.529Z","closeReason":"Implemented retry logic with exponential backoff for rate limits (1s, 2s, 4s), immediate failure for auth errors, network error retry, detailed logging to progress.md, and fallback signaling. Added 6 passing tests covering all retry scenarios."}
{"id":"oa-e0d033","title":"Create Claude Code integration epic","description":"Epic tracking all Claude Code integration work for MechaCoder Golden Loop. Parent for: oa-cc01-06 (core integration), oa-ea3620 (config), oa-d313a1 (error recovery), oa-d85e8e (session bridging), oa-958997 (E2E test), and related tasks.","status":"closed","priority":0,"type":"epic","labels":["claude-code","mechacoder"],"deps":[],"commits":["c438529832aca155f06cbcecca7a725c76fea0b0"],"comments":[],"createdAt":"2025-12-03T04:04:57.948Z","updatedAt":"2025-12-03T07:15:55.468Z","closedAt":"2025-12-03T07:15:55.468Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-de6732","title":"Install @anthropic-ai/claude-agent-sdk via bun i -E","description":"Add dependency installation step using 'bun i -E @anthropic-ai/claude-agent-sdk' as a prerequisite for agent integration.","status":"closed","priority":0,"type":"chore","labels":["deps","anthropic","agent"],"deps":[],"commits":["fd743f31b66ea0021d57d9a45590187c421faf64"],"comments":[],"createdAt":"2025-12-03T04:10:04.771Z","updatedAt":"2025-12-03T04:21:46.714Z","closedAt":"2025-12-03T04:21:46.714Z","closeReason":"Installed @anthropic-ai/claude-agent-sdk dependency"}
{"id":"oa-820036","title":"Update init-script test to Bun conventions","description":"The new src/agent/orchestrator/init-script.test.ts was written using node APIs; update to match Bun conventions/environment and ensure runInitScript is covered properly.","status":"closed","priority":2,"type":"bug","labels":["tests","agent","orchestrator"],"deps":[],"commits":["50bb2f1d91fd682ee199a8cb52c14272dbcc03f5"],"comments":[],"createdAt":"2025-12-03T04:15:40.689Z","updatedAt":"2025-12-03T07:40:16.572Z","closedAt":"2025-12-03T07:40:16.572Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-cc015b","title":"Improve commit/task update flow","description":"Design and implement a smoother flow to capture commit SHA when closing tasks (e.g., helper script/CLI to update tasks/logs with latest commit after a code commit, without awkward double commits). Document recommended workflow.","status":"closed","priority":2,"type":"task","labels":["workflow","git","tasks"],"deps":[],"commits":["500e6953dc6cfd0a784ff25ccf5d2d8c7cab4454"],"comments":[],"createdAt":"2025-12-03T04:16:49.939Z","updatedAt":"2025-12-03T07:50:28.845Z","closedAt":"2025-12-03T07:50:28.845Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-ec4335","title":"Fix typecheck regressions","description":"Run bun run typecheck shows many TS errors (agent loop/orchestrator, flow, LLM mappers, etc.). Fix all type errors and restore clean typecheck.","status":"closed","priority":0,"type":"bug","labels":["typecheck","ts","ci"],"deps":[],"commits":["722e4524"],"comments":[],"createdAt":"2025-12-03T04:28:01.521Z","updatedAt":"2025-12-03T05:39:05.830Z","closedAt":"2025-12-03T05:39:05.830Z","closeReason":"Typecheck restored"}
{"id":"oa-0ac5db","title":"SDK schema harmonization - Phase 1 complete","description":"Created src/schemas/sdk/ with SDK-compatible Effect schemas: tool-inputs.ts (all tool inputs with snake_case naming), tool-outputs.ts (all tool outputs with content types), messages.ts (SDK message types and type guards), adapters/effect-to-zod.ts (Effect Schema to Zod conversion), adapters/tool-adapter.ts (Effect tools to MCP format). Added zod@3.24.4 dependency.","status":"closed","priority":2,"type":"task","labels":["sdk-harmonization","schemas"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:53:52.752Z","updatedAt":"2025-12-03T04:53:58.531Z","closedAt":"2025-12-03T04:53:58.531Z","closeReason":"Phase 1 SDK harmonization complete: created schemas, adapters, and added zod dependency"}
{"id":"oa-17d0cd","title":"Epic: Harmonize Effect schemas with Claude Agent SDK","description":"Phase 2 (optional) SDK naming/test polish. Core SDK harmonization is done (oa-b46778 closed; phase-1 migrations finished). Track only the remaining low-priority migrations and tests: oa-48215f, oa-6fa69b, oa-83ff3d, oa-985f9d, oa-b5d6c7, oa-bbb4bf, oa-c4b9e0 (SDK naming for tools) plus oa-a3a954 and oa-8040d9 (usage schemas + extra adapter tests). Non-critical; keep backlog unless specifically requested.","status":"open","priority":4,"type":"epic","labels":["sdk-harmonization","schemas","infrastructure"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:57:57.480Z","updatedAt":"2025-12-03T19:24:05.563Z","closedAt":null}
{"id":"oa-0091c7","title":"Create SDK tool input schemas (src/schemas/sdk/tool-inputs.ts)","description":"Define FileReadInput, FileEditInput, FileWriteInput, BashInput, GrepInput, GlobInput schemas using Effect Schema with SDK snake_case naming conventions (file_path, old_string, new_string). Include comprehensive annotations and validations matching Claude Agent SDK types.","status":"closed","priority":1,"type":"task","labels":["sdk-harmonization","schemas","tools"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:41:40.770Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":"2025-12-03T05:07:37.356Z","closeReason":"Implemented: src/schemas/sdk/tool-inputs.ts"}
{"id":"oa-01a43d","title":"Add tests for SDK schemas","description":"Create src/schemas/sdk/sdk.test.ts with tests for: schema encoding/decoding roundtrips, type guard correctness, validation edge cases. Ensure all SDK schemas match expected structures. [NICE-TO-HAVE: test coverage can be added incrementally]","status":"closed","priority":3,"type":"task","assignee":"claude","labels":["sdk-harmonization","tests"],"deps":[],"commits":["03d96e4f"],"comments":[],"createdAt":"2025-12-03T04:43:30.521Z","updatedAt":"2025-12-03T06:34:01.611Z","closedAt":"2025-12-03T06:34:01.611Z","closeReason":"Created comprehensive SDK schema integration tests. Added 29 tests covering tool inputs (file/shell/search operations), tool outputs (structured outputs, grep modes, content types), messages (content blocks, SDK messages, chat messages), permissions (modes, behaviors, results), and edge cases (validation, roundtrips, type guards). All tests validate encoding/decoding roundtrips and type guard correctness."}
{"id":"oa-1c2663","title":"Create result adapter (src/schemas/sdk/adapters/result-adapter.ts)","description":"Implement ToolResult <-> CallToolResult and SubagentResult conversion. Map content arrays, error flags, and metadata between OpenAgents and SDK formats.","status":"closed","priority":1,"type":"task","labels":["sdk-harmonization","adapters","results"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:42:20.152Z","updatedAt":"2025-12-03T05:22:16.530Z","closedAt":"2025-12-03T05:22:16.530Z","closeReason":"Implemented result adapter with ToolResult <-> McpCallToolResult conversion, SubagentResult conversions, utility functions, and 26 passing tests"}
{"id":"oa-22dd2b","title":"Create SDK hooks schemas (src/schemas/sdk/hooks.ts)","description":"Define HookEvent, BaseHookInput, PreToolUseHookInput, PostToolUseHookInput, SessionStartHookInput, SessionEndHookInput, HookJSONOutput schemas matching Claude Agent SDK hook system. [NICE-TO-HAVE: only needed if we implement SDK hook compatibility]","status":"closed","priority":3,"type":"task","assignee":"claude","labels":["sdk-harmonization","schemas","hooks"],"deps":[],"commits":["190dbc63","6d3ad0bb"],"comments":[],"createdAt":"2025-12-03T04:41:44.885Z","updatedAt":"2025-12-03T06:24:23.124Z","closedAt":"2025-12-03T06:24:23.124Z","closeReason":"Created SDK hook schemas matching Claude Agent SDK. Implemented all hook input types (PreToolUse, PostToolUse, SessionStart, SessionEnd, etc.), hook output types (async/sync variants), and type guards. Added 17 tests covering all schemas. Ready for SDK hook compatibility integration."}
{"id":"oa-2782d2","title":"Create subagent router (src/interop/router/subagent-router.ts)","description":"Implement runBestAvailableSubagent() that routes to Claude Code or minimal subagent based on config. Include shouldUseClaudeCode heuristics with label overrides and complexity estimation.","status":"closed","priority":1,"type":"task","labels":["sdk-harmonization","interop","router"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:42:37.660Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":"2025-12-03T05:07:37.356Z","closeReason":"Implemented: src/agent/orchestrator/subagent-router.ts"}
{"id":"oa-37cece","title":"Epic: Harmonize Effect schemas with Claude Agent SDK","description":"","status":"closed","priority":1,"type":"epic","labels":["sdk-harmonization","claude-sdk"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:41:22.656Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":"2025-12-03T05:07:37.356Z","closeReason":"Duplicate epic - see oa-17d0cd"}
{"id":"oa-48215f","title":"Migrate edit tool to SDK naming + add replace_all","description":"Update src/tools/edit.ts: path -> file_path, oldText -> old_string, newText -> new_string. Add replace_all parameter. [LOW-PRIORITY: Only do if we need SDK symmetry. Internal callers keep existing names; SDK naming lives in src/schemas/sdk only.]","status":"open","priority":4,"type":"task","labels":["sdk-harmonization","tools","migration","low-priority-migration"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:42:54.458Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":null}
{"id":"oa-5dc986","title":"Create SDK agent definition schemas (src/schemas/sdk/agents.ts)","description":"Define AgentDefinition, SubagentConfig, SubagentResult schemas matching Claude Agent SDK agent patterns. Include fields for tools, model, permissions, session resume. [NICE-TO-HAVE: only needed for full SDK agent compatibility]","status":"closed","priority":3,"type":"task","assignee":"claude","labels":["sdk-harmonization","schemas","agents"],"deps":[],"commits":["80ac4187"],"comments":[],"createdAt":"2025-12-03T04:41:58.467Z","updatedAt":"2025-12-03T06:27:52.908Z","closedAt":"2025-12-03T06:27:52.908Z","closeReason":"Created SDK agent definition schemas matching Claude Agent SDK. Implemented AgentDefinition (programmatic subagent config), SubagentConfig (invocation params), SubagentResult (execution results with session metadata), SessionMetadata (resume support), and AgentRegistry (agent lookup). Includes model selection, permission mode integration, session forking, and usage tracking. Added 23 tests covering all schemas and type guards."}
{"id":"oa-6fa69b","title":"Migrate grep tool to SDK naming","description":"Update src/tools/grep.ts to align with SDK GrepInput. [LOW-PRIORITY: Only do if we need SDK symmetry. Internal callers keep existing names; SDK naming lives in src/schemas/sdk only.]","status":"open","priority":4,"type":"task","labels":["sdk-harmonization","tools","migration","low-priority-migration"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:43:11.792Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":null}
{"id":"oa-75c6dd","title":"Wire subagent router into orchestrator","description":"Update src/agent/orchestrator/orchestrator.ts to use runBestAvailableSubagent from interop router. Pass ClaudeCodeConfig from project.json. Ensure fallback handling works correctly.","status":"closed","priority":1,"type":"task","labels":["sdk-harmonization","interop","integration"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:43:16.195Z","updatedAt":"2025-12-03T05:37:14.027Z","closedAt":"2025-12-03T05:37:14.027Z","closeReason":"Orchestrator already uses runBestAvailableSubagent from subagent-router.ts, passes claudeCode config from project.json, and has proper fallback handling"}
{"id":"oa-798519","title":"Add tests for subagent router","description":"Create tests for runBestAvailableSubagent covering: CC available/unavailable, config-based routing, label overrides, fallback on failure, complexity heuristics.","status":"closed","priority":1,"type":"task","labels":["sdk-harmonization","tests","router"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:43:33.185Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":"2025-12-03T05:07:37.356Z","closeReason":"Implemented: src/agent/orchestrator/subagent-router.test.ts"}
{"id":"oa-80094f","title":"Create MechaCoder MCP bridge (src/interop/mcp-bridge.ts)","description":"Implement createMechaCoderMcpServer with subtask_complete, request_help, read_progress MCP tools for Claude Code coordination with orchestrator.","status":"closed","priority":1,"type":"task","labels":["sdk-harmonization","interop","mcp"],"deps":[],"commits":["d986b69a"],"comments":[],"createdAt":"2025-12-03T04:42:38.650Z","updatedAt":"2025-12-03T05:34:46.357Z","closedAt":"2025-12-03T05:34:46.357Z","closeReason":"Implemented createMechaCoderMcpServer with subtask_complete, request_help, and read_progress MCP tools for Claude Code coordination"}
{"id":"oa-8040d9","title":"Add tests for adapters","description":"Create tests for effect-to-zod, tool-adapter, message-adapter, result-adapter. Test bidirectional conversions, roundtrips, edge cases (empty content, multi-block messages). [NICE-TO-HAVE: test coverage can be added incrementally]","status":"closed","priority":3,"type":"task","labels":["sdk-harmonization","tests","adapters"],"deps":[],"commits":["f15db21e3bf5661bdfecca38a8524c9be62d9f87"],"comments":[],"createdAt":"2025-12-03T04:43:31.688Z","updatedAt":"2025-12-04T16:46:42.169Z","closedAt":"2025-12-04T16:46:42.169Z","closeReason":"Added adapter test coverage"}
{"id":"oa-83ff3d","title":"Migrate read tool to SDK naming","description":"Update src/tools/read.ts to use SDK naming: path -> file_path. [LOW-PRIORITY: Only do if we need SDK symmetry. Internal callers keep existing names; SDK naming lives in src/schemas/sdk only.]","status":"open","priority":4,"type":"task","labels":["sdk-harmonization","tools","migration","low-priority-migration"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:42:53.253Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":null}
{"id":"oa-8dcf98","title":"Create Effect Schema to Zod converter (src/schemas/sdk/adapters/effect-to-zod.ts)","description":"Implement effectSchemaToZod function that converts Effect Schema AST to equivalent Zod schema. Handle String, Number, Boolean, Literal, Union, Struct, Array, Optional types. Required for MCP tool compatibility.","status":"closed","priority":1,"type":"task","labels":["sdk-harmonization","adapters","schema-conversion"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:42:16.671Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":"2025-12-03T05:07:37.356Z","closeReason":"Implemented: src/schemas/sdk/adapters/effect-to-zod.ts"}
{"id":"oa-938e4a","title":"Add ClaudeCodeConfig to project.json schema (src/interop/router/config.ts)","description":"Create ClaudeCodeConfig schema with enabled, preferForComplexTasks, maxTurnsPerSubtask, permissionMode, fallbackToMinimal, complexityThreshold, forceMinimalLabels, forceClaudeCodeLabels fields. Add to ProjectConfig in src/tasks/schema.ts.","status":"closed","priority":1,"type":"task","labels":["sdk-harmonization","interop","config"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:42:36.593Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":"2025-12-03T05:07:37.356Z","closeReason":"Implemented: claudeCode config in project.json"}
{"id":"oa-985f9d","title":"Migrate find tool to SDK naming","description":"Update src/tools/find.ts to match SDK patterns. [LOW-PRIORITY: Only do if we need SDK symmetry. Internal callers keep existing names; SDK naming lives in src/schemas/sdk only.]","status":"open","priority":4,"type":"task","labels":["sdk-harmonization","tools","migration","low-priority-migration"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:43:13.732Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":null}
{"id":"oa-9e9a81","title":"Create SDK permissions schemas (src/schemas/sdk/permissions.ts)","description":"Define PermissionMode, PermissionResult, PermissionBehavior, PermissionRuleValue, CanUseTool schemas matching Claude Agent SDK permission system. [NICE-TO-HAVE: only needed if we expose SDK permission interface]","status":"closed","priority":3,"type":"task","labels":["sdk-harmonization","schemas","permissions"],"deps":[],"commits":["e51b3e3e"],"comments":[],"createdAt":"2025-12-03T04:41:57.529Z","updatedAt":"2025-12-03T06:27:12.636Z","closedAt":"2025-12-03T06:27:12.636Z","closeReason":"Added SDK permission schemas"}
{"id":"oa-a3362b","title":"Create SDK schemas index (src/schemas/sdk/index.ts)","description":"Create index.ts that re-exports all SDK types from tool-inputs, tool-outputs, messages, hooks, permissions, agents, usage, and type-guards. Organize exports logically.","status":"closed","priority":1,"type":"task","labels":["sdk-harmonization","schemas"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:43:34.233Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":"2025-12-03T05:07:37.356Z","closeReason":"Implemented: src/schemas/sdk/index.ts"}
{"id":"oa-a3a954","title":"Create SDK usage/cost schemas (src/schemas/sdk/usage.ts)","description":"Define TokenUsage, CostBreakdown, NonNullableUsage schemas for tracking input/output tokens, cache usage, and cost in USD. [NICE-TO-HAVE: only needed for SDK-style usage reporting]","status":"closed","priority":3,"type":"task","labels":["sdk-harmonization","schemas","usage"],"deps":[],"commits":["9e7418a9e5ce00aa483b99ad21cb6252dd0c4881"],"comments":[],"createdAt":"2025-12-03T04:41:59.799Z","updatedAt":"2025-12-04T15:28:55.832Z","closedAt":"2025-12-04T15:28:55.832Z","closeReason":"Added SDK usage/cost schemas"}
{"id":"oa-a5fc11","title":"Create SDK message schemas (src/schemas/sdk/messages.ts)","description":"Define SDKMessage union, ContentBlock types (TextBlock, ThinkingBlock, ToolUseBlock, ToolResultBlock), SDKUserMessage, SDKAssistantMessage, SDKResultMessage matching Claude Agent SDK message patterns.","status":"closed","priority":1,"type":"task","labels":["sdk-harmonization","schemas","messages"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:41:42.895Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":"2025-12-03T05:07:37.356Z","closeReason":"Implemented: src/schemas/sdk/messages.ts"}
{"id":"oa-b46778","title":"Epic: Harmonize Effect schemas with Claude Agent SDK","description":"","status":"closed","priority":1,"type":"epic","labels":["sdk-harmonization","claude-sdk"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:41:14.687Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":"2025-12-03T05:07:37.356Z","closeReason":"Duplicate epic - see oa-17d0cd"}
{"id":"oa-b5d6c7","title":"Migrate ls tool to SDK naming","description":"Update src/tools/ls.ts to match SDK patterns. [LOW-PRIORITY: Only do if we need SDK symmetry. Internal callers keep existing names; SDK naming lives in src/schemas/sdk only.]","status":"open","priority":4,"type":"task","labels":["sdk-harmonization","tools","migration","low-priority-migration"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:43:14.782Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":null}
{"id":"oa-bbb4bf","title":"Migrate write tool to SDK naming","description":"Update src/tools/write.ts to use SDK naming: path -> file_path. [LOW-PRIORITY: Only do if we need SDK symmetry. Internal callers keep existing names; SDK naming lives in src/schemas/sdk only.]","status":"open","priority":4,"type":"task","labels":["sdk-harmonization","tools","migration","low-priority-migration"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:42:56.107Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":null}
{"id":"oa-c4b9e0","title":"Migrate bash tool + add new params","description":"Update src/tools/bash.ts: add description and run_in_background parameters. [LOW-PRIORITY: Only do if we need SDK symmetry. Internal callers keep existing names; SDK naming lives in src/schemas/sdk only.]","status":"open","priority":4,"type":"task","labels":["sdk-harmonization","tools","migration","low-priority-migration"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:42:57.519Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":null}
{"id":"oa-d079d0","title":"Create tool adapter for MCP (src/schemas/sdk/adapters/tool-adapter.ts)","description":"Implement effectToolToMcpTool that wraps Effect Tool interface for Claude SDK MCP servers. Convert schema via effect-to-zod, wrap execute() with Effect runtime, map ToolResult to CallToolResult.","status":"closed","priority":1,"type":"task","labels":["sdk-harmonization","adapters","mcp"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:42:17.850Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":"2025-12-03T05:07:37.356Z","closeReason":"Implemented: src/schemas/sdk/adapters/tool-adapter.ts"}
{"id":"oa-dfa44f","title":"Create type guards (src/schemas/sdk/type-guards.ts)","description":"Create type guard functions: isTextBlock, isThinkingBlock, isToolUseBlock, isToolResultBlock, isSDKUserMessage, isSDKAssistantMessage, isSDKResultMessage for runtime type discrimination.","status":"closed","priority":2,"type":"task","labels":["sdk-harmonization","schemas","types"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:42:01.280Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":"2025-12-03T05:07:37.356Z","closeReason":"Implemented: type guards in messages.ts (isTextBlock, isToolUseBlock, etc.)"}
{"id":"oa-e6bbbc","title":"Create message adapter (src/schemas/sdk/adapters/message-adapter.ts)","description":"Implement bidirectional ChatMessage <-> SDKMessage conversion. Handle user/assistant/tool role mappings, tool_call_id preservation, content block conversion.","status":"closed","priority":1,"type":"task","labels":["sdk-harmonization","adapters","messages"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:42:19.027Z","updatedAt":"2025-12-03T05:18:26.486Z","closedAt":"2025-12-03T05:18:26.486Z","closeReason":"Implemented message adapter with bidirectional ChatMessage <-> SDKMessage conversion, content block conversion, tool call conversion, and 19 passing tests"}
{"id":"oa-f66ee4","title":"Create SDK tool output schemas (src/schemas/sdk/tool-outputs.ts)","description":"Define ReadOutput, EditOutput, WriteOutput, BashOutput, GrepOutput, GlobOutput schemas with SDK-compatible structure. Include ToolContent union (text/image), metadata fields (total_lines, truncated, diff, exitCode).","status":"closed","priority":1,"type":"task","labels":["sdk-harmonization","schemas","tools"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T04:41:41.888Z","updatedAt":"2025-12-03T05:07:37.356Z","closedAt":"2025-12-03T05:07:37.356Z","closeReason":"Implemented: src/schemas/sdk/tool-outputs.ts"}
{"id":"oa-e21ac5","title":"Add task archival/compaction for .openagents tasks.jsonl","description":"Design and ship a repeatable archival/compaction flow so closed/old/outdated tasks move from .openagents/tasks.jsonl into a separate archive file while keeping history accessible. Extend the Effect TaskService/CLI to support archiving and reading archived tasks (e.g., .openagents/tasks-archive.jsonl), include age/status filters, tests, and docs so MechaCoder/external agents can run it without manual editing.","status":"closed","priority":2,"type":"chore","labels":["task-system","archival"],"deps":[],"commits":["c6f4373e9aa85ed5b05a286be6a2324d92759746"],"comments":[],"createdAt":"2025-12-03T06:31:21.267Z","updatedAt":"2025-12-03T08:14:45.503Z","closedAt":"2025-12-03T08:14:45.503Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-cc-switch-01","title":"Wire orchestrator into do-one-task.ts","description":"Make orchestrator the default path, but keep old Grok-based agentLoop as backup. Add --legacy flag or useOrchestrator: false config to use old path when needed.","status":"closed","priority":0,"type":"task","labels":["claude-code","mechacoder","switchover"],"deps":[{"id":"oa-pi17","type":"blocks"}],"commits":[],"comments":[],"createdAt":"2025-12-03T07:00:00Z","updatedAt":"2025-12-03T08:00:00Z","closedAt":"2025-12-03T08:00:00Z"}
{"id":"oa-cc-switch-02","title":"Add orchestrator CLI command","description":"Create bun run mechacoder:orchestrator --dir . --once entry that uses runOrchestrator directly. This becomes the primary entrypoint for CC-first operation.","status":"closed","priority":0,"type":"task","labels":["claude-code","mechacoder","cli","switchover"],"deps":[{"id":"oa-cc-switch-01","type":"blocks"}],"commits":[],"comments":[],"createdAt":"2025-12-03T07:00:00Z","updatedAt":"2025-12-03T08:00:00Z","closedAt":"2025-12-03T08:00:00Z"}
{"id":"oa-cc-switch-03","title":"Wire orchestrator into overnight.ts","description":"Update overnight multi-task runner to use orchestrator flow instead of direct agentLoop.","status":"closed","priority":1,"type":"task","labels":["claude-code","mechacoder","switchover"],"deps":[{"id":"oa-cc-switch-01","type":"blocks"}],"commits":[],"comments":[],"createdAt":"2025-12-03T07:00:00Z","updatedAt":"2025-12-03T08:15:00Z","closedAt":"2025-12-03T08:15:00Z"}
{"id":"oa-cc-switch-04","title":"E2E validation with real CC tasks","description":"Run 2-3 real tasks through orchestrator+CC path, verify commit/push/close works end-to-end. Document any issues found.","status":"closed","priority":1,"type":"task","labels":["claude-code","mechacoder","testing","switchover"],"deps":[{"id":"oa-cc-switch-02","type":"blocks"}],"commits":[],"comments":[],"createdAt":"2025-12-03T07:00:00Z","updatedAt":"2025-12-03T08:30:00Z","closedAt":"2025-12-03T08:30:00Z","closeReason":"E2E validated: orchestrator starts, typecheck runs, task selected, subtask created, routing works correctly (simple tasks -> minimal, complex -> CC). OpenRouter :free suffix working."}
{"id":"oa-cc-switch-05","title":"Update project.json defaults for CC","description":"Set claudeCode.enabled=true, claudeCode.preferForComplexTasks=true as defaults. Ensure fallbackToMinimal=true.","status":"closed","priority":1,"type":"task","labels":["claude-code","mechacoder","config","switchover"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T07:00:00Z","updatedAt":"2025-12-03T08:20:00Z","closedAt":"2025-12-03T08:20:00Z"}
{"id":"oa-cc-switch-bug01","title":"Fix OpenRouter model slug to use :free suffix","description":"OpenRouter API now requires x-ai/grok-4.1-fast:free instead of x-ai/grok-4.1-fast. Update model slug in OpenRouter client/config.","status":"closed","priority":0,"type":"bug","labels":["openrouter","mechacoder","blocker"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T08:00:00Z","updatedAt":"2025-12-03T08:10:00Z","closedAt":"2025-12-03T08:10:00Z"}
{"id":"oa-d3965f","title":"Resume Claude Code session when task continues across cycles","description":"When a subtask fails with error_max_turns and the orchestrator retries in the next cycle, pass the previous Claude Code session ID so it can resume with full context rather than starting fresh.\n\nCurrently each cycle gets a new session ID (e.g., f7e10y vs zdjbey), losing all context from the previous attempt. With session resumption, Claude Code would continue where it left off.\n\nImplementation:\n1. Store the Claude Code session ID in the subtask when it fails\n2. On retry, pass resumeSessionId to runClaudeCodeSubagent\n3. The SDK's resume option will restore the full conversation context","status":"closed","priority":2,"type":"feature","labels":["claude-code","orchestrator"],"deps":[],"commits":["88775ee4"],"comments":[],"createdAt":"2025-12-03T07:34:26.438Z","updatedAt":"2025-12-03T07:37:30.008Z","closedAt":"2025-12-03T07:37:30.008Z","closeReason":"Implemented - infrastructure already existed, added logging and bug fix"}
{"id":"oa-8067e5","title":"Epic: WebSocket Streaming for MechaCoder HUD UI","description":"Connect MechaCoder agent flow to the HUD UI via WebSocket for real-time updates.\n\n## Goal\nReplace 5-second polling in Electrobun HUD with WebSocket push for:\n- OrchestratorEvents (task_selected, subtask_start, verification_complete, etc.)\n- Claude Code text output (streaming)\n- Tool call JSON\n\n## Architecture\n```\n+------------------------------------------------------------------+\n|                     ELECTROBUN DESKTOP APP                        |\n|  +------------------------------------------------------------+  |\n|  |                   mainview (UI Process)                     |  |\n|  |                                                             |  |\n|  |  +-----------------------+   +-------------------------+    |  |\n|  |  |   Bun.serve()         |   |    SVG Flow HUD         |    |  |\n|  |  |   WebSocket SERVER    |-->|    Real-time updates    |    |  |\n|  |  |   ws://localhost:4242 |   +-------------------------+    |  |\n|  |  +-----------------------+                                  |  |\n|  +------------------------------------------------------------+  |\n+------------------------------------------------------------------+\n               ^ WebSocket Connection(s)\n               |\n+--------------|----------------------------------------------------+\n|   AGENT PROCESS (overnight.ts / do-one-task.ts)                   |\n|              |                                                    |\n|  +---------------------------+                                    |\n|  |  HudClient (WebSocket)    |                                    |\n|  |  - Auto-reconnect         |                                    |\n|  |  - Queue when disconnected|                                    |\n|  +------------|--------------+                                    |\n|               ^                                                   |\n|               |                                                   |\n|  +------------+---------------+    +---------------------------+  |\n|  |   Orchestrator             |--->|   Claude Code Subagent    |  |\n|  |   emit(event) --> HudClient|    |   onOutput --> HudClient  |  |\n|  +----------------------------+    +---------------------------+  |\n+-------------------------------------------------------------------+\n```\n\n## Design Decisions\n- Native WebSocket (not Effect PubSub) - agent has single subscriber\n- Bun.serve() for server - native to Electrobun\n- Silent fail if HUD not running - agent continues working\n- Message queue during reconnect - don't lose events\n- Port 4242 - arbitrary but memorable","status":"closed","priority":1,"type":"epic","labels":["hud","websocket","streaming","ui"],"deps":[],"commits":["1de59208ba872d1ae2d22c76d37ea89e85f16e77"],"comments":[],"createdAt":"2025-12-03T07:53:01.386Z","updatedAt":"2025-12-03T08:07:50.866Z","closedAt":"2025-12-03T08:07:50.866Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-e38c26","title":"Create HUD protocol types (src/hud/protocol.ts)","description":"Create the HUD message protocol type definitions.\n\n## File: src/hud/protocol.ts\n\n## HudMessage Union Type\n```typescript\nexport type HudMessage =\n  // Orchestrator lifecycle events\n  | { type: \"session_start\"; sessionId: string; ts: string }\n  | { type: \"session_complete\"; success: boolean; summary: string; ts: string }\n  | { type: \"task_selected\"; taskId: string; title: string; ts: string }\n  | { type: \"subtask_start\"; subtaskId: string; description: string; ts: string }\n  | { type: \"subtask_complete\"; subtaskId: string; success: boolean; agent: string; ts: string }\n  | { type: \"subtask_failed\"; subtaskId: string; error: string; ts: string }\n  | { type: \"verification_start\"; command: string; ts: string }\n  | { type: \"verification_complete\"; command: string; passed: boolean; ts: string }\n  | { type: \"commit_created\"; sha: string; message: string; ts: string }\n  | { type: \"push_complete\"; branch: string; ts: string }\n  | { type: \"error\"; phase: string; error: string; ts: string }\n  // Streaming text from Claude Code\n  | { type: \"text\"; text: string; ts: string }\n  // Tool calls\n  | { type: \"tool_call\"; tool: string; input: unknown; ts: string }\n  // Control messages\n  | { type: \"agent_connect\"; agentId: string; cwd: string; ts: string }\n  | { type: \"agent_disconnect\"; agentId: string; ts: string };\n```\n\n## Helper Function\nAdd `mapOrchestratorEvent(event: OrchestratorEvent): HudMessage` to convert orchestrator events to HUD messages.\n\n## Reference\n- Read `src/agent/orchestrator/types.ts` for OrchestratorEvent definitions\n- All messages must include `ts: string` (ISO timestamp)\n- Keep types simple - no Effect dependencies in protocol","status":"closed","priority":1,"type":"task","labels":["hud","websocket","types"],"deps":[],"commits":["7f2fe8f5"],"comments":[],"createdAt":"2025-12-03T07:53:32.514Z","updatedAt":"2025-12-03T08:00:43.180Z","closedAt":"2025-12-03T08:00:43.180Z","closeReason":"Implemented: src/hud/protocol.ts with HudMessage types, mapOrchestratorEvent helper"}
{"id":"oa-1fc4ac","title":"Create HUD WebSocket client (src/hud/client.ts)","description":"Create WebSocket client for agents to send messages to HUD.\n\n## File: src/hud/client.ts\n\n## HudClient Class\n```typescript\nexport class HudClient {\n  private ws: WebSocket | null = null;\n  private queue: HudMessage[] = [];\n  private reconnectAttempts = 0;\n  private maxReconnectAttempts = 5;\n  private reconnectDelay = 1000;\n\n  connect(url: string = \"ws://localhost:4242\"): void\n  send(message: HudMessage): void  // Queues if disconnected\n  sendText(text: string): void     // Convenience for streaming text\n  sendToolCall(tool: string, input: unknown): void  // Convenience for tool calls\n  close(): void\n}\n```\n\n## Requirements\n- Auto-reconnect with exponential backoff (max 5 attempts)\n- Silent fail if HUD not running (agent continues working)\n- Queue messages during reconnect, flush on successful connect\n- Use native WebSocket (not ws package)\n- No Effect dependencies - plain TypeScript class\n\n## Error Handling\n- Log debug message if HUD not running, don't throw\n- On disconnect, attempt reconnect with backoff\n- On max reconnect failures, stop trying but don't crash agent\n\n## Reference\n- Import HudMessage from ./protocol.ts\n- See overnight.ts for how emit() and onOutput() callbacks work","status":"closed","priority":1,"type":"task","labels":["hud","websocket","client"],"deps":[{"id":"oa-e38c26","type":"blocks"}],"commits":["7f2fe8f5"],"comments":[],"createdAt":"2025-12-03T07:53:33.521Z","updatedAt":"2025-12-03T08:00:44.492Z","closedAt":"2025-12-03T08:00:44.492Z","closeReason":"Implemented: src/hud/client.ts with auto-reconnect, queue, exponential backoff"}
{"id":"oa-8ca3cc","title":"Create HUD WebSocket server (src/hud/server.ts)","description":"Create Bun.serve() WebSocket server for Electrobun HUD.\n\n## File: src/hud/server.ts\n\n## API\n```typescript\nexport interface HudServerOptions {\n  port?: number;  // Default: 4242\n  onMessage: (msg: HudMessage, agentId: string) => void;\n  onAgentConnect?: (agentId: string) => void;\n  onAgentDisconnect?: (agentId: string) => void;\n}\n\nexport function startHudServer(options: HudServerOptions): {\n  stop: () => void;\n  broadcast: (msg: HudMessage) => void;\n}\n```\n\n## Implementation\n- Use Bun.serve() with websocket handlers\n- Track connected agents by agentId (from agent_connect message)\n- Parse incoming JSON messages and validate as HudMessage\n- Call onMessage callback for each valid message\n- Support graceful shutdown via stop() function\n\n## WebSocket Handlers\n```typescript\nwebsocket: {\n  open(ws) { /* log connection, wait for agent_connect */ },\n  message(ws, data) { /* parse JSON, validate, call onMessage */ },\n  close(ws) { /* call onAgentDisconnect if known agent */ },\n}\n```\n\n## Error Handling\n- Invalid JSON: log and ignore\n- Unknown message type: log and ignore\n- Server startup failure: throw (Electrobun should handle)\n\n## Reference\n- Import HudMessage from ./protocol.ts\n- See CLAUDE.md for Bun.serve() patterns","status":"closed","priority":1,"type":"task","labels":["hud","websocket","server","electrobun"],"deps":[{"id":"oa-e38c26","type":"blocks"}],"commits":["7f2fe8f5"],"comments":[],"createdAt":"2025-12-03T07:53:34.983Z","updatedAt":"2025-12-03T08:00:45.677Z","closedAt":"2025-12-03T08:00:45.677Z","closeReason":"Implemented: src/hud/server.ts with Bun.serve() WebSocket server"}
{"id":"oa-2567a6","title":"Create HUD module exports (src/hud/index.ts)","description":"Create index.ts that exports public HUD API.\n\n## File: src/hud/index.ts\n\n## Exports\n```typescript\n// Types\nexport type { HudMessage } from \"./protocol.js\";\nexport { mapOrchestratorEvent } from \"./protocol.js\";\n\n// Client (for agents)\nexport { HudClient } from \"./client.js\";\n\n// Server (for Electrobun)\nexport { startHudServer } from \"./server.js\";\nexport type { HudServerOptions } from \"./server.js\";\n```\n\n## Notes\n- Keep exports minimal - only public API\n- Client and server can be imported separately\n- This allows agents to import just HudClient without server code","status":"closed","priority":2,"type":"task","labels":["hud","exports"],"deps":[{"id":"oa-e38c26","type":"blocks"},{"id":"oa-1fc4ac","type":"blocks"},{"id":"oa-8ca3cc","type":"blocks"}],"commits":["7f2fe8f5"],"comments":[],"createdAt":"2025-12-03T07:53:36.001Z","updatedAt":"2025-12-03T08:00:47.439Z","closedAt":"2025-12-03T08:00:47.439Z","closeReason":"Implemented: src/hud/index.ts with all exports"}
{"id":"oa-574d83","title":"Integrate HudClient into overnight.ts","description":"Wire HudClient into the overnight agent to send events and streaming output to HUD.\n\n## File: src/agent/overnight.ts\n\n## Changes\n\n### 1. Import and instantiate HudClient\n```typescript\nimport { HudClient, mapOrchestratorEvent } from \"../hud/index.js\";\n\nconst hudClient = new HudClient();\nhudClient.connect();\n```\n\n### 2. Wrap existing emit() to also send to HUD\n```typescript\nconst emit = (event: OrchestratorEvent) => {\n  logOrchestratorEvent(event);  // Existing logging\n  hudClient.send(mapOrchestratorEvent(event));  // Send to HUD\n};\n```\n\n### 3. Wrap existing onOutput() to also send to HUD\n```typescript\nconst onOutput = (text: string) => {\n  process.stdout.write(text);  // Existing console output\n  hudClient.sendText(text);    // Send to HUD\n};\n```\n\n### 4. Send tool calls (modify claude-code-subagent callback)\nUpdate the tool call logging to also send to HUD:\n```typescript\n// In the tool call logging section\nhudClient.sendToolCall(call.name, call.input);\n```\n\n### 5. Clean up on exit\n```typescript\n// At end of run or in finally block\nhudClient.close();\n```\n\n## Notes\n- HudClient silently fails if HUD not running - overnight.ts continues normally\n- No changes to core orchestrator logic, just wrapping callbacks\n- Agent sends agent_connect on startup, agent_disconnect on shutdown\n\n## Reference\n- Current emit/onOutput wiring in overnight.ts\n- HudClient API from src/hud/client.ts","status":"closed","priority":1,"type":"task","labels":["hud","websocket","integration","overnight"],"deps":[{"id":"oa-1fc4ac","type":"blocks"}],"commits":["2c4cf25bd28a0af63cf461aa104865482e593f82"],"comments":[],"createdAt":"2025-12-03T07:53:37.191Z","updatedAt":"2025-12-03T08:09:30.821Z","closedAt":"2025-12-03T08:09:30.821Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-4b9dce","title":"Integrate HudClient into do-one-task.ts","description":"Wire HudClient into the single-task agent, same pattern as overnight.ts.\n\n## File: src/agent/do-one-task.ts\n\n## Changes\nSame integration pattern as overnight.ts:\n\n1. Import HudClient and mapOrchestratorEvent\n2. Create and connect HudClient instance\n3. Wrap emit() to send orchestrator events to HUD\n4. Wrap onOutput() to send streaming text to HUD\n5. Send tool calls to HUD\n6. Close HudClient on exit\n\n## Code Pattern\n```typescript\nimport { HudClient, mapOrchestratorEvent } from \"../hud/index.js\";\n\nconst hudClient = new HudClient();\nhudClient.connect();\n\n// Wrap emit\nconst emit = (event: OrchestratorEvent) => {\n  logOrchestratorEvent(event);\n  hudClient.send(mapOrchestratorEvent(event));\n};\n\n// Wrap onOutput\nconst onOutput = (text: string) => {\n  process.stdout.write(text);\n  hudClient.sendText(text);\n};\n\n// ... use emit and onOutput in orchestrator ...\n\n// Cleanup\nhudClient.close();\n```\n\n## Notes\n- This is a simpler agent than overnight.ts but same HUD integration\n- If do-one-task.ts doesn't exist yet, this may be deferred\n\n## Reference\n- See oa-574d83 (overnight.ts integration) for full pattern","status":"closed","priority":1,"type":"task","labels":["hud","websocket","integration"],"deps":[{"id":"oa-1fc4ac","type":"blocks"}],"commits":["46c99fb302e1f6b4b4b93748f65e9a8c8e435916"],"comments":[],"createdAt":"2025-12-03T07:53:38.839Z","updatedAt":"2025-12-03T08:11:50.473Z","closedAt":"2025-12-03T08:11:50.473Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-a8d5f9","title":"Integrate HUD server into mainview/index.ts","description":"Start HUD WebSocket server in Electrobun mainview and wire messages to UI state.\n\n## File: src/mainview/index.ts\n\n## Changes\n\n### 1. Import and start server\n```typescript\nimport { startHudServer, type HudMessage } from \"../hud/index.js\";\n\n// Start HUD server on app init\nconst hudServer = startHudServer({\n  port: 4242,\n  onMessage: handleHudMessage,\n  onAgentConnect: (agentId) => console.log(`Agent connected: ${agentId}`),\n  onAgentDisconnect: (agentId) => console.log(`Agent disconnected: ${agentId}`),\n});\n```\n\n### 2. Handle incoming messages\n```typescript\nfunction handleHudMessage(msg: HudMessage, agentId: string) {\n  switch (msg.type) {\n    case \"task_selected\":\n      updateCurrentTask(msg.taskId, msg.title);\n      break;\n    case \"subtask_start\":\n      addSubtaskToLog(msg.subtaskId, msg.description);\n      break;\n    case \"subtask_complete\":\n      markSubtaskComplete(msg.subtaskId, msg.success);\n      break;\n    case \"text\":\n      appendStreamingText(msg.text);\n      break;\n    case \"tool_call\":\n      addToolCallToLog(msg.tool, msg.input);\n      break;\n    // ... handle other message types\n  }\n}\n```\n\n### 3. Remove polling\nReplace the existing 5-second polling mechanism with message-driven updates.\n\n### 4. Graceful shutdown\n```typescript\n// On app exit\nhudServer.stop();\n```\n\n## UI Updates to Consider\n- Real-time event log panel\n- Streaming text output area\n- Tool call visualization\n- Task/subtask progress indicators\n- Agent connection status\n\n## Reference\n- Current mainview state management\n- src/flow/mechacoder-state.ts for state loading patterns\n- HUD server API from src/hud/server.ts","status":"closed","priority":1,"type":"task","labels":["hud","websocket","electrobun","ui"],"deps":[{"id":"oa-8ca3cc","type":"blocks"}],"commits":["150f2ba917e2b572ba178d8b2e70a82b714822f4"],"comments":[],"createdAt":"2025-12-03T07:53:40.328Z","updatedAt":"2025-12-03T08:13:46.945Z","closedAt":"2025-12-03T08:13:46.945Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-6c74e7","title":"Add tests for HUD protocol and client","description":"Add unit and integration tests for HUD protocol and client.\n\n## Files\n- src/hud/protocol.test.ts\n- src/hud/client.test.ts\n\n## Protocol Tests (protocol.test.ts)\n```typescript\nimport { test, expect } from \"bun:test\";\nimport { mapOrchestratorEvent } from \"./protocol.js\";\n\ntest(\"mapOrchestratorEvent converts task_selected\", () => {\n  const event = { type: \"task_selected\", task: { id: \"t1\", title: \"Test\" } };\n  const msg = mapOrchestratorEvent(event);\n  expect(msg.type).toBe(\"task_selected\");\n  expect(msg.taskId).toBe(\"t1\");\n  expect(msg.ts).toBeDefined();\n});\n\n// Test all event types map correctly\n// Test ts field is always present\n// Test unknown events throw or return error type\n```\n\n## Client Tests (client.test.ts)\n```typescript\nimport { test, expect } from \"bun:test\";\nimport { HudClient } from \"./client.js\";\n\ntest(\"HudClient queues messages when disconnected\", () => {\n  const client = new HudClient();\n  // Don't connect\n  client.send({ type: \"text\", text: \"hello\", ts: new Date().toISOString() });\n  // Verify message is queued (may need to expose queue for testing)\n});\n\ntest(\"HudClient flushes queue on connect\", async () => {\n  // Requires mock WebSocket server\n  // Start test server, connect client, verify queued messages arrive\n});\n\ntest(\"HudClient reconnects on disconnect\", async () => {\n  // Start server, connect, kill server, restart, verify reconnect\n});\n\ntest(\"HudClient silently fails when server unavailable\", () => {\n  const client = new HudClient();\n  // Should not throw\n  expect(() => client.connect()).not.toThrow();\n});\n```\n\n## Integration Test (optional)\n- Start HUD server\n- Create HudClient, connect\n- Send messages, verify server receives\n- Disconnect, reconnect, verify queue flushed\n\n## Reference\n- Use bun:test\n- See existing test patterns in src/**/*.test.ts","status":"closed","priority":2,"type":"task","labels":["hud","testing"],"deps":[{"id":"oa-e38c26","type":"blocks"},{"id":"oa-1fc4ac","type":"blocks"}],"commits":["4fb03c9bebf04a25f4d0f3824e7dd8b16d9e05a0"],"comments":[],"createdAt":"2025-12-03T07:53:41.559Z","updatedAt":"2025-12-03T08:33:39.019Z","closedAt":"2025-12-03T08:33:39.019Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-4e8aa5","title":"Task System Enhancement Epic (from beads)","description":"Port valuable features from beads CLI to our task system. Includes: reopen, stats, stale detection, doctor/validate, comments, delete/cleanup, config CLI, duplicates/merge, git hooks, compaction, and more.","status":"closed","priority":2,"type":"epic","labels":["enhancement","infrastructure","beads-port"],"deps":[],"commits":["927d60478b029fda45aa7174c907012f34092788"],"comments":[],"createdAt":"2025-12-03T08:04:30.232Z","updatedAt":"2025-12-03T08:43:37.709Z","closedAt":"2025-12-03T08:43:37.709Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-d51a28","title":"Add tasks:reopen command","description":"Add reopen command to set closed tasks back to open status. Simple status transition from closed → open, clearing closedAt and closeReason.","status":"closed","priority":3,"type":"task","labels":["beads-port","cli","tier-1"],"deps":[],"commits":["78e00f383f3e26f019413da8b68a8f5a8eab701a"],"comments":[],"createdAt":"2025-12-03T08:04:41.873Z","updatedAt":"2025-12-03T08:42:42.544Z","closedAt":"2025-12-03T08:42:42.544Z","closeReason":"Implemented: added reopenTask function to service.ts and cmdReopen to CLI"}
{"id":"oa-cfba10","title":"Add tasks:stats command","description":"Add stats command showing task counts by status, type, and priority. Output format: grouped counts for quick project health overview.","status":"closed","priority":3,"type":"task","labels":["beads-port","cli","tier-1"],"deps":[],"commits":["78e00f383f3e26f019413da8b68a8f5a8eab701a"],"comments":[],"createdAt":"2025-12-03T08:04:42.761Z","updatedAt":"2025-12-03T08:42:49.314Z","closedAt":"2025-12-03T08:42:49.314Z","closeReason":"Implemented: added getTaskStats function and cmdStats to CLI"}
{"id":"oa-54c465","title":"Add tasks:stale command","description":"Add stale command to find tasks not updated in N days. Options: --days (default 30), filter by status. Helps find forgotten work.","status":"closed","priority":3,"type":"task","labels":["beads-port","cli","tier-1"],"deps":[],"commits":["78e00f383f3e26f019413da8b68a8f5a8eab701a"],"comments":[],"createdAt":"2025-12-03T08:04:44.134Z","updatedAt":"2025-12-03T08:42:49.455Z","closedAt":"2025-12-03T08:42:49.455Z","closeReason":"Implemented: added getStaleTasks function and cmdStale to CLI"}
{"id":"oa-b8bc22","title":"Add tasks:show command with dependency tree","description":"Add show command to display single task with full details and dependency tree visualization. Show what blocks this task and what it blocks.","status":"closed","priority":3,"type":"task","labels":["beads-port","cli","tier-1"],"deps":[],"commits":["78e00f383f3e26f019413da8b68a8f5a8eab701a"],"comments":[],"createdAt":"2025-12-03T08:04:45.095Z","updatedAt":"2025-12-03T08:42:49.595Z","closedAt":"2025-12-03T08:42:49.595Z","closeReason":"Implemented: added getTaskWithDeps function and cmdShow to CLI with dependency tree"}
{"id":"oa-65d5fe","title":"Add tasks:doctor command","description":"Add doctor command to diagnose task file issues: parse errors, invalid IDs, missing required fields, orphan dependencies, circular deps, stale in_progress tasks.","status":"closed","priority":3,"type":"task","labels":["beads-port","cli","tier-2"],"deps":[],"commits":["f5537f18236fad7cd18980a04d848d8050c295c4"],"comments":[],"createdAt":"2025-12-03T08:05:01.956Z","updatedAt":"2025-12-04T16:37:42.950Z","closedAt":"2025-12-04T16:37:42.950Z","closeReason":"Implemented doctor command"}
{"id":"oa-a4eb48","title":"Add tasks:validate command","description":"Add validate command to check data integrity: orphan deps (reference non-existent tasks), conflict markers in file, schema violations. Separate from doctor for targeted checks.","status":"closed","priority":3,"type":"task","labels":["beads-port","cli","tier-2"],"deps":[],"commits":["8a301fb83327777a65f26874c2dc9b580100b6d9"],"comments":[],"createdAt":"2025-12-03T08:05:02.932Z","updatedAt":"2025-12-04T16:21:27.316Z","closedAt":"2025-12-04T16:21:27.316Z","closeReason":"Added orphan dependency validation to tasks:validate CLI"}
{"id":"oa-18fb6b","title":"Add tasks:delete command with cascade","description":"Add delete command to remove tasks. Options: --id, --cascade (delete all dependent tasks), --dry-run. Permanent removal unlike close.","status":"closed","priority":3,"type":"task","labels":["beads-port","cli","tier-2"],"deps":[],"commits":["aaf85c5bc14b709599636a65e17de150937a06c8"],"comments":[],"createdAt":"2025-12-03T08:05:03.951Z","updatedAt":"2025-12-04T17:13:16.204Z","closedAt":"2025-12-04T17:13:16.204Z","closeReason":"Added tasks:delete CLI with cascade support"}
{"id":"oa-45ff3a","title":"Add tasks:cleanup command","description":"Add cleanup command to bulk delete old closed tasks. Options: --older-than (e.g., 30d, 90d), --dry-run to preview, --cascade.","status":"closed","priority":3,"type":"task","labels":["beads-port","cli","tier-2"],"deps":[],"commits":["76e675ca0bd34a72a1c6944129fa092bea14876c"],"comments":[],"createdAt":"2025-12-03T08:05:05.742Z","updatedAt":"2025-12-04T17:02:32.348Z","closedAt":"2025-12-04T17:02:32.348Z","closeReason":"Added cleanup CLI"}
{"id":"oa-0b7181","title":"Add tasks:config get/set/list commands","description":"Add config CLI for project.json: tasks:config get <key>, tasks:config set <key> <value>, tasks:config list. Modify project settings without editing JSON.","status":"closed","priority":3,"type":"task","labels":["beads-port","cli","tier-2"],"deps":[],"commits":["3c5e99a01d689de9dd8d94da5a09a5f3dff4ed37"],"comments":[],"createdAt":"2025-12-03T08:05:07.252Z","updatedAt":"2025-12-04T16:52:10.031Z","closedAt":"2025-12-04T16:52:10.031Z","closeReason":"Added config list/get/set commands"}
{"id":"oa-d2b079","title":"Add Comment schema to Task","description":"Add comments field to Task schema: Comment[] with id, text, author, createdAt. Optional field with empty array default. Update schema.ts and tests.","status":"closed","priority":3,"type":"task","labels":["beads-port","schema","tier-2"],"deps":[],"commits":["b46032dd4fdb2a2337f5212809aad88f312504d4"],"comments":[],"createdAt":"2025-12-03T08:05:08.568Z","updatedAt":"2025-12-04T17:24:16.087Z","closedAt":"2025-12-04T17:24:16.087Z","closeReason":"Added Comment schema and defaults"}
{"id":"oa-1bf91b","title":"Add tasks:comment add/list commands","description":"Add comment CLI: tasks:comment add --id <task> --text \"...\", tasks:comment list --id <task>. Requires Comment schema to be added first.","status":"closed","priority":3,"type":"task","labels":["beads-port","cli","tier-2"],"deps":[],"commits":["8618cd43569a31b76f298449097c782e67184221"],"comments":[],"createdAt":"2025-12-03T08:05:09.561Z","updatedAt":"2025-12-05T06:35:32.267Z","closedAt":"2025-12-05T06:35:32.267Z","closeReason":"Added comment add/list CLI and service support"}
{"id":"oa-a2797e","title":"Add tasks:duplicates command","description":"Add duplicates command to find similar/duplicate tasks. Match by content hash of title+description. Group by status (open with open, closed with closed).","status":"closed","priority":4,"type":"task","labels":["beads-port","cli","tier-3"],"deps":[],"commits":["60e6b68c21ca2cfaff746e7af0fb4db6ab47bd0c"],"comments":[],"createdAt":"2025-12-03T08:05:29.747Z","updatedAt":"2025-12-05T01:21:27.381Z","closedAt":"2025-12-05T01:21:27.381Z","closeReason":"Implemented tasks:duplicates command"}
{"id":"oa-84df15","title":"Add tasks:merge command","description":"Add merge command to consolidate duplicates: tasks:merge --ids <id1,id2> --into <target>. Redirect dependencies, update references, --dry-run preview.","status":"open","priority":4,"type":"task","labels":["beads-port","cli","tier-3"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T08:05:31.163Z","updatedAt":"2025-12-03T08:05:31.163Z","closedAt":null}
{"id":"oa-9367de","title":"Add tasks:rename-prefix command","description":"Add rename-prefix command to change ID prefix (e.g., oa → xyz). Updates all task IDs and references in descriptions, deps. --dry-run preview.","status":"closed","priority":4,"type":"task","labels":["beads-port","cli","tier-3"],"deps":[],"commits":["80a6101cdc69cc6a5c3160cdd59db38e4c8976e5"],"comments":[],"createdAt":"2025-12-03T08:05:32.867Z","updatedAt":"2025-12-05T06:44:32.537Z","closedAt":"2025-12-05T06:44:32.537Z","closeReason":"Added rename-prefix CLI and tests"}
{"id":"oa-f12045","title":"Add tasks:repair-deps command","description":"Add repair-deps command to fix orphaned dependencies. Remove deps pointing to non-existent tasks. Report what was fixed.","status":"closed","priority":4,"type":"task","assignee":"codex","labels":["beads-port","cli","tier-3"],"deps":[],"commits":["a7a9057c690a3414b0d3709fcf1594b35ca37bac"],"comments":[],"createdAt":"2025-12-03T08:05:33.989Z","updatedAt":"2025-12-05T01:37:02.100Z","closedAt":"2025-12-05T01:37:02.100Z","closeReason":"Added repair-deps command and tests"}
{"id":"oa-a3d740","title":"Add git hooks system for task auto-sync","description":"Add tasks:hooks install/uninstall. Install post-merge, post-checkout, pre-commit hooks. Auto-import tasks after pulls, validate before commits.","status":"open","priority":4,"type":"task","labels":["beads-port","git","tier-4"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T08:05:35.117Z","updatedAt":"2025-12-03T08:05:35.117Z","closedAt":null}
{"id":"oa-9b81e6","title":"Add tasks:compact command for old tasks","description":"Add compact command to summarize old closed tasks. AI-supervised or manual compaction. Preserve history in git. Options: --analyze, --apply, --stats.","status":"open","priority":4,"type":"task","labels":["beads-port","cli","tier-4"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T08:05:36.329Z","updatedAt":"2025-12-03T08:05:36.329Z","closedAt":null}
{"id":"oa-1c366f","title":"Add deletion tombstones tracking","description":"Add deletions.jsonl to track deleted task IDs, timestamps, actors, reasons. Propagate deletions across clones. Enables restore functionality.","status":"open","priority":4,"type":"task","labels":["beads-port","schema","tier-4"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T08:05:38.157Z","updatedAt":"2025-12-03T08:05:38.157Z","closedAt":null}
{"id":"oa-293749","title":"Add tasks:restore command","description":"Add restore command to recover deleted tasks from git history. Requires deletion tombstones tracking. Git history fallback for self-healing.","status":"open","priority":4,"type":"task","labels":["beads-port","cli","tier-4"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T08:05:40.756Z","updatedAt":"2025-12-03T08:05:40.756Z","closedAt":null}
{"id":"oa-c8d45d","title":"Epic: Harden Golden Loop v2 resiliency & test coverage","description":"Track work to strengthen Golden Loop v2 with better failure handling, documentation clarity, and expanded tests (integration, browser, verification).","status":"closed","priority":1,"type":"epic","labels":["golden-loop","mechacoder","docs","testing","resilience"],"deps":[],"commits":["2d79ad9049b7a7992bb8ff5602253775aa528110"],"comments":[],"createdAt":"2025-12-03T08:47:09.160Z","updatedAt":"2025-12-03T08:58:03.657Z","closedAt":"2025-12-03T08:58:03.657Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-ee6e13","title":"Document Golden Loop failure recovery & dirty workspace handling","description":"Update docs/mechacoder/GOLDEN-LOOP-v2.md with concrete recovery playbooks: what happens when tests fail or agent crashes, how to detect and clean dirty working trees, and how to safely resume tasks without losing progress.","status":"closed","priority":1,"type":"task","labels":["golden-loop","docs","resilience"],"deps":[{"id":"oa-c8d45d","type":"parent-child"}],"commits":["c193d68bfd7c39b2ba046eb80faf7305fa29ca4f"],"comments":[],"createdAt":"2025-12-03T08:47:19.946Z","updatedAt":"2025-12-03T09:01:01.388Z","closedAt":"2025-12-03T09:01:01.388Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-a9eab1","title":"Document/pilot git conflict & push failure handling in Golden Loop","description":"Enhance GOLDEN-LOOP-v2.md with guidance for merge/rebase conflicts and rejected pushes, including safe backoff, follow-up task creation, and expectations for keeping working tree intact during retries.","status":"closed","priority":1,"type":"task","labels":["golden-loop","docs","git","resilience"],"deps":[{"id":"oa-c8d45d","type":"parent-child"}],"commits":["3022aae2740ba5569a946889502a62ecfc48a19a"],"comments":[],"createdAt":"2025-12-03T08:47:24.841Z","updatedAt":"2025-12-03T09:03:32.932Z","closedAt":"2025-12-03T09:03:32.932Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-87d2fc","title":"Clarify offline/network failure fallback & Claude Code resume paths","description":"Add GOLDEN-LOOP-v2 doc guidance for loss of network or Claude Code availability: when to fall back to minimal subagent, how to persist/resume sessions, and how to log/mark tasks as blocked when external services are unavailable.","status":"closed","priority":1,"type":"task","labels":["golden-loop","docs","resilience","claude-code"],"deps":[{"id":"oa-c8d45d","type":"parent-child"}],"commits":["4505ff0b8188284116e81d8332b02086e6c4dfb3"],"comments":[],"createdAt":"2025-12-03T08:47:29.236Z","updatedAt":"2025-12-03T09:05:57.345Z","closedAt":"2025-12-03T09:05:57.345Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-199210","title":"Document and test agent.lock enforcement for Golden Loop","description":"Add coverage and doc notes for .openagents/agent.lock: how lock is created/checked, how to recover stale locks, and how the loop should abort when a running PID is detected. Include test plan or harness to validate lock behavior.","status":"closed","priority":1,"type":"task","labels":["golden-loop","docs","resilience","testing"],"deps":[{"id":"oa-c8d45d","type":"parent-child"}],"commits":["6f4b8c6fd66a5b8fae319de7e5f59cb063c2dcb4"],"comments":[],"createdAt":"2025-12-03T08:47:34.020Z","updatedAt":"2025-12-03T09:15:52.845Z","closedAt":"2025-12-03T09:15:52.845Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-6e255e","title":"Add Golden Loop preflight checklist for init.sh & environment","description":"Document a repeatable preflight for GOLDEN-LOOP-v2: expected init.sh checks (bun test smoke, git clean, API keys present), guidance for failing fast when preflight fails, and where to log results for visibility.","status":"closed","priority":1,"type":"task","labels":["golden-loop","docs","ops","resilience"],"deps":[{"id":"oa-c8d45d","type":"parent-child"}],"commits":["aa71b0d2c22e85aeb255e6675b55322e33500073"],"comments":[],"createdAt":"2025-12-03T08:47:39.991Z","updatedAt":"2025-12-03T09:24:05.770Z","closedAt":"2025-12-03T09:24:05.770Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-29abf9","title":"Add verification phase tests for Golden Loop gating (typecheck/tests)","description":"Create integration tests ensuring orchestrator respects GOLDEN-LOOP-v2 rules: run typecheck/testCommands, block commit/push when failing, and record failure in tasks/logs. Cover both Claude Code and minimal subagent paths.","status":"closed","priority":1,"type":"task","labels":["golden-loop","testing","verification"],"deps":[{"id":"oa-c8d45d","type":"parent-child"}],"commits":["3681ed607fd465646dbd2e2c3131cd8ee2c5e20d"],"comments":[],"createdAt":"2025-12-03T08:47:44.631Z","updatedAt":"2025-12-03T15:11:29.618Z","closedAt":"2025-12-03T15:11:29.618Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-afd49a","title":"Add Golden Loop negative-path e2e (failing tests leave task in-progress)","description":"Build a stub repo/test harness to run the orchestrator end-to-end with intentional failing tests, asserting no commit/push occurs, task remains in_progress or blocked with a clear reason, and logs capture the failure.","status":"closed","priority":1,"type":"task","labels":["golden-loop","testing","e2e","resilience"],"deps":[{"id":"oa-c8d45d","type":"parent-child"}],"commits":["f7a2b7ab18fa36aeaf8dbd419a4d0d63c0700f7f"],"comments":[],"createdAt":"2025-12-03T08:47:48.903Z","updatedAt":"2025-12-03T15:17:55.251Z","closedAt":"2025-12-03T15:17:55.251Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-46156a","title":"Add Electrobun/Playwright Golden Loop smoke for start/stop & log UI","description":"Create a browser/electron integration test that launches the desktop UI, starts a one-task Golden Loop run with a stub project, verifies live log/phase output appears, and confirms graceful stop/cleanup behavior.","status":"closed","priority":2,"type":"task","labels":["golden-loop","testing","e2e","browser","electrobun"],"deps":[{"id":"oa-c8d45d","type":"parent-child"}],"commits":["e2a09e4d4fe1fec81664065fc966f04c11c77a42"],"comments":[],"createdAt":"2025-12-03T08:47:54.002Z","updatedAt":"2025-12-03T16:12:51.057Z","closedAt":"2025-12-03T16:12:51.057Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-090e97","title":"Document HUD event mapping for Golden Loop phases and add tests","description":"Expand docs to show how orchestrator events map to HUD messages, including phase transitions, tool calls, and log streaming. Add a small test harness/fixture to assert HUD receives expected messages during a sample loop.","status":"closed","priority":2,"type":"task","labels":["golden-loop","docs","hud","testing"],"deps":[{"id":"oa-c8d45d","type":"parent-child"}],"commits":["1ea13263b9a1386b144be70441968702ca20d8e0"],"comments":[],"createdAt":"2025-12-03T08:47:58.654Z","updatedAt":"2025-12-03T17:18:06.592Z","closedAt":"2025-12-03T17:18:06.592Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-7a5884","title":"Document log retention/rotation and add Golden Loop log creation test","description":"Document expectations for docs/logs rotation (naming, size, cleanup) and add a test ensuring each loop writes a run log with task/tests/commit info to the correct date folder.","status":"closed","priority":2,"type":"task","assignee":"codex","labels":["golden-loop","docs","logging","testing"],"deps":[{"id":"oa-c8d45d","type":"parent-child"}],"commits":["34f0899d2064c94f84b99bff96da8b855e88fce6"],"comments":[],"createdAt":"2025-12-03T08:48:03.718Z","updatedAt":"2025-12-04T11:09:55.008Z","closedAt":"2025-12-04T11:09:55.008Z","closeReason":"Document log rotation and add log content test"}
{"id":"oa-5cf94a","title":"Document stuck-task detection & tasks:doctor usage in Golden Loop","description":"Add guidance for detecting stale in_progress tasks, how the loop should surface them, and when to run tasks:doctor/validate as part of startup. Include a small test or fixture demonstrating detection of stale tasks and expected remediation.","status":"closed","priority":2,"type":"task","labels":["golden-loop","docs","ops","testing"],"deps":[{"id":"oa-c8d45d","type":"parent-child"}],"commits":["f92a29058a523146c9e7023e0e8b7ff2abfac978","2a86db06466a27576be3d69b2a5bd0eea823b826","2d74b4fbd0c595a96f7397fc5e6c9cd9d18af89e"],"comments":[],"createdAt":"2025-12-03T08:48:08.695Z","updatedAt":"2025-12-04T11:19:40.002Z","closedAt":"2025-12-04T11:19:40.002Z","closeReason":"Add stuck-task guidance and stale detection coverage"}
{"id":"oa-fb359d","title":"Create Golden Loop regression fixture & test matrix (CLI + desktop)","description":"Build a reusable stub repo/fixtures and matrix covering CLI do-one-task, overnight loop, and desktop UI harness. Document how to run locally/CI and ensure Golden Loop v2 acceptance criteria remain covered as features evolve.","status":"closed","priority":2,"type":"task","labels":["golden-loop","testing","e2e","docs"],"deps":[{"id":"oa-c8d45d","type":"parent-child"}],"commits":["f2d97cca4e9d52a863705d826e7e12481704a736","815b3a05d332613670b436bc1ce232d15d67f436","72e08e1e191d557fd97b0148af3c7eeebd7c9f22"],"comments":[],"createdAt":"2025-12-03T08:48:13.778Z","updatedAt":"2025-12-04T11:29:08.140Z","closedAt":"2025-12-04T11:29:08.140Z","closeReason":"Add Golden Loop regression fixture and matrix"}
{"id":"oa-a4ed60","title":"Epic: Complete pi-mono parity (non-TUI)","description":"Track remaining pi-mono features to port into MechaCoder/OpenAgents (excluding TUI). Focus on automation-safe parity: tools-manager auto-install, context compaction, session import/export, model registry generation, retry/backoff parity, log/traces parity.","status":"closed","priority":1,"type":"epic","labels":["pi-port","pi-mono","mechacoder"],"deps":[],"commits":["11006a32b1e57894b7bf5065b86f320cda904f0b"],"comments":[],"createdAt":"2025-12-03T08:55:14.654Z","updatedAt":"2025-12-03T15:22:01.217Z","closedAt":"2025-12-03T15:22:01.217Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-daba8b","title":"Port pi-mono tools-manager auto-install for rg/fd in headless runs","description":"Bring over pi-mono's tools-manager to download/verify rg and fd when missing (platform-specific binaries, checksum, chmod). Expose Effect APIs so MechaCoder can ensure deps before starting, and document fallback when download fails. No TUI surfaces.","status":"closed","priority":1,"type":"task","labels":["pi-port","pi-mono","tools","infra"],"deps":[{"id":"oa-a4ed60","type":"parent-child"}],"commits":["39ea15ba4c9b507e82d901c39d25ce91ab259abd"],"comments":[],"createdAt":"2025-12-03T08:55:24.890Z","updatedAt":"2025-12-03T15:20:22.350Z","closedAt":"2025-12-03T15:20:22.350Z","closeReason":"Already implemented in src/tools/tools-manager.ts with Effect-based auto-download for rg/fd"}
{"id":"oa-fb59bb","title":"Add pi-mono context compaction/backpressure for long sessions","description":"Port pi-mono's context compaction/backpressure to MechaCoder session manager so long-running runs trim history intelligently (keep tools/prompts relevant, drop noise) and avoid provider token overruns. Include tests/fixtures mirroring pi-mono behavior.","status":"closed","priority":1,"type":"task","labels":["pi-port","pi-mono","context","reliability"],"deps":[{"id":"oa-a4ed60","type":"parent-child"}],"commits":["846f99452d730a6aa4e41013852a59b79d56e9cc"],"comments":[],"createdAt":"2025-12-03T08:55:29.910Z","updatedAt":"2025-12-03T15:31:13.168Z","closedAt":"2025-12-03T15:31:13.168Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-e4dbfc","title":"Bridge pi-mono session JSONL import/export for run logs","description":"Add compatibility layer to import/export pi-mono JSONL session/run logs so MechaCoder can replay or analyze prior runs. Include schema mapping, validation, and tests covering roundtrips; no TUI export, just file-level tools.","status":"closed","priority":2,"type":"task","labels":["pi-port","pi-mono","logging","sessions"],"deps":[{"id":"oa-a4ed60","type":"parent-child"}],"commits":["e792211674d4dccb6013f3f0e152bfd0fc18d3b8","a337d26ab99add0955d6db48d4b3b7494bacbba5"],"comments":[],"createdAt":"2025-12-03T08:55:34.991Z","updatedAt":"2025-12-04T11:36:58.044Z","closedAt":"2025-12-04T11:36:58.044Z","closeReason":"Add pi-mono session JSONL import/export bridge"}
{"id":"oa-9f0ac0","title":"Port pi-mono models registry generator (models.dev/OpenRouter) to OpenAgents","description":"Recreate pi-mono's model registry generation pipeline (models.dev/OpenRouter metadata → JSON) for MechaCoder, keeping Effect-friendly types and tests. Document how to refresh/pin models without TUI.","status":"closed","priority":2,"type":"task","labels":["pi-port","pi-mono","models","infra"],"deps":[{"id":"oa-a4ed60","type":"parent-child"}],"commits":["39ea15ba4c9b507e82d901c39d25ce91ab259abd"],"comments":[],"createdAt":"2025-12-03T08:55:39.913Z","updatedAt":"2025-12-03T15:20:23.937Z","closedAt":"2025-12-03T15:20:23.937Z","closeReason":"Already implemented in scripts/generate-models.ts with models.dev and OpenRouter integration"}
{"id":"oa-e3ad31","title":"Align provider retry/backoff with pi-mono defaults","description":"Audit provider error handling vs pi-mono and add standardized retry/backoff for rate limits/auth/server errors across OpenRouter/Anthropic/OpenAI/Gemini. Include config knobs and tests; keep automation-safe defaults.","status":"closed","priority":2,"type":"task","labels":["pi-port","pi-mono","reliability","providers"],"deps":[{"id":"oa-a4ed60","type":"parent-child"}],"commits":["d54bc15055cba51f20f8d8a20bd1b0683a37d75c","60aedd25ee2890780cecc64b974c09bdde55b1d6","fc691a73015a180b15a865e8057e40922fa1dfd6"],"comments":[],"createdAt":"2025-12-03T08:55:44.613Z","updatedAt":"2025-12-04T11:47:32.245Z","closedAt":"2025-12-04T11:47:32.245Z","closeReason":"Standardize provider retry/backoff to pi-mono defaults"}
{"id":"oa-60d305","title":"Port pi-mono log trimming/rotation for long agent runs","description":"Add pi-mono-style log trimming/rotation to prevent oversized run logs and transcript files during long MechaCoder sessions. Define limits, pruning rules, and tests to ensure critical events are retained while noise is dropped. No TUI work.","status":"closed","priority":2,"type":"task","labels":["pi-port","pi-mono","logging","reliability"],"deps":[{"id":"oa-a4ed60","type":"parent-child"}],"commits":["390f777da086940056ddc184fb1e7677d88a8635","d87805559761c1d0302c32e91da406e2fe52c8fa"],"comments":[],"createdAt":"2025-12-03T08:55:49.401Z","updatedAt":"2025-12-04T12:03:43.951Z","closedAt":"2025-12-04T12:03:43.951Z","closeReason":"Implemented log trimming for long runs"}
{"id":"oa-5f16d2","title":"Expose non-TUI status stream compatible with pi-mono RPC mode","description":"Provide a headless status/event stream (e.g., WebSocket/JSONL) mirroring pi-mono's RPC status updates so external supervisors can monitor MechaCoder without TUI. Include schema, auth, and a small integration test harness.","status":"closed","priority":2,"type":"task","labels":["pi-port","pi-mono","hud","infra"],"deps":[{"id":"oa-a4ed60","type":"parent-child"}],"commits":["e4fc795f023ebfd8e353480395c07614723df6ce","d2f7a0d5df73119aeacff636cbf5c726df5bd05d"],"comments":[],"createdAt":"2025-12-03T08:55:54.332Z","updatedAt":"2025-12-04T12:13:31.916Z","closedAt":"2025-12-04T12:13:31.916Z","closeReason":"Added headless status stream"}
{"id":"oa-a33e8e","title":"Epic: Maintenance hardening for MechaCoder repo","description":"Consolidate refactors and guardrails to keep MechaCoder/OpenAgents healthy: dependency auditing, stress harness, lint/format enforcement, task file integrity checks, and build health visibility.","status":"closed","priority":2,"type":"epic","labels":["maintenance","infra","testing"],"deps":[],"commits":["ea8374d21f2c24ebe4a43bec487faf2c9561a184","0f7325dd9f01a0ceae987e9b5dea4974a5dfd64f"],"comments":[],"createdAt":"2025-12-03T08:57:44.363Z","updatedAt":"2025-12-04T12:17:53.890Z","closedAt":"2025-12-04T12:17:53.890Z","closeReason":"Added repo health check CLI"}
{"id":"oa-f2c223","title":"Add automated dependency audit & update workflow","description":"Set up a recurring script/CI job to run dependency vulnerability/audit checks and produce a weekly diff (lockfile + summary). Include a safe update workflow for Bun deps and docs on how to apply/roll back. Keep it automation-friendly (no interactive prompts).","status":"closed","priority":2,"type":"task","labels":["maintenance","deps","ci"],"deps":[{"id":"oa-a33e8e","type":"parent-child"}],"commits":["0f7325dd9f01a0ceae987e9b5dea4974a5dfd64f","970424723254d58a4d4949116d4ae1b4f2835d30"],"comments":[],"createdAt":"2025-12-03T08:57:50.148Z","updatedAt":"2025-12-04T12:21:34.181Z","closedAt":"2025-12-04T12:21:34.181Z","closeReason":"Added automated dependency audit workflow"}
{"id":"oa-f2c223","title":"Add automated dependency audit & update workflow","description":"Set up a recurring script/CI job to run dependency vulnerability/audit checks and produce a weekly diff (lockfile + summary). Include a safe update workflow for Bun deps and docs on how to apply/roll back. Keep it automation-friendly (no interactive prompts).","status":"in_progress","priority":2,"type":"task","labels":["maintenance","deps","ci"],"deps":[{"id":"oa-a33e8e","type":"parent-child"}],"commits":[],"comments":[],"createdAt":"2025-12-03T08:57:50.148Z","updatedAt":"2025-12-04T12:19:27.962Z","closedAt":null}
{"id":"oa-f645d7","title":"Build orchestrator stress/chaos harness for reliability regressions","description":"Create a stress harness that runs orchestrator loops repeatedly against a stub repo with injected failures (git dirty, missing env, flaky tests) to surface race/cleanup bugs. Add assertions/metrics and wire into CI/nightly to catch regressions early.","status":"closed","priority":2,"type":"task","labels":["maintenance","testing","reliability","orchestrator"],"deps":[{"id":"oa-a33e8e","type":"parent-child"}],"commits":["ed0c91c4f6f8bfe979d173e54df0c1f0bbe03ecf"],"comments":[],"createdAt":"2025-12-03T08:57:55.112Z","updatedAt":"2025-12-04T12:45:50.503Z","closedAt":"2025-12-04T12:45:50.503Z","closeReason":"Added orchestrator stress/chaos harness"}
{"id":"oa-101a29","title":"Enforce lint/format baseline for agent code (Effect-friendly)","description":"Adopt a repo-wide lint/format baseline (e.g., Biome/ESLint) tuned for Effect patterns and exactOptionalPropertyTypes. Add CI and fixer scripts, and document rules that replace ad-hoc linting. Ensure minimal friction for automation.","status":"closed","priority":2,"type":"task","labels":["maintenance","lint","ci","dx"],"deps":[{"id":"oa-a33e8e","type":"parent-child"}],"commits":["959b91a2ec0061a1715fa0548c7204bcbb265be7"],"comments":[],"createdAt":"2025-12-03T08:58:00.030Z","updatedAt":"2025-12-04T13:02:12.004Z","closedAt":"2025-12-04T13:02:12.004Z","closeReason":"Added Biome lint baseline, scripts, and docs"}
{"id":"oa-f5cbad","title":"Add guardrails for .openagents/tasks.jsonl integrity (skip-worktree, schema)","description":"Add a preflight/CI check that flags .openagents/tasks.jsonl being skip-worktree or schema-invalid before agent runs. Include a fixer/diagnostic script and docs so agents/users don’t silently miss task updates.","status":"closed","priority":2,"type":"task","labels":["maintenance","tasks","ci","ops"],"deps":[{"id":"oa-a33e8e","type":"parent-child"}],"commits":["01f3cb09c3ddf161cff00912853e2323923e62bb","30e1631cec72f625767adbab16c125d352ba4252"],"comments":[],"createdAt":"2025-12-03T08:58:05.010Z","updatedAt":"2025-12-04T13:13:05.695Z","closedAt":"2025-12-04T13:10:57.643Z","closeReason":"Added tasks.jsonl integrity guard and checker"}
{"id":"oa-b89d79","title":"Publish build health & coverage snapshot in docs","description":"Add a lightweight build health page (docs/ or README badge) summarizing latest test/typecheck results and coverage for critical agent modules. Automate updates via CI so maintainers see drift/regressions without digging into logs.","status":"open","priority":3,"type":"task","labels":["maintenance","docs","ci"],"deps":[{"id":"oa-a33e8e","type":"parent-child"}],"commits":[],"comments":[],"createdAt":"2025-12-03T08:58:09.911Z","updatedAt":"2025-12-03T08:58:09.911Z","closedAt":null}
{"id":"oa-safe01","title":"Add safe mode with self-healing for init script failures","description":"When init script fails (especially typecheck), try to self-heal before giving up.\n\n## Problem\nInit script typecheck failure → session aborts → retry 3x → same failure → give up.\nNo attempt to fix the issue automatically.\n\n## Solution Design\n1. Add `--safe-mode` flag to overnight agent\n2. In safe mode, when init script fails with typecheck error:\n   - Parse the init script output to detect typecheck failure\n   - Spawn a Claude Code emergency subtask: 'Fix all typecheck errors'\n   - Re-run init script to verify fix\n   - Continue if passes, abort if still fails\n3. For other failures (network, disk space), use degraded mode with warnings\n\n## Implementation\n- overnight.ts: Add --safe-mode flag and recovery logic\n- init-script.ts: Return structured error info (typecheck_failed, network_down, etc.)\n- orchestrator.ts: Handle recovery subtask before normal task selection\n\n## Test Cases\n- Init fails with typecheck → agent fixes it → continues\n- Init fails with network → warns and continues (if offlineMode allows)\n- Init fails with unknown error → abort after 3 tries (existing behavior)","status":"closed","priority":1,"type":"feature","labels":["resilience","safe-mode","self-healing"],"deps":[],"commits":["6a7ac14739921b17fe60782bbb811367b3764cb9"],"comments":[],"createdAt":"2025-12-03T16:00:00.000Z","updatedAt":"2025-12-03T16:25:11.246Z","closedAt":"2025-12-03T16:25:11.246Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-c78736","title":"Load AGENTS.md/CLAUDE.md context in overnight agent","description":"","status":"closed","priority":1,"type":"feature","labels":["mechacoder","context","overnight"],"deps":[],"commits":["926a500fc6632b920ec5813d94f7400ce7ee3665"],"comments":[],"createdAt":"2025-12-03T16:17:43.391Z","updatedAt":"2025-12-03T16:24:53.109Z","closedAt":"2025-12-03T16:24:53.109Z","closeReason":"Added --load-context flag to overnight agent. Context files (AGENTS.md/CLAUDE.md) are loaded from working directory and prepended to Claude Code prompts."}
{"id":"oa-a74c13","title":"Track and visualize agent usage metrics (tokens, cost)","description":"Track and visualize usage metrics from AI agents (Claude Code, OpenAI Codex, etc.) for cost monitoring and decision-making.\n\n## Current State\n\nClaude Code SDK already reports per-session:\n- Token usage: input_tokens, output_tokens, cache_read_input_tokens, cache_creation_input_tokens\n- Cost: total_cost_usd\n- Per-model breakdown via modelUsage dictionary\n\nOpenAgents already captures this in:\n- SubagentResult.sessionMetadata.usage and .totalCostUsd\n- SessionProgress written to progress.md (human-readable format)\n\n## What's Missing\n\n1. **Historical Storage**: Aggregate usage across sessions/days in a queryable format (e.g., .openagents/usage.jsonl or SQLite)\n\n2. **Session-Level Aggregation**: Sum all subtask usage within an orchestrator session\n\n3. **HUD Visualization**: Display usage metrics in the Electrobun HUD:\n   - Current session usage (tokens, cost)\n   - Daily/weekly usage trends\n   - Per-project breakdown\n\n4. **Reporting CLI**: `bun run usage:summary` to show usage by day/week/month\n\n## Suggested Schema\n\n```typescript\ninterface UsageRecord {\n  sessionId: string;\n  projectId: string;\n  timestamp: string;\n  inputTokens: number;\n  outputTokens: number;\n  cacheReadTokens: number;\n  cacheCreationTokens: number;\n  totalCostUsd: number;\n  agent: 'claude-code' | 'grok' | 'openai';\n  subtasks: number;\n  durationMs: number;\n}\n```\n\n## Implementation Steps\n\n1. Create src/usage/types.ts with UsageRecord schema\n2. Create src/usage/store.ts to append/query usage records\n3. Update orchestrator to write usage record at session end\n4. Add HUD message type for usage updates\n5. Add usage panel to Electrobun HUD\n6. Add usage:summary CLI command\n\n## Future: Decision Making\n\nOnce tracking is in place, can add:\n- Budget alerts (daily/weekly cost limits)\n- Automatic model downgrade when approaching limits\n- Usage-based task prioritization","status":"closed","priority":2,"type":"feature","labels":["hud","usage","analytics","claude-code"],"deps":[],"commits":["8f0ce18fbbaf2748bcc832ae22080ed5d0f5a0f6"],"comments":[],"createdAt":"2025-12-03T16:52:14.885Z","updatedAt":"2025-12-04T14:45:46.168Z","closedAt":"2025-12-04T14:45:46.168Z","closeReason":"Implemented usage tracking and HUD reporting"}
{"id":"oa-2f3ed6","title":"Orchestrator cleanup commit should not include failed work","description":"## Bug Description\n\nThe orchestrator's final cleanup commit does `git add -A` which commits ALL files, not just progress files. This bypasses the per-task commit guardrail.\n\n## What Happened\n\n1. Claude Code wrote files with TypeScript errors (emit.test.ts missing required Task fields)\n2. Orchestrator verification correctly failed and marked subtask as FAILED\n3. Per-task commit was correctly skipped (\"no meaningful work done\")\n4. **BUG**: Final cleanup commit did `git add -A && git commit` - pushing broken code!\n5. Subsequent runs failed at init script because broken code is now on disk AND committed\n\n## Root Cause\n\n```javascript\n// In overnight.ts - cleanup at end of loop\nexecSync(\"git add -A\", { cwd: config.workDir });\nexecSync(`git commit -m \"chore: update progress files and logs...\"`, ...);\n```\n\nThis adds ALL files, not just progress files.\n\n## Solutions\n\n### Option A: Selective add\nOnly add specific paths:\n```javascript\nexecSync(\"git add .openagents/progress.md docs/logs/\", { cwd });\n```\n\n### Option B: Revert on failure\nAfter a failed subtask, run `git checkout -- .` to discard uncommitted changes.\n\n### Option C: Run typecheck before cleanup commit\nBefore committing, run typecheck. If it fails, skip the commit.\n\n## Recommended\n\nOption B (revert on failure) is cleanest - failed work should never persist.","status":"closed","priority":0,"type":"bug","labels":["orchestrator","overnight","critical"],"deps":[],"commits":["96f1b8760f07cee5b7198557624eb31e419e6eae","217144506d5111b8f8aa083cfbfa150225eacc43"],"comments":[],"createdAt":"2025-12-03T16:56:26.678Z","updatedAt":"2025-12-03T17:05:03.507Z","closedAt":"2025-12-03T17:05:03.507Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-2fe6c8","title":"Full session tracking for replayability (like Claude ~/.claude/)","description":"## Problem\n\nWhen investigating overnight agent runs, the user has to manually paste logs to ask about what happened. We should be tracking ALL conversation data for FULL replayability.\n\n## Reference: Claude Code's Session Storage\n\nClaude Code stores sessions at `~/.claude/projects/<project-path>/<session-id>.jsonl`:\n- Each line is a complete JSON object with: type, message, uuid, parentUuid, timestamp, sessionId\n- Messages include full content (text + tool_use with ALL params)\n- Usage metrics with token counts and cache info\n- Parent UUIDs for threading/conversation structure\n\n## Current State\n\nOpenAgents has `.openagents/sessions/` with basic session tracking, but it doesn't capture:\n- Full tool call inputs\n- Full tool results (truncated currently)\n- Usage/cost metrics per message\n- Parent-child message linking for conversation structure\n- Session summary/metadata\n\n## Requirements\n\n1. **Session Storage Format**: Store sessions like Claude does:\n   - Per-project: `.openagents/sessions/<session-id>.jsonl`\n   - Each line: `{ type, message, uuid, parentUuid, timestamp, sessionId, usage }`\n   - Include FULL tool inputs (not truncated)\n   - Include tool results (configurable truncation)\n\n2. **Session Metadata**: Track:\n   - Task ID being worked on\n   - Start/end times\n   - Total turns, tokens, cost\n   - Outcome (success/failure/blocked)\n\n3. **Session Viewer CLI**:\n   - `bun run session:show <id>` - Pretty-print session\n   - `bun run session:replay <id>` - Step through with timing\n   - `bun run session:diff <id1> <id2>` - Compare sessions\n\n4. **Session Query**:\n   - `bun run session:list` - List recent sessions\n   - `bun run session:search <term>` - Search in sessions\n   - `bun run session:by-task <task-id>` - Find sessions for task\n\n## Implementation Notes\n\n- Use JSONL format for append-only writes during streaming\n- Keep sessions separate from tasks (sessions are transient, tasks are durable)\n- Consider compression for old sessions","status":"closed","priority":1,"type":"feature","labels":["overnight","observability","sessions"],"deps":[],"commits":["18a591cda00302b6a5777cf4142a28ba06eada48"],"comments":[],"createdAt":"2025-12-03T16:59:50.863Z","updatedAt":"2025-12-03T17:12:47.871Z","closedAt":"2025-12-03T17:12:47.871Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-e8fd78","title":"Log full tool call params in streaming output","description":"## Problem\n\nConsole output shows truncated tool calls:\n\\`\\`\\`\n[TOOL_USE] {\"tool\":\"TodoWrite\",\"id\":\"toolu_01BBkGhFbb5YhuMVww129SA5\"}\n\\`\\`\\`\n\nBut we need ALL params to debug agent behavior.\n\n## Current Code\n\nIn \\`src/agent/orchestrator/claude-code-subagent.ts\\`:\n\n\\`\\`\\`javascript\n// Line 326-327: At content_block_start (no input yet)\nconst toolJson = JSON.stringify({ tool: block.name, id: block.id }, null, 0);\noptions.onOutput(\\`\\\\n[TOOL_USE] \\${toolJson}\\\\n\\`);\n\n// Line 354-355: From complete message (has input)\nconst toolJson = JSON.stringify({ tool: block.name, id: block.id, input: block.input }, null, 0);\noptions.onOutput(\\`\\\\n[TOOL_USE] \\${toolJson}\\\\n\\`);\n\\`\\`\\`\n\nThe streaming version (line 326) doesn't have input yet because input arrives in \\`input_json_delta\\` chunks.\n\n## Fix Options\n\n1. **Buffer and log on block_stop**: \n   - Store tool_use info at content_block_start\n   - Accumulate input_json_delta chunks\n   - Log full tool_use at content_block_stop\n\n2. **Only use non-streaming path**:\n   - Skip the content_block_start log (line 327)\n   - Rely on the complete message path (line 354) which has all params\n   - Con: Logs appear later in the stream\n\n3. **Hybrid**:\n   - Log at content_block_start with just tool/id (fast feedback)\n   - Log again at block_stop with full params (for debugging)\n\n## Recommended\n\nOption 1 (buffer and log on block_stop) provides the best UX:\n- Shows tool usage at the right time in stream\n- Includes full params for debugging","status":"closed","priority":2,"type":"task","labels":["overnight","observability","streaming"],"deps":[],"commits":["f184b23461791c8f3a8cb4a624d39286c839567f","46743162fbf2732b79cfafc564faf7873480f75a"],"comments":[],"createdAt":"2025-12-03T17:00:10.888Z","updatedAt":"2025-12-04T13:20:25.940Z","closedAt":"2025-12-04T13:20:07.736Z","closeReason":"Buffered tool-use logs now include full params"}
{"id":"oa-3ceacd","title":"Container sandbox abstraction for MechaCoder","description":"","status":"closed","priority":1,"type":"epic","labels":["sandbox","containers","macos"],"deps":[],"commits":["d93d5215075ca477d5a8ea0c7a100c37522d1c62"],"comments":[],"createdAt":"2025-12-03T17:20:09.565Z","updatedAt":"2025-12-03T17:28:28.206Z","closedAt":"2025-12-03T17:28:28.206Z","closeReason":"Container sandbox abstraction layer complete - all 8 subtasks done"}
{"id":"oa-4bbd2d","title":"Create src/sandbox/schema.ts - ContainerConfig schema and ContainerError types","description":"","status":"closed","priority":1,"type":"task","labels":["sandbox"],"deps":[],"commits":["470e93cd2af75fb86aecc5024c9fe20b82123072"],"comments":[],"createdAt":"2025-12-03T17:20:21.871Z","updatedAt":"2025-12-03T17:21:20.305Z","closedAt":"2025-12-03T17:21:20.305Z","closeReason":"Created ContainerConfig schema and ContainerError types"}
{"id":"oa-b38b53","title":"Create src/sandbox/backend.ts - ContainerBackend Context.Tag interface","description":"","status":"closed","priority":1,"type":"task","labels":["sandbox"],"deps":[],"commits":["470e93cd2af75fb86aecc5024c9fe20b82123072"],"comments":[],"createdAt":"2025-12-03T17:20:24.023Z","updatedAt":"2025-12-03T17:21:36.619Z","closedAt":"2025-12-03T17:21:36.619Z","closeReason":"Created ContainerBackend interface and Context.Tag"}
{"id":"oa-0da36a","title":"Create src/sandbox/macos-container.ts - Apple Container CLI implementation","description":"","status":"closed","priority":1,"type":"task","labels":["sandbox","macos"],"deps":[],"commits":["470e93cd2af75fb86aecc5024c9fe20b82123072"],"comments":[],"createdAt":"2025-12-03T17:20:24.878Z","updatedAt":"2025-12-03T17:22:18.415Z","closedAt":"2025-12-03T17:22:18.415Z","closeReason":"Implemented Apple Container CLI backend with run and build methods"}
{"id":"oa-b7117d","title":"Create src/sandbox/detect.ts - Auto-detection of available backends","description":"","status":"closed","priority":1,"type":"task","labels":["sandbox"],"deps":[],"commits":["470e93cd2af75fb86aecc5024c9fe20b82123072"],"comments":[],"createdAt":"2025-12-03T17:20:26.058Z","updatedAt":"2025-12-03T17:22:36.003Z","closedAt":"2025-12-03T17:22:36.003Z","closeReason":"Created auto-detection with noopBackend fallback"}
{"id":"oa-1e899a","title":"Create src/sandbox/index.ts - Public API exports","description":"","status":"closed","priority":1,"type":"task","labels":["sandbox"],"deps":[],"commits":["470e93cd2af75fb86aecc5024c9fe20b82123072"],"comments":[],"createdAt":"2025-12-03T17:20:27.191Z","updatedAt":"2025-12-03T17:22:56.353Z","closedAt":"2025-12-03T17:22:56.353Z","closeReason":"Created public API with runInContainer, buildImage, isContainerAvailable"}
{"id":"oa-8a902b","title":"Create src/sandbox/macos-container.test.ts - Tests for macOS Container backend","description":"","status":"closed","priority":1,"type":"task","labels":["sandbox","testing"],"deps":[],"commits":["d93d5215075ca477d5a8ea0c7a100c37522d1c62"],"comments":[],"createdAt":"2025-12-03T17:20:28.121Z","updatedAt":"2025-12-03T17:26:22.467Z","closedAt":"2025-12-03T17:26:22.467Z","closeReason":"Tests pass - macOSContainerLive uses BunContext.layer"}
{"id":"oa-c0ce1d","title":"Update ProjectConfig schema with sandbox config","description":"","status":"closed","priority":2,"type":"task","labels":["sandbox"],"deps":[],"commits":["d93d5215075ca477d5a8ea0c7a100c37522d1c62"],"comments":[],"createdAt":"2025-12-03T17:20:29.471Z","updatedAt":"2025-12-03T17:27:46.944Z","closedAt":"2025-12-03T17:27:46.944Z","closeReason":"Added SandboxConfig schema to ProjectConfig"}
{"id":"oa-b0f202","title":"Update docs/claude/plans/containers.md with implementation status","description":"","status":"closed","priority":3,"type":"task","labels":["docs","sandbox"],"deps":[],"commits":["d93d5215075ca477d5a8ea0c7a100c37522d1c62"],"comments":[],"createdAt":"2025-12-03T17:20:30.612Z","updatedAt":"2025-12-03T17:28:23.122Z","closedAt":"2025-12-03T17:28:23.122Z","closeReason":"Added implementation status section to containers.md"}
{"id":"oa-704490","title":"Handle sandbox typecheck failures blocking agent runs","description":"`bun run typecheck` currently fails in src/sandbox/macos-container.ts (unused ContainerConfig import, missing Effect context, and ContainerRunResult mismatch), which causes .openagents/init.sh preflight and orchestrator verification to abort tasks. This broke oa-7a5884 when sandbox work was in-progress. Potential fixes: (1) fix macOS backend types so run returns ContainerRunResult with unknown context and remove unused import; (2) temporarily exclude sandbox from typecheck/build while the backend is incomplete; (3) gate sandbox code behind a feature flag/optional build step; (4) make init.sh/verification warning-only or opt-out for sandbox typecheck failures when sandbox isn’t used.","status":"closed","priority":1,"type":"bug","labels":["sandbox","typecheck","agent"],"deps":[],"commits":["ba78d9fcd57d89d597a1a7c37e6db4aec6173b53"],"comments":[],"createdAt":"2025-12-03T17:27:13.025Z","updatedAt":"2025-12-03T19:56:40.741Z","closedAt":"2025-12-03T19:56:40.741Z","closeReason":"Added skipInitScript flag to orchestrator - worktree runs skip typecheck since main repo is validated at start"}
{"id":"oa-596f47","title":"Add container bootstrap CLI for downloading/installing container runtime","description":"","status":"closed","priority":1,"type":"feature","labels":["sandbox","cli"],"deps":[],"commits":["2a435eca4d63ac5c626ceebc3d096d442b97e71f"],"comments":[],"createdAt":"2025-12-03T17:36:05.794Z","updatedAt":"2025-12-03T17:36:13.228Z","closedAt":"2025-12-03T17:36:13.228Z","closeReason":"Implemented bootstrap.ts and cli.ts - tested with real containers"}
{"id":"oa-0f4cca","title":"Create worktree.ts - Core worktree management","description":"","status":"closed","priority":1,"type":"task","labels":["parallel","worktree"],"deps":[],"commits":["36dbec33a6ea91b7c2f3a67e16d8913a33d6574f"],"comments":[],"createdAt":"2025-12-03T17:47:38.317Z","updatedAt":"2025-12-03T17:50:31.109Z","closedAt":"2025-12-03T17:50:31.109Z","closeReason":"Created worktree.ts with Effect-based git worktree management"}
{"id":"oa-d8e76f","title":"Create worktree.test.ts - Worktree tests","description":"","status":"closed","priority":1,"type":"task","labels":["parallel","worktree","test"],"deps":[],"commits":["36dbec33a6ea91b7c2f3a67e16d8913a33d6574f"],"comments":[],"createdAt":"2025-12-03T17:47:39.248Z","updatedAt":"2025-12-03T17:50:31.963Z","closedAt":"2025-12-03T17:50:31.963Z","closeReason":"Created worktree.test.ts - 10 tests passing"}
{"id":"oa-8b68cb","title":"Modify agent-lock.ts for per-worktree locking","description":"","status":"closed","priority":1,"type":"task","labels":["parallel","worktree"],"deps":[],"commits":["36dbec33a6ea91b7c2f3a67e16d8913a33d6574f"],"comments":[],"createdAt":"2025-12-03T17:47:40.266Z","updatedAt":"2025-12-03T17:52:19.577Z","closedAt":"2025-12-03T17:52:19.577Z","closeReason":"Added per-worktree locking: acquireWorktreeLock, releaseWorktreeLock, listWorktreeLocks, pruneWorktreeLocks, createWorktreeLockGuard. 47 tests passing."}
{"id":"oa-9ccb21","title":"Create parallel-runner.ts - N-agent coordination","description":"","status":"closed","priority":1,"type":"task","labels":["parallel","worktree"],"deps":[],"commits":["36dbec33a6ea91b7c2f3a67e16d8913a33d6574f"],"comments":[],"createdAt":"2025-12-03T17:47:41.761Z","updatedAt":"2025-12-03T17:53:51.088Z","closedAt":"2025-12-03T17:53:51.088Z","closeReason":"Created parallel-runner.ts with N-agent coordination, merge strategy selection, worktree lifecycle, and placeholder agent execution"}
{"id":"oa-c81f21","title":"Add ParallelExecutionConfig to schema.ts","description":"","status":"closed","priority":1,"type":"task","labels":["parallel","schema"],"deps":[],"commits":["36dbec33a6ea91b7c2f3a67e16d8913a33d6574f"],"comments":[],"createdAt":"2025-12-03T17:47:43.816Z","updatedAt":"2025-12-03T17:54:53.642Z","closedAt":"2025-12-03T17:54:53.642Z","closeReason":"Added ParallelExecutionConfig and MergeStrategy schemas with all options: enabled, maxAgents, worktreeTimeout, useContainers, mergeStrategy, mergeThreshold, prThreshold"}
{"id":"oa-cfcdd4","title":"Add CLI commands for worktrees","description":"","status":"closed","priority":1,"type":"task","labels":["parallel","cli"],"deps":[],"commits":["36dbec33a6ea91b7c2f3a67e16d8913a33d6574f"],"comments":[],"createdAt":"2025-12-03T17:47:44.835Z","updatedAt":"2025-12-03T17:56:03.556Z","closedAt":"2025-12-03T17:56:03.556Z","closeReason":"Created orchestrator CLI with worktrees list/prune and locks list/prune commands"}
{"id":"oa-b022d5","title":"Add .worktrees to .gitignore","description":"","status":"closed","priority":1,"type":"chore","labels":["worktree","test"],"deps":[],"commits":["7ecb4274b036c0de4fdd72c099b6bc8caab1425c"],"comments":[],"createdAt":"2025-12-03T17:59:45.513Z","updatedAt":"2025-12-03T19:56:39.501Z","closedAt":"2025-12-03T19:56:39.501Z","closeReason":"Added .worktrees to .gitignore"}
{"id":"oa-ec348d","title":"Implement APM measurement system for MechaCoder","description":"","status":"closed","priority":1,"type":"feature","labels":["apm","metrics","golden-loop"],"deps":[],"commits":["f7800338b288c6d300702474fcb54947772f78e0"],"comments":[],"createdAt":"2025-12-03T18:35:10.129Z","updatedAt":"2025-12-03T18:40:52.398Z","closedAt":"2025-12-03T18:40:52.398Z","closeReason":"APM measurement system implemented - MechaCoder is 4.22x more efficient than direct Claude Code usage"}
{"id":"oa-4cbc15","title":"Create src/agent/apm.ts - Core APM types and collector","description":"","status":"closed","priority":1,"type":"task","labels":["apm"],"deps":[],"commits":["7e020cf4e8459109bb0d59bcb44537fa7f8bcc6c"],"comments":[],"createdAt":"2025-12-03T18:35:21.516Z","updatedAt":"2025-12-03T18:40:17.823Z","closedAt":"2025-12-03T18:40:17.823Z","closeReason":"Created src/agent/apm.ts with core APM types and collector"}
{"id":"oa-d2ad64","title":"Create src/agent/apm-parser.ts - Claude Code conversation parser","description":"","status":"closed","priority":1,"type":"task","labels":["apm"],"deps":[],"commits":["7e020cf4e8459109bb0d59bcb44537fa7f8bcc6c"],"comments":[],"createdAt":"2025-12-03T18:35:22.980Z","updatedAt":"2025-12-03T18:40:19.436Z","closedAt":"2025-12-03T18:40:19.436Z","closeReason":"Created src/agent/apm-parser.ts with Claude Code conversation parser"}
{"id":"oa-20d3d1","title":"Create src/cli/apm.ts - CLI command for APM stats","description":"","status":"closed","priority":2,"type":"task","labels":["apm","cli"],"deps":[],"commits":["7e020cf4e8459109bb0d59bcb44537fa7f8bcc6c"],"comments":[],"createdAt":"2025-12-03T18:35:23.937Z","updatedAt":"2025-12-03T18:40:20.810Z","closedAt":"2025-12-03T18:40:20.810Z","closeReason":"Created src/cli/apm.ts CLI command"}
{"id":"oa-5a59e1","title":"Integrate APM collector into overnight.ts orchestrator","description":"","status":"closed","priority":2,"type":"task","labels":["apm","orchestrator"],"deps":[],"commits":["f7800338b288c6d300702474fcb54947772f78e0"],"comments":[],"createdAt":"2025-12-03T18:35:25.578Z","updatedAt":"2025-12-03T18:44:50.152Z","closedAt":"2025-12-03T18:44:50.152Z","closeReason":"Integrated APMCollector into overnight.ts orchestrator"}
{"id":"oa-710f93","title":"Add APM message types to HUD protocol","description":"","status":"closed","priority":3,"type":"task","labels":["apm","hud"],"deps":[],"commits":["f7800338b288c6d300702474fcb54947772f78e0"],"comments":[],"createdAt":"2025-12-03T18:35:26.803Z","updatedAt":"2025-12-03T18:43:10.505Z","closedAt":"2025-12-03T18:43:10.505Z","closeReason":"Added APM message types to HUD protocol (APMUpdateMessage, APMSnapshotMessage, APMToolUsageMessage)"}
{"id":"oa-7b4925","title":"Create docs/apm.md - APM specification document","description":"","status":"closed","priority":3,"type":"task","labels":["apm","docs"],"deps":[],"commits":["7e020cf4e8459109bb0d59bcb44537fa7f8bcc6c"],"comments":[],"createdAt":"2025-12-03T18:35:27.888Z","updatedAt":"2025-12-03T18:40:21.855Z","closedAt":"2025-12-03T18:40:21.855Z","closeReason":"Created docs/apm.md specification"}
{"id":"oa-2248cf","title":"Create APM emitter helpers in src/hud/emit.ts","description":"","status":"closed","priority":2,"type":"task","labels":["apm","hud"],"deps":[],"commits":["f7800338b288c6d300702474fcb54947772f78e0"],"comments":[],"createdAt":"2025-12-03T18:43:12.780Z","updatedAt":"2025-12-03T18:44:52.462Z","closedAt":"2025-12-03T18:44:52.462Z","closeReason":"Created createAPMEmitter and sendAPMSnapshot helpers in emit.ts"}
{"id":"oa-25ca85","title":"Build APM widget in Electrobun HUD mainview","description":"","status":"closed","priority":3,"type":"task","labels":["apm","hud","electrobun"],"deps":[],"commits":["a2ee60917b0c3461044f0be22dc14b971be9b15a"],"comments":[],"createdAt":"2025-12-03T18:43:13.699Z","updatedAt":"2025-12-03T18:52:58.848Z","closedAt":"2025-12-03T18:52:58.848Z","closeReason":"APM SVG widget implemented in mainview/index.ts with state management, color coding, and message handling"}
{"id":"oa-f83a01","title":"Add parallel overnight CLI for MechaCoder","description":"Create a CLI entry point (overnight-parallel.ts) that runs multiple MechaCoder agents in parallel across isolated git worktrees. Should accept --max-agents N to control parallelism and --max-tasks to limit total work. Uses the existing parallel-runner.ts library.","status":"closed","priority":1,"type":"feature","labels":["mechacoder","parallel","worktree"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-03T19:30:00.000Z","updatedAt":"2025-12-03T19:45:00.000Z","closedAt":"2025-12-03T19:45:00.000Z","closeReason":"Created overnight-parallel.ts with --max-agents and --max-tasks support"}
{"id":"oa-f83a02","title":"Add npm scripts for parallel mechacoder","description":"Add package.json scripts: mechacoder:parallel and mechacoder:parallel:cc-only that invoke the new parallel overnight CLI.","status":"closed","priority":2,"type":"chore","labels":["mechacoder","parallel"],"deps":[{"id":"oa-f83a01","type":"blocks"}],"commits":[],"comments":[],"createdAt":"2025-12-03T19:30:00.000Z","updatedAt":"2025-12-03T19:45:00.000Z","closedAt":"2025-12-03T19:45:00.000Z","closeReason":"Added mechacoder:parallel and mechacoder:parallel:cc-only scripts"}
{"id":"oa-99a12b","title":"Set up Playwright E2E infrastructure","description":"","status":"closed","priority":0,"type":"feature","labels":["e2e","playwright","infrastructure"],"deps":[],"commits":["4ca093d906a5c24cf146d2967c08888b27b59140"],"comments":[],"createdAt":"2025-12-03T19:08:25.189Z","updatedAt":"2025-12-03T19:19:21.681Z","closedAt":"2025-12-03T19:19:21.681Z","closeReason":"Playwright infrastructure complete: config, test server, scripts"}
{"id":"oa-ab3fe3","title":"Create E2E test fixtures and helpers","description":"","status":"closed","priority":0,"type":"feature","labels":["e2e","playwright","fixtures"],"deps":[],"commits":["4ca093d906a5c24cf146d2967c08888b27b59140"],"comments":[],"createdAt":"2025-12-03T19:08:37.028Z","updatedAt":"2025-12-03T19:19:23.406Z","closedAt":"2025-12-03T19:19:23.406Z","closeReason":"Fixtures complete: hud-messages.ts, mainview.fixture.ts"}
{"id":"oa-5c215f","title":"Implement visual/layout E2E tests (A1-A7)","description":"","status":"closed","priority":0,"type":"feature","labels":["e2e","playwright","visual"],"deps":[],"commits":["4ca093d906a5c24cf146d2967c08888b27b59140"],"comments":[],"createdAt":"2025-12-03T19:08:38.195Z","updatedAt":"2025-12-03T19:19:25.480Z","closedAt":"2025-12-03T19:19:25.480Z","closeReason":"Visual tests A1-A7 implemented in render.spec.ts"}
{"id":"oa-3c42f5","title":"Implement interaction E2E tests (B1-B7)","description":"","status":"closed","priority":0,"type":"feature","labels":["e2e","playwright","interactions"],"deps":[],"commits":["4ca093d906a5c24cf146d2967c08888b27b59140"],"comments":[],"createdAt":"2025-12-03T19:08:39.206Z","updatedAt":"2025-12-03T19:19:26.514Z","closedAt":"2025-12-03T19:19:26.514Z","closeReason":"Interaction tests B1-B7 implemented in canvas.spec.ts"}
{"id":"oa-60c161","title":"Implement error handling E2E tests (D1-D6)","description":"","status":"closed","priority":0,"type":"feature","labels":["e2e","playwright","errors"],"deps":[],"commits":["4ca093d906a5c24cf146d2967c08888b27b59140"],"comments":[],"createdAt":"2025-12-03T19:08:41.390Z","updatedAt":"2025-12-03T19:19:28.335Z","closedAt":"2025-12-03T19:19:28.335Z","closeReason":"Error handling tests D1-D6 implemented in error-handling.spec.ts"}
{"id":"oa-6a6c11","title":"Implement real-time update E2E tests (C1-C10)","description":"","status":"closed","priority":1,"type":"feature","labels":["e2e","playwright","realtime","websocket"],"deps":[],"commits":["2adad12f473ef4dcc0122a97bffe10f7b1e467ab"],"comments":[],"createdAt":"2025-12-03T19:08:42.924Z","updatedAt":"2025-12-04T10:29:46.591Z","closedAt":"2025-12-04T10:29:46.591Z","closeReason":"Implemented real-time HUD E2E coverage"}
{"id":"oa-d2bb02","title":"Implement integration E2E tests (E1-E5)","description":"","status":"closed","priority":1,"type":"feature","labels":["e2e","playwright","integration"],"deps":[],"commits":["9f209479aacc7e0964ecccdd0cf84f41070dd378"],"comments":[],"createdAt":"2025-12-03T19:08:44.445Z","updatedAt":"2025-12-04T10:36:32.330Z","closedAt":"2025-12-04T10:36:32.330Z","closeReason":"Added integration E1-E5 coverage and assertions"}
{"id":"oa-92a681","title":"Implement desktop screenshot E2E tests","description":"","status":"closed","priority":1,"type":"feature","labels":["e2e","playwright","desktop","screenshots"],"deps":[],"commits":["57f1b921c0a88deebaeb9ea0d0e1aa6e76729855"],"comments":[],"createdAt":"2025-12-03T19:08:45.661Z","updatedAt":"2025-12-04T10:40:01.483Z","closedAt":"2025-12-04T10:40:01.483Z","closeReason":"Stabilized desktop screenshot E2E suite"}
{"id":"oa-5c3445","title":"Wire sandbox backend into orchestrator runtime","description":"If project.sandbox.enabled is true, run Golden Loop inside the container backend: wrap subagents in runInContainer using project.sandbox config. Start with minimal subagent; after oa-704490 is fixed, run Claude Code path in-container as well. Ensure progress/tasks/logs paths map correctly, verification still runs inside the container, and host-only fallback is available when sandbox is disabled.","status":"closed","priority":1,"type":"feature","labels":["sandbox","mechacoder","orchestrator"],"deps":[{"id":"oa-704490","type":"blocks"}],"commits":["183458ce798902d4257e57ce459aec203e25b1ff"],"comments":[],"createdAt":"2025-12-03T19:24:25.431Z","updatedAt":"2025-12-03T20:27:29.064Z","closedAt":"2025-12-03T20:27:29.064Z","closeReason":"Implemented sandbox backend integration into orchestrator runtime. Created sandbox-runner.ts module with runVerificationWithSandbox, wired into orchestrator.ts, and updated overnight-parallel.ts. When project.sandbox.enabled is true and a container backend is available, verification commands run inside containers. Falls back to host execution when sandbox is disabled or unavailable. Added 13 tests for sandbox runner."}
{"id":"oa-28451f","title":"Enable orchestrator parallel mode with worktrees","description":"Hook ParallelExecutionConfig + parallel-runner into the orchestrator: when parallelExecution.enabled, spin up N worktrees, schedule tasks through parallel-runner, and enforce Golden Loop invariants per worktree (test/typecheck/commit/push/close). Handle merge strategy (direct/queue/pr) from config and ensure cleanup of worktrees/locks.","status":"closed","priority":1,"type":"feature","labels":["parallel","worktree","mechacoder","orchestrator"],"deps":[],"commits":["de5ba0f36a536ce53daf3f4ba100ec1d847c3476","f6bcc7be2347d8ad7c838dcdc038df4b19a7e62b"],"comments":[],"createdAt":"2025-12-03T19:24:31.255Z","updatedAt":"2025-12-04T10:53:45.789Z","closedAt":"2025-12-04T10:53:45.789Z","closeReason":"Adjust parallel orchestrator defaults"}
{"id":"oa-cbe13d","title":"Add Golden Loop parallel regression test","description":"Create a stub repo + .openagents config with parallelExecution.enabled and a few ready tasks, run the orchestrator in parallel mode, and assert tasks close on expected branches with no dirty main. Include CI-friendly test harness that exercises worktree lifecycle and merge strategy basics.","status":"closed","priority":2,"type":"task","labels":["tests","parallel","worktree","golden-loop","mechacoder"],"deps":[],"commits":["69574c6534daa1d7cc8d6e1f2c145d712afeee6d","205b7363e8d1597498fd0363ff6df648ab059f1b"],"comments":[],"createdAt":"2025-12-03T19:24:36.641Z","updatedAt":"2025-12-04T15:04:43.998Z","closedAt":"2025-12-04T15:04:43.998Z","closeReason":"Added parallel worktree regression test and merge resilience"}
{"id":"oa-db46e6","title":"Document LLM provider precedence (Claude Code first)","description":"Update GOLDEN-LOOP-v2.md and AGENTS.md to state provider precedence: Claude Code is primary for coding subagents, minimal subagent as fallback, and Grok/OpenRouter used only as legacy/explicit fallback. Clarify CLI/config flags for legacy mode.","status":"closed","priority":3,"type":"task","labels":["docs","golden-loop","claude-code","llm"],"deps":[],"commits":["ba8c922696b2bd966dfea62e89495e44f5f0e28a"],"comments":[],"createdAt":"2025-12-03T19:24:40.970Z","updatedAt":"2025-12-04T15:40:38.083Z","closedAt":"2025-12-04T15:40:38.083Z","closeReason":"Documented provider precedence and updated regression timeout"}
{"id":"oa-22017b","title":"E2E: Playwright test infrastructure and basic smoke test","description":"Ensure Playwright is properly configured and can run a basic smoke test. Covers: HUD-001 (app launch), HUD-002 (flow diagram renders), HUD-010 (canvas pan), HUD-012 (reset view). Test server should serve mainview, WebSocket should connect, basic interactions should work.","status":"closed","priority":0,"type":"task","labels":["e2e","testing","p0"],"deps":[],"commits":["827d49af33d0ba4b75358fa98bb771de0320fc50"],"comments":[],"createdAt":"2025-12-03T19:32:54.488Z","updatedAt":"2025-12-03T19:47:45.104Z","closedAt":"2025-12-03T19:47:45.104Z","closeReason":"Implemented Playwright smoke test"}
{"id":"oa-c21ca0","title":"E2E: Basic UI load and canvas interactions","description":"Test that user can see UI load with basic buttons and interact with canvas. Covers: HUD-010 (pan canvas), HUD-011 (zoom with wheel), HUD-012 (reset view button), HUD-014 (zoom limits). Verify zoom percentage display, cursor changes, and button responsiveness.","status":"closed","priority":0,"type":"task","labels":["e2e","testing","hud","p0"],"deps":[],"commits":["67fc86d289f97dcb4f0b5c06cda7d2e79e0f5e1c"],"comments":[],"createdAt":"2025-12-03T19:32:56.610Z","updatedAt":"2025-12-04T07:28:03.171Z","closedAt":"2025-12-04T07:28:03.171Z","closeReason":"Completed by MechaCoder orchestrator"}
{"id":"oa-91f147","title":"E2E: Error handling and resilience tests","description":"Test app resilience to errors and malformed data. Covers: HUD-060 (no crash on WS disconnect), HUD-061 (malformed messages handled), HUD-062 (error indicators visible), HUD-063 (recovery from multiple errors). Inject bad data via test server and verify graceful degradation.","status":"closed","priority":0,"type":"task","labels":["e2e","testing","hud","p0"],"deps":[],"commits":["e7c7b046"],"comments":[],"createdAt":"2025-12-03T19:32:58.049Z","updatedAt":"2025-12-04T09:48:07.110Z","closedAt":"2025-12-04T09:48:07.110Z","closeReason":"Completed E2E error handling and resilience tests. Added 19 tests covering WebSocket disconnect, malformed messages, error indicators, and recovery scenarios. All 85 HUD tests passing."}
{"id":"oa-9489d0","title":"E2E: Add headed mode option to see tests run visually","description":"Add option to run Playwright tests in headed (non-headless) mode so users can watch the browser during test execution. Should support: 1) CLI flag like 'bun run e2e:test:headed' or '--headed', 2) Slow-mo option to see interactions step-by-step, 3) Debug mode with Playwright inspector. Update package.json with convenience scripts. Covers developer experience for debugging E2E tests.","status":"closed","priority":1,"type":"task","assignee":"codex","labels":["e2e","testing","dx"],"deps":[],"commits":["a63ac9f319832e0ad36370eff35fda39ae722a7a"],"comments":[],"createdAt":"2025-12-03T19:42:23.699Z","updatedAt":"2025-12-04T11:01:09.473Z","closedAt":"2025-12-04T11:01:09.473Z","closeReason":"Add headed/slow/debug Playwright options"}
{"id":"oa-7fd1ff","title":"Add conflict marker detection to TaskService","description":"Detect git merge conflict markers (<<<<<<<, =======, >>>>>>>) in tasks.jsonl before parsing. Provide clear resolution steps when conflicts detected. Add --check-conflicts flag to tasks:validate CLI.","status":"closed","priority":2,"type":"feature","labels":["git-integration","tasks"],"deps":[],"commits":["aae6357a"],"comments":[],"createdAt":"2025-12-03T21:39:09.511Z","updatedAt":"2025-12-04T13:36:56.858Z","closedAt":"2025-12-04T13:36:56.858Z","closeReason":"Added conflict marker detection and validate CLI"}
{"id":"oa-4c9c36","title":"Add self-healing validation to worktree manager","description":"Add validateWorktree() to detect corrupted worktrees (missing .git, branch mismatch). Add repairWorktree() to auto-recreate. Integrate into worktree-runner.ts before orchestrator runs.","status":"closed","priority":0,"type":"feature","labels":["git-integration","worktrees","p0"],"deps":[],"commits":["0205ec9e"],"comments":[],"createdAt":"2025-12-03T21:39:11.212Z","updatedAt":"2025-12-04T09:48:08.692Z","closedAt":"2025-12-04T09:48:08.692Z","closeReason":"Added self-healing validation to worktree manager. Implemented validateWorktree(), repairWorktree(), and ensureValidWorktree() with auto-repair of corrupted worktrees. All 17 worktree tests passing."}
{"id":"oa-a4aca0","title":"Implement intelligent JSONL merge driver","description":"Create src/tasks/merge.ts with field-level 3-way merge for tasks.jsonl. Match tasks by ID, merge timestamps (max), arrays (union). Add tasks:merge CLI command. Auto-configure git merge driver in init.ts.","status":"closed","priority":2,"type":"feature","labels":["git-integration","tasks"],"deps":[],"commits":["81f2735640a42b38d9b950fc62474d36b4e1f1df"],"comments":[],"createdAt":"2025-12-03T21:39:20.380Z","updatedAt":"2025-12-04T14:17:23.064Z","closedAt":"2025-12-04T14:17:23.064Z","closeReason":"Implemented tasks merge driver and CLI"}
{"id":"oa-c58c87","title":"Add git hooks for automatic validation","description":"Create examples/git-hooks/ with pre-commit (conflict check), post-merge (validate), pre-push (validate). Add install.sh script and README.md documentation.","status":"closed","priority":2,"type":"feature","labels":["git-integration"],"deps":[],"commits":["a8a1da50"],"comments":[],"createdAt":"2025-12-03T21:39:21.372Z","updatedAt":"2025-12-04T13:54:46.732Z","closedAt":"2025-12-04T13:54:46.732Z","closeReason":"Added git hook examples for tasks validation"}
{"id":"oa-e35983","title":"Fix token-by-token streaming in parallel runner verbose output","description":"The parallel runner's verbose mode streams Claude Code output per-token instead of buffering per-line. This creates extremely noisy output like:\n\n```\n[Agent 2] I'll start\n[Agent 2]  by running\n[Agent 2]  the typecheck to see\n[Agent 2]  what\n[Agent 2]  errors nee\n[Agent 2] d to be fixed.\n```\n\nShould buffer output and emit complete lines. Look at the onOutput callback in overnight-parallel.ts - it currently does line splitting but the Claude Code subprocess is already emitting partial tokens.","status":"closed","priority":0,"type":"bug","labels":["parallel-runner","ux","p0"],"deps":[],"commits":["68a014de8689c85f6431e4c997d04b635759f12d"],"comments":[],"createdAt":"2025-12-04T03:27:17.847Z","updatedAt":"2025-12-04T04:51:10.351Z","closedAt":"2025-12-04T04:51:10.351Z","closeReason":"Duplicate of oa-f67e50 which was already fixed with line buffering implementation"}
{"id":"oa-f67e50","title":"Fix token-by-token streaming in parallel runner verbose output","description":"In verbose mode (--verbose), the parallel runner outputs tokens one-by-one instead of buffering by line. This creates extremely noisy output that's hard to read. Example: 'I'll' followed by ' start' followed by ' by' etc. Should buffer output and emit complete lines for readability. The onOutput callback in overnight-parallel.ts receives token fragments from Claude Code CLI - need to implement line buffering.","status":"closed","priority":0,"type":"bug","labels":["parallel-runner","ux"],"deps":[],"commits":["cdb1472728f2b440bfd7cc1a10218e77f199e149"],"comments":[],"createdAt":"2025-12-04T03:28:33.750Z","updatedAt":"2025-12-04T03:34:14.019Z","closedAt":"2025-12-04T03:34:14.019Z","closeReason":"Implemented line buffering for verbose output - tokens are now accumulated until newlines and output as complete lines"}
{"id":"oa-cab0ba","title":"Investigate agent disappearing after Installing dependencies in parallel runner","description":"In parallel runs, Agent 1 sometimes disappears after showing 'Installing dependencies...' message with no further output or error. The agent slot shows no completion, no error - just silence. Need to investigate: 1) Is this a Claude Code CLI timeout? 2) Is the process crashing? 3) Is there a deadlock? Add better logging and timeout handling to detect and report this condition.","status":"closed","priority":1,"type":"bug","labels":["parallel-runner","reliability"],"deps":[],"commits":["1e9a2d6cb3d01ec8e98f3474def1059b7bb8da49"],"comments":[],"createdAt":"2025-12-04T03:28:47.030Z","updatedAt":"2025-12-04T03:40:51.648Z","closedAt":"2025-12-04T03:40:51.648Z","closeReason":"Added 5-minute timeout to bun install using Promise.race - prevents indefinite hangs and reports timeout errors clearly"}
{"id":"oa-6c05d6","title":"Add pre-merge typecheck validation in parallel runner","description":"Typecheck errors from previous parallel runs can be committed to the repo. The parallel runner should run typecheck before merging worktree branches to main. If typecheck fails, the merge should be rejected and the error logged. This prevents broken code from accumulating in main branch.","status":"closed","priority":1,"type":"bug","labels":["parallel-runner","reliability","quality"],"deps":[],"commits":["90f0bdb4a9058a10248414f225d7870f89da636a"],"comments":[],"createdAt":"2025-12-04T03:28:47.900Z","updatedAt":"2025-12-04T03:37:19.962Z","closedAt":"2025-12-04T03:37:19.962Z","closeReason":"Added runTypecheck function and pre-merge validation - worktrees with typecheck errors are now rejected before merging to main"}
{"id":"oa-83d1e1","title":"Fix E2E test flakiness from shared WebSocket state","description":"E2E tests using Playwright show flakiness due to shared WebSocket state between test runs. Tests that pass individually may fail when run in sequence because WebSocket connections from previous tests interfere. Need to ensure proper test isolation - each test should have its own WebSocket connection that's fully cleaned up after the test.","status":"closed","priority":1,"type":"bug","labels":["e2e","testing","flaky"],"deps":[],"commits":["1e9a2d6cb3d01ec8e98f3474def1059b7bb8da49"],"comments":[],"createdAt":"2025-12-04T03:28:48.875Z","updatedAt":"2025-12-04T03:40:54.573Z","closedAt":"2025-12-04T03:40:54.573Z","closeReason":"Fixed E2E test isolation: added beforeEach to clear __hudMessages, fixed unused imports, fixed invalid phase type"}
{"id":"oa-668316","title":"Implement ATIF v1.4 schema with Effect/Schema","description":"Create src/atif/schema.ts with Effect/Schema definitions for ATIF v1.4: Trajectory, Step, Agent, ToolCall, Observation, ObservationResult, SubagentTrajectoryRef, Metrics, FinalMetrics. Follow patterns from src/sessions/schema.ts. Export type helpers: decodeTrajectory, isAgentStep, hasToolCalls.","status":"closed","priority":1,"type":"feature","labels":["atif","schema","phase-1"],"deps":[],"commits":["caf114e54ff05b9e62d0fbd0d664ed9144806b06"],"comments":[],"createdAt":"2025-12-04T03:55:11.731Z","updatedAt":"2025-12-04T04:09:56.461Z","closedAt":"2025-12-04T04:09:56.461Z","closeReason":"Implemented ATIF v1.4 schema in src/atif/schema.ts with Effect/Schema definitions for Trajectory, Step, Agent, ToolCall, Observation, etc. All 25 schema tests pass."}
{"id":"oa-6d4f43","title":"Implement ATIF trajectory validation service","description":"Create src/atif/validation.ts implementing 5 ATIF validation rules: (1) step_id sequential from 1, (2) timestamps in ISO 8601, (3) source restricted to user/agent/system, (4) tool call refs in observations match existing tool_call_ids, (5) agent-only fields only on agent steps. Return Effect.Effect<Trajectory, TrajectoryValidationError>.","status":"closed","priority":1,"type":"feature","labels":["atif","validation","phase-1"],"deps":[],"commits":["caf114e54ff05b9e62d0fbd0d664ed9144806b06"],"comments":[],"createdAt":"2025-12-04T03:55:12.724Z","updatedAt":"2025-12-04T04:09:57.349Z","closedAt":"2025-12-04T04:09:57.349Z","closeReason":"Implemented ATIF validation service in src/atif/validation.ts with all 5 validation rules. Tests verify sequential step_ids, ISO timestamps, source restrictions, tool call refs, and agent-only fields."}
{"id":"oa-349d5e","title":"Implement TrajectoryCollector service","description":"Create src/atif/collector.ts using Context.Tag pattern. Methods: startTrajectory, recordUserStep, recordAgentStep, recordSystemStep, recordObservation, registerSubagent, finishTrajectory. Use Ref for state, auto-sequence step_ids, track tool_call_ids, accumulate metrics.","status":"closed","priority":1,"type":"feature","labels":["atif","collector","phase-2"],"deps":[],"commits":["caf114e54ff05b9e62d0fbd0d664ed9144806b06"],"comments":[],"createdAt":"2025-12-04T03:55:13.788Z","updatedAt":"2025-12-04T04:09:58.218Z","closedAt":"2025-12-04T04:09:58.218Z","closeReason":"Implemented TrajectoryCollector service in src/atif/collector.ts using Context.Tag pattern with Ref state. Includes StandaloneTrajectoryCollector for non-Effect usage. Tests verify step sequencing and metrics accumulation."}
{"id":"oa-5a8809","title":"Implement TrajectoryService for storage","description":"Create src/atif/service.ts for trajectory persistence. Storage: .openagents/trajectories/YYYYMMDD/<session-id>.atif.json. Methods: saveTrajectory, loadTrajectory, listTrajectories, findChildTrajectories, getTrajectoryTree. Validate before save, create date directories.","status":"closed","priority":1,"type":"feature","labels":["atif","storage","phase-3"],"deps":[],"commits":["caf114e54ff05b9e62d0fbd0d664ed9144806b06"],"comments":[],"createdAt":"2025-12-04T03:55:14.795Z","updatedAt":"2025-12-04T04:09:59.225Z","closedAt":"2025-12-04T04:09:59.225Z","closeReason":"Implemented TrajectoryService in src/atif/service.ts with date-organized storage (.openagents/trajectories/YYYYMMDD/), validation on save, and tree traversal for subagent hierarchies."}
{"id":"oa-68542e","title":"Implement event-to-ATIF adapters","description":"Create src/atif/adapter.ts to convert LoopEvent, OrchestratorEvent, SessionEntry to ATIF Steps. Create agent factories: createMechaCoderAgent, createClaudeCodeAgent, createMinimalSubagent. Convert SubagentResult to Observation with subagent_trajectory_ref.","status":"closed","priority":1,"type":"feature","labels":["atif","adapters","phase-4"],"deps":[],"commits":["caf114e54ff05b9e62d0fbd0d664ed9144806b06"],"comments":[],"createdAt":"2025-12-04T03:55:15.697Z","updatedAt":"2025-12-04T04:10:00.105Z","closedAt":"2025-12-04T04:10:00.105Z","closeReason":"Implemented event-to-ATIF adapters in src/atif/adapter.ts. Converts SessionEntry, OrchestratorEvent to Steps. Agent factories for MechaCoder, ClaudeCode, minimal subagent. SubagentResult to Observation with trajectory refs."}
{"id":"oa-3914b5","title":"Integrate ATIF into agent loop","description":"Modify src/agent/loop.ts to wire TrajectoryCollector. Capture: user message, agent responses, tool calls, tool results. Finalize and save trajectory on loop completion.","status":"closed","priority":1,"type":"feature","labels":["atif","integration","phase-5"],"deps":[],"commits":["5a98df676d578ad9eb2aa0d587938290c1003e08"],"comments":[],"createdAt":"2025-12-04T03:55:16.529Z","updatedAt":"2025-12-04T04:20:53.206Z","closedAt":"2025-12-04T04:20:53.206Z","closeReason":"Created integration.ts with createAgentLoopATIF helper that wraps LoopEvents and captures trajectories"}
{"id":"oa-864353","title":"Integrate ATIF into orchestrator","description":"Modify src/agent/orchestrator/orchestrator.ts to create orchestrator trajectory at session start, record phase transitions as system steps, link subagent trajectories via registerSubagent.","status":"closed","priority":1,"type":"feature","labels":["atif","integration","phase-5"],"deps":[],"commits":["5a98df676d578ad9eb2aa0d587938290c1003e08"],"comments":[],"createdAt":"2025-12-04T03:55:17.443Z","updatedAt":"2025-12-04T04:20:54.210Z","closedAt":"2025-12-04T04:20:54.210Z","closeReason":"Created createOrchestratorATIF helper that handles all OrchestratorEvents and links subagent trajectories"}
{"id":"oa-fb8e6c","title":"Capture Claude Code and minimal subagent trajectories","description":"Modify src/agent/orchestrator/claude-code-subagent.ts and src/agent/orchestrator/subagent.ts to create subagent trajectories, pass parent session ID for linking, save on completion, return trajectory path for parent observation.","status":"closed","priority":1,"type":"feature","labels":["atif","subagents","phase-5"],"deps":[],"commits":["5a98df676d578ad9eb2aa0d587938290c1003e08"],"comments":[],"createdAt":"2025-12-04T03:55:19.170Z","updatedAt":"2025-12-04T04:20:55.558Z","closedAt":"2025-12-04T04:20:55.558Z","closeReason":"Created createSubagentATIF helper for capturing Claude Code and minimal subagent trajectories with parent linking"}
{"id":"oa-b0b646","title":"Add ATIF events to HUD protocol","description":"Modify src/hud/protocol.ts to add ATIF message types: atif_trajectory_start, atif_step_recorded, atif_subagent_spawned, atif_trajectory_complete. Create src/atif/hud-integration.ts following pattern from src/hud/emit.ts.","status":"closed","priority":2,"type":"feature","labels":["atif","hud","phase-6"],"deps":[],"commits":["5a98df676d578ad9eb2aa0d587938290c1003e08"],"comments":[],"createdAt":"2025-12-04T03:55:20.116Z","updatedAt":"2025-12-04T04:20:57.146Z","closedAt":"2025-12-04T04:20:57.146Z","closeReason":"Added ATIF events to HUD protocol: ATIFTrajectoryStartMessage, ATIFStepRecordedMessage, ATIFSubagentSpawnedMessage, ATIFTrajectoryCompleteMessage"}
{"id":"oa-6b5cc4","title":"Add trajectory settings to ProjectConfig","description":"Modify src/tasks/project.ts (ProjectConfig schema) to add optional trajectoryConfig: enabled (bool, default true), retentionDays (number, default 30), maxSizeGB (number, default 5).","status":"closed","priority":2,"type":"feature","labels":["atif","config","phase-7"],"deps":[],"commits":["5a98df676d578ad9eb2aa0d587938290c1003e08"],"comments":[],"createdAt":"2025-12-04T03:55:21.253Z","updatedAt":"2025-12-04T04:20:58.584Z","closedAt":"2025-12-04T04:20:58.584Z","closeReason":"Added TrajectoryConfig to ProjectConfig schema with enabled, retentionDays, maxSizeGB, includeToolArgs, includeToolResults, directory settings"}
{"id":"oa-337850","title":"P0: Parallel runner fails to create worktrees when orphaned directories exist","description":"Parallel runner crashed with 'Worktree already exists at .worktrees/oa-6a6c11' when orphaned worktree directories existed from a previous failed run. The directories existed in filesystem but weren't registered with git (git worktree list showed only main). Root cause: pruneStaleWorktrees or worktree cleanup doesn't check for orphaned DIRECTORIES that aren't registered git worktrees. Fix: Before creating worktree, check if directory exists and remove it (or auto-register then prune). This blocked 3/4 tasks from running.","status":"closed","priority":0,"type":"bug","labels":["parallel-runner","worktree","p0"],"deps":[],"commits":["05866e49"],"comments":[],"createdAt":"2025-12-04T04:50:58.512Z","updatedAt":"2025-12-04T09:58:12.857Z","closedAt":"2025-12-04T09:58:12.857Z","closeReason":"Handled orphaned worktree directories before creation"}
{"id":"oa-97f9ab","title":"P0: bun install timeout (300s/5min) too short for parallel agents","description":"Agent 2 timed out after 300s during bun install. The 5-minute timeout added in oa-cab0ba is not sufficient for fresh bun install in worktrees (clean node_modules). Options: (1) Increase timeout to 10+ minutes, (2) Use bun install --frozen-lockfile for faster installs, (3) Share node_modules across worktrees via symlink or hardlink, (4) Pre-warm worktrees with dependencies before agent starts. This blocked 1 agent completely.","status":"closed","priority":0,"type":"bug","labels":["parallel-runner","timeout","p0"],"deps":[],"commits":["d469576c"],"comments":[],"createdAt":"2025-12-04T04:50:59.503Z","updatedAt":"2025-12-04T10:06:37.832Z","closedAt":"2025-12-04T10:06:37.832Z","closeReason":"Extended bun install timeout/args for parallel worktrees"}
{"id":"oa-b5b290","title":"P0: Parallel runner leaves merge conflict markers in files after failed merges","description":"After a failed parallel run, 7 files had git conflict markers (<<<<<<, =======, >>>>>>) but no merge was in progress (no MERGE_HEAD). Files affected: .openagents/tasks.jsonl, .openagents/project.json, src/agent/orchestrator/*.ts, src/cli/*.ts, src/llm/*.ts. This suggests merges are being attempted without proper cleanup on failure. The repo was left in an inconsistent state requiring manual git checkout to recover. Fix: Add merge cleanup/abort on failure, or validate clean state before each run.","status":"closed","priority":0,"type":"bug","labels":["parallel-runner","git","merge","p0"],"deps":[],"commits":["2058a947"],"comments":[],"createdAt":"2025-12-04T04:51:00.783Z","updatedAt":"2025-12-04T10:11:25.520Z","closedAt":"2025-12-04T10:11:25.520Z","closeReason":"Merge failures now abort cleanly and leave no conflicts"}
{"id":"oa-17c183","title":"Design & scaffold Healer module","description":"Create src/healer/* skeleton with types.ts containing all Healer interfaces: HealerScenario, HealerSpellId, HealerSpellResult, HealerOutcome, HealerContext, HealerHeuristics, HealerCounters, GitStatus. Add index.ts for public exports.","status":"closed","priority":1,"type":"feature","labels":["healer","phase-h1"],"deps":[],"commits":["40469707a5bf2f8860e07276a0aed5c6b5709551"],"comments":[],"createdAt":"2025-12-04T04:52:08.811Z","updatedAt":"2025-12-04T04:55:49.367Z","closedAt":"2025-12-04T04:55:49.367Z","closeReason":"Scaffolded Healer module with types.ts, index.ts, and types.test.ts"}
{"id":"oa-71e40d","title":"Add HealerConfig to ProjectConfig","description":"Extend src/tasks/schema.ts with HealerConfig schema: enabled, maxInvocationsPerSession, maxInvocationsPerSubtask, scenarios (onInitFailure, onVerificationFailure, onSubtaskFailure, onRuntimeError, onStuckSubtask), spells (allowed, forbidden), mode (conservative/aggressive). Add to ProjectConfig as optional healer field.","status":"closed","priority":1,"type":"feature","labels":["healer","phase-h1","schema"],"deps":[],"commits":["3329fc2c61f4a2eabb3a0d200f550b6195b7fb3d"],"comments":[],"createdAt":"2025-12-04T04:52:09.857Z","updatedAt":"2025-12-04T04:58:03.363Z","closedAt":"2025-12-04T04:58:03.363Z","closeReason":"Added HealerConfig schema with scenarios, spells, mode, and limits"}
{"id":"oa-cc6e65","title":"Implement Healer policy & event hook","description":"Create src/healer/policy.ts with: shouldRunHealer() to check config/limits, mapEventToScenario() to map OrchestratorEvents to HealerScenarios, HealerCounters for tracking per-session/per-subtask invocations. Include unit tests in __tests__/policy.test.ts.","status":"closed","priority":1,"type":"feature","labels":["healer","phase-h1"],"deps":[],"commits":["be8c5135384ae472f4cde486b58c2d08bd71efed"],"comments":[],"createdAt":"2025-12-04T04:52:10.792Z","updatedAt":"2025-12-04T05:01:27.995Z","closedAt":"2025-12-04T05:01:27.995Z","closeReason":"Implemented policy.ts with shouldRunHealer, mapEventToScenario, rate limiting"}
{"id":"oa-684dc7","title":"Implement core Healer spells","description":"Create src/healer/spells/ with: index.ts (spell registry), rewind.ts (rewind_uncommitted_changes via git restore/clean), blocked.ts (mark_task_blocked_with_followup via TaskService), progress.ts (update_progress_with_guidance appending Healer Summary section). Add context.ts for buildHealerContext(). Include unit tests.","status":"closed","priority":1,"type":"feature","labels":["healer","phase-h1","spells"],"deps":[],"commits":["d4dd5977d8c28a850782ae331311c714a479f545"],"comments":[],"createdAt":"2025-12-04T04:52:11.902Z","updatedAt":"2025-12-04T05:09:44.811Z","closedAt":"2025-12-04T05:09:44.811Z","closeReason":"Implemented core Healer spells: rewind_uncommitted_changes, mark_task_blocked_with_followup, update_progress_with_guidance, plus context builder and 42 new tests"}
{"id":"oa-2508b3","title":"Generalize safe-mode into fix_typecheck_errors spell","description":"Refactor existing safe-mode logic from orchestrator.ts:280-370 into src/healer/spells/typecheck.ts. Create emergency subtask with typecheck fix instructions, invoke Claude Code subagent, re-run verification, return HealerSpellResult. Route through Healer service instead of inline orchestrator code.","status":"closed","priority":1,"type":"feature","labels":["healer","phase-h1","spells","refactor"],"deps":[],"commits":["a10433cb1995dab1cbe6b7b95c4b6b2e561c7153"],"comments":[],"createdAt":"2025-12-04T04:52:13.452Z","updatedAt":"2025-12-04T05:15:00.857Z","closedAt":"2025-12-04T05:15:00.857Z","closeReason":"Extracted safe-mode logic from orchestrator.ts into fix_typecheck_errors and fix_test_errors spells. Includes helpers for generating emergency subtasks and execution functions for HealerService."}
{"id":"oa-2ca2ee","title":"Wire Healer into orchestrator","description":"Create src/healer/service.ts with HealerService.maybeRun() and planner.ts with planSpells(). Integrate into orchestrator.ts at 3 points: after init script failure (~line 280, replacing safe-mode), after subtask failure (~line 629), after verification failure (~line 704). Remove old safe-mode code block.","status":"closed","priority":1,"type":"feature","labels":["healer","phase-h1","orchestrator"],"deps":[],"commits":["4abb4e0be0e0072e63f9a47b4f35a4b05041baa2"],"comments":[],"createdAt":"2025-12-04T04:52:14.467Z","updatedAt":"2025-12-04T05:23:27.243Z","closedAt":"2025-12-04T05:23:27.243Z","closeReason":"Added planner.ts and service.ts for Healer orchestrator integration. Service provides maybeRun() entry point with policy checks, spell planning, and execution. Includes 16 new tests."}
{"id":"oa-4bbc86","title":"Integrate Healer with ATIF trajectories","description":"Create src/healer/atif.ts with createHealerAgent() and createHealerTrajectory(). Add createHealerAgent to src/atif/adapter.ts. Record Healer invocations as subagent trajectories linked to parent orchestrator trajectory via subagent_trajectory_ref. Capture spell execution steps.","status":"closed","priority":1,"type":"feature","labels":["healer","phase-h2","atif"],"deps":[],"commits":["58a49c41ebd95b9334df490bd835abc5a620c2bb"],"comments":[],"createdAt":"2025-12-04T04:52:15.467Z","updatedAt":"2025-12-04T05:29:04.953Z","closedAt":"2025-12-04T05:29:04.953Z","closeReason":"Added ATIF integration: createHealerAgent, event-to-step conversion, trajectory creation, subagent references, HealerEventCollector. 18 new tests."}
{"id":"oa-423828","title":"Add HUD Healer events","description":"Extend src/hud/protocol.ts with Healer message types: healer_invocation_start, healer_invocation_complete, healer_spell_applied. Update HudMessage union. Emit events from HealerService during execution. Add 'healer' to ATIFTrajectoryStartMessage agentType union.","status":"closed","priority":2,"type":"feature","labels":["healer","phase-h2","hud"],"deps":[],"commits":["3d454879c8f87f3fa33fb4ba0acb7ec379a3f039"],"comments":[],"createdAt":"2025-12-04T04:52:16.506Z","updatedAt":"2025-12-04T05:36:17.349Z","closedAt":"2025-12-04T05:36:17.349Z","closeReason":"Added HUD Healer events: HealerInvocationStartMessage, HealerSpellAppliedMessage, HealerInvocationCompleteMessage. Updated HealerService to emit HUD messages."}
{"id":"oa-ffb76c","title":"Stuck task/subtask detection for Healer","description":"Implement stuck detection heuristics: look across ATIF trajectories for repeated failure patterns, trigger Healer for in_progress tasks stuck > N hours. Add CLI command 'bun run healer:scan' to scan and optionally invoke Healer for stale tasks. Enable via scenarios.onStuckSubtask config.","status":"closed","priority":2,"type":"feature","labels":["healer","phase-h3"],"deps":[],"commits":["95153343121883517a2b6f608737c05e2bcba2ea"],"comments":[],"createdAt":"2025-12-04T04:52:17.885Z","updatedAt":"2025-12-04T06:20:28.408Z","closedAt":"2025-12-04T06:20:28.408Z","closeReason":"Implemented stuck detection: isTaskStuckByTime, isSubtaskStuck, extractFailurePatterns, detectStuck. Added healer:scan CLI command. Fixed planner StuckSubtask->SubtaskStuck. 18 new tests."}
{"id":"oa-6c2c6c","title":"E2E tests for Healer scenarios","description":"Create src/healer/__tests__/healer.e2e.test.ts with test scenarios: 1) Init typecheck failure -> Healer fixes -> continue, 2) Verification failure -> Healer rewinds -> marks blocked, 3) Subtask failure x3 -> Healer creates follow-up task, 4) Healer respects invocation limits, 5) Healer never commits if tests still failing.","status":"closed","priority":2,"type":"task","labels":["healer","phase-h3","testing","e2e"],"deps":[],"commits":["d483346a3b9e28c4fc78d671a7e1f8f48c5e8960"],"comments":[],"createdAt":"2025-12-04T04:52:19.156Z","updatedAt":"2025-12-04T06:23:15.305Z","closedAt":"2025-12-04T06:23:15.305Z","closeReason":"Added 12 E2E tests covering all 5 scenarios: init typecheck failure, verification failure, subtask failure x3, invocation limits, and verification failure after fix. 168 total Healer tests."}
{"id":"oa-c8b48c","title":"Create tbench CLI wrapper entry point","description":"Create src/cli/tbench.ts - Main entry point for Harbor to invoke MechaCoder. Accepts --instruction, --model, --output-dir, --timeout. Uses Claude Code subagent. Outputs events.jsonl, trajectory.json, metrics.json.","status":"closed","priority":1,"type":"feature","labels":["terminal-bench","p1"],"deps":[],"commits":["a16f8fc81fde74ec7c3c5053c02eae2b987f60a4"],"comments":[],"createdAt":"2025-12-04T07:04:23.095Z","updatedAt":"2025-12-04T07:13:26.147Z","closedAt":"2025-12-04T07:13:26.147Z","closeReason":"Implemented src/cli/tbench.ts - Terminal-Bench CLI wrapper for Harbor"}
{"id":"oa-d0d651","title":"Implement ATIF trajectory generator from agent events","description":"Create src/atif/generator.ts to convert TaskRunEvent[] to ATIF v1.4 format. Include agent info, model, task, steps array, and summary with token counts.","status":"closed","priority":1,"type":"feature","labels":["terminal-bench","p1","atif"],"deps":[],"commits":["cea10056d7bec33369cdc98dd12c6df6368c6608"],"comments":[],"createdAt":"2025-12-04T07:04:24.779Z","updatedAt":"2025-12-04T07:07:47.067Z","closedAt":"2025-12-04T07:07:47.067Z","closeReason":"Already implemented in src/atif/adapter.ts - full orchestratorEventsToSteps, sessionEntriesToTrajectory, and subagent adapters exist"}
{"id":"oa-a1dd75","title":"Create Harbor Python adapter (MechaCoderAgent class)","description":"Create src/harbor/mechacoder_agent.py extending BaseInstalledAgent. Implement name(), _install_agent_template_path, create_run_agent_commands(), populate_context_post_run().","status":"closed","priority":1,"type":"feature","labels":["terminal-bench","p1","harbor"],"deps":[],"commits":["9074a0cd95e13b2361f51c140a68f8e817fa0091"],"comments":[],"createdAt":"2025-12-04T07:04:26.280Z","updatedAt":"2025-12-04T07:17:08.835Z","closedAt":"2025-12-04T07:17:08.835Z","closeReason":"Implemented src/harbor/mechacoder_agent.py - MechaCoderAgent extending BaseInstalledAgent"}
{"id":"oa-349e6d","title":"Create install-mechacoder.sh.j2 template","description":"Create src/harbor/install-mechacoder.sh.j2 Jinja2 template for Docker container setup. Install Bun, clone openagents, install deps, verify with --help.","status":"closed","priority":1,"type":"feature","labels":["terminal-bench","p1","harbor"],"deps":[],"commits":["9074a0cd95e13b2361f51c140a68f8e817fa0091"],"comments":[],"createdAt":"2025-12-04T07:04:27.289Z","updatedAt":"2025-12-04T07:17:10.366Z","closedAt":"2025-12-04T07:17:10.366Z","closeReason":"Implemented src/harbor/install-mechacoder.sh.j2 - Jinja2 template for container setup"}
{"id":"oa-070738","title":"Add token extraction from Claude Code output","description":"Modify src/agent/claude-code.ts to parse usage from Claude Code stream events. Extract input_tokens, output_tokens. Aggregate across turns and include in metrics output.","status":"closed","priority":1,"type":"feature","labels":["terminal-bench","p1","metrics"],"deps":[],"commits":["e8519e8abae149cf75331e554348fa6bf9fc3a8c"],"comments":[],"createdAt":"2025-12-04T07:04:28.599Z","updatedAt":"2025-12-04T07:21:19.394Z","closedAt":"2025-12-04T07:21:19.394Z","closeReason":"Enhanced token extraction with cache tokens in tbench.ts"}
{"id":"oa-75fa2c","title":"Create pyproject.toml for Harbor package","description":"Create pyproject.toml defining the openagents.harbor Python package for Harbor. Include dependencies: harbor, Jinja2. Set up entry point.","status":"closed","priority":1,"type":"feature","labels":["terminal-bench","p1","harbor"],"deps":[],"commits":["0e141d07a327ec7e945ed16cc3103b73f9ad94fd"],"comments":[],"createdAt":"2025-12-04T07:04:30.227Z","updatedAt":"2025-12-04T07:20:01.104Z","closedAt":"2025-12-04T07:20:01.104Z","closeReason":"Created src/harbor/pyproject.toml and README.md"}
{"id":"oa-8dcda0","title":"Implement tbench-local CLI for internal runs","description":"Create src/cli/tbench-local.ts for running Terminal-Bench tasks locally without Harbor/Docker. Load TB task definitions, run selected tasks or full suite, generate comparison reports.","status":"closed","priority":2,"type":"feature","labels":["terminal-bench","p2"],"deps":[],"commits":["96182fa5e5ba4f842d0eea529d881cf90e544583"],"comments":[],"createdAt":"2025-12-04T07:04:50.135Z","updatedAt":"2025-12-04T07:31:57.539Z","closedAt":"2025-12-04T07:31:57.539Z","closeReason":"Implemented src/cli/tbench-local.ts - Terminal-Bench local CLI for internal runs without Harbor/Docker"}
{"id":"oa-12486d","title":"Add TB-specific reporting to reporter.ts","description":"Enhance src/bench/reporter.ts with Terminal-Bench specific report format. Generate leaderboard-compatible JSON and markdown summary with per-category breakdown.","status":"closed","priority":2,"type":"feature","labels":["terminal-bench","p2","reporting"],"deps":[],"commits":["35632e19"],"comments":[],"createdAt":"2025-12-04T07:04:51.829Z","updatedAt":"2025-12-04T13:46:18.036Z","closedAt":"2025-12-04T13:46:18.036Z","closeReason":"Added Terminal-Bench reporting outputs (JSON + markdown category breakdown)"}
{"id":"oa-143507","title":"Complete Terminal-Bench result conversion","description":"Complete toBenchmarkResults() in src/bench/terminal-bench.ts. Ensure full compatibility with Terminal-Bench result schema for leaderboard submission.","status":"closed","priority":2,"type":"feature","labels":["terminal-bench","p2"],"deps":[],"commits":["a2f9f470"],"comments":[],"createdAt":"2025-12-04T07:04:53.072Z","updatedAt":"2025-12-04T13:51:17.399Z","closedAt":"2025-12-04T13:51:17.399Z","closeReason":"Completed TB result conversion with skip handling"}
{"id":"oa-570dd6","title":"Add e2e test for Harbor adapter","description":"Create integration test that runs Harbor adapter with a mock/simple task. Verify ATIF output, metrics extraction, and error handling.","status":"closed","priority":2,"type":"task","labels":["terminal-bench","p2","testing"],"deps":[],"commits":["c4ee91987351e15f7a3e8150fc57753bded7855f"],"comments":[],"createdAt":"2025-12-04T07:04:54.766Z","updatedAt":"2025-12-04T15:18:09.316Z","closedAt":"2025-12-04T15:18:09.316Z","closeReason":"Added Harbor adapter integration test coverage"}
{"id":"oa-61fff4","title":"Document Terminal-Bench integration in docs/","description":"Create docs/terminal-bench.md documenting the Terminal-Bench integration. Include usage examples for leaderboard submission and internal evaluation.","status":"closed","priority":3,"type":"task","labels":["terminal-bench","p3","docs"],"deps":[],"commits":["3f2638f49c82a9c42f4b1fdcbfe6ef52d95d8c54"],"comments":[],"createdAt":"2025-12-04T07:04:55.684Z","updatedAt":"2025-12-04T14:08:50.797Z","closedAt":"2025-12-04T14:08:50.797Z","closeReason":"Documented Terminal-Bench integration guide"}
{"id":"oa-cdbf40","title":"Add CI workflow for TB smoke tests","description":"Add GitHub Actions workflow that runs a basic Terminal-Bench smoke test on PRs. Use a simple task to verify the adapter works.","status":"closed","priority":3,"type":"task","labels":["terminal-bench","p3","ci"],"deps":[],"commits":["1ba6cb4da3fe0916a150a004f5182574ceb266e6","efeec721184125c3b5d8693400438701160eb847"],"comments":[],"createdAt":"2025-12-04T07:04:57.492Z","updatedAt":"2025-12-04T16:26:32.799Z","closedAt":"2025-12-04T16:25:59.868Z","closeReason":"Added CI workflow to run TB harbor smoke tests on PRs"}
{"id":"oa-01061b","title":"Create results visualization dashboard","description":"Create a simple dashboard/page to visualize Terminal-Bench results over time. Show success rate trends, per-category performance, cost tracking.","status":"open","priority":3,"type":"feature","labels":["terminal-bench","p3","visualization"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-04T07:04:59.187Z","updatedAt":"2025-12-04T07:04:59.187Z","closedAt":null}
{"id":"oa-7a31fd","title":"Integrate Healer into orchestrator error handling","description":"The Healer subagent is fully implemented (src/healer/*) with all tests passing, but it's not integrated into the orchestrator. When errors occur (like git commit failures), the orchestrator crashes instead of invoking the Healer.\n\n## Tasks:\n1. Import HealerService into do-one-task.ts\n2. Initialize HealerService with counters\n3. Call healer.maybeRun() on orchestrator errors\n4. Add Healer trajectory refs to main trajectory\n5. Test with intentional failures (git commit, typecheck, etc)\n\n## Files to modify:\n- src/agent/do-one-task.ts\n- src/agent/orchestrator/types.ts (if needed for HealerCounters)\n\n## Acceptance:\n- RuntimeError triggers Healer\n- Healer attempts fix spells\n- Logs show 'Healer invoked for...'\n- Healer trajectory saved to .openagents/trajectories/","status":"closed","priority":0,"type":"task","labels":["healer","orchestrator","P0"],"deps":[],"commits":["bfc58001d2ce64140618454cf973a4158aff51bc"],"comments":[],"createdAt":"2025-12-04T07:20:51.774Z","updatedAt":"2025-12-04T07:25:47.690Z","closedAt":"2025-12-04T07:25:47.690Z","closeReason":"Integrated Healer into orchestrator - now invokes healer.maybeRun() on all orchestrator events"}
{"id":"oa-591b20","title":"Add TB message types to HUD protocol","description":"Add Terminal-Bench specific message types to src/hud/protocol.ts: TBRunStartMessage, TBRunCompleteMessage, TBTaskStartMessage, TBTaskProgressMessage, TBTaskOutputMessage, TBTaskCompleteMessage, TBSuiteInfoMessage, TBRunRequestMessage. Add all to HudMessage union type. Add type guards.","status":"closed","priority":1,"type":"feature","labels":["tbench","hud","protocol"],"deps":[],"commits":["5732ff29"],"comments":[],"createdAt":"2025-12-04T08:49:18.306Z","updatedAt":"2025-12-04T09:14:36.570Z","closedAt":"2025-12-04T09:14:36.570Z","closeReason":"TB message types were added to protocol.ts in earlier commit"}
{"id":"oa-08e971","title":"Add TB message types to HUD protocol","description":"Add Terminal-Bench specific message types to src/hud/protocol.ts","status":"closed","priority":1,"type":"feature","labels":["tbench","hud","protocol"],"deps":[],"commits":["3d021ab6630743c9bf52d5ad2de011a30bb0b050"],"comments":[],"createdAt":"2025-12-04T08:49:24.535Z","updatedAt":"2025-12-04T08:57:46.114Z","closedAt":"2025-12-04T08:57:46.114Z","closeReason":"Added 8 TB message types to HUD protocol"}
{"id":"oa-3822ce","title":"Emit HUD events from tbench-local.ts","description":"Modify src/cli/tbench-local.ts to emit HUD messages during run lifecycle. Import HudClient, emit tb_run_start, tb_task_start, tb_task_progress, tb_task_complete, tb_run_complete at appropriate lifecycle points.","status":"closed","priority":1,"type":"feature","labels":["tbench","hud"],"deps":[],"commits":["3d021ab6630743c9bf52d5ad2de011a30bb0b050"],"comments":[],"createdAt":"2025-12-04T08:49:35.670Z","updatedAt":"2025-12-04T08:57:46.427Z","closedAt":"2025-12-04T08:57:46.427Z","closeReason":"Integrated HUD events into tbench-local.ts"}
{"id":"oa-3beecf","title":"Create TB emit helpers","description":"Create src/tbench-hud/emit.ts with helper functions for emitting TB events. Include createTBEmitter factory, emitRunStart, emitTaskStart, emitTaskProgress, emitTaskOutput, emitTaskComplete, emitRunComplete. Auto-generate runId.","status":"closed","priority":1,"type":"feature","labels":["tbench","hud"],"deps":[],"commits":["3d021ab6630743c9bf52d5ad2de011a30bb0b050"],"comments":[],"createdAt":"2025-12-04T08:49:36.895Z","updatedAt":"2025-12-04T08:57:46.271Z","closedAt":"2025-12-04T08:57:46.271Z","closeReason":"Created src/tbench-hud/emit.ts with TBEmitter factory"}
{"id":"oa-83c4f8","title":"Add TB state management to mainview","description":"Add TBState interface and state variable to src/mainview/index.ts. Handle all TB message types in handleHudMessage(). Define TBState with isRunning, suiteName, totalTasks, tasks Map, currentTaskId, passed, failed, passRate.","status":"closed","priority":1,"type":"feature","labels":["tbench","hud","ui"],"deps":[],"commits":["5732ff29"],"comments":[],"createdAt":"2025-12-04T08:49:38.691Z","updatedAt":"2025-12-04T09:01:17.250Z","closedAt":"2025-12-04T09:01:17.250Z","closeReason":"Added TBState interface, renderTBWidget(), and TB message handling to mainview"}
{"id":"oa-673c94","title":"Render TB progress widget","description":"Add renderTBWidget() function to display compact TB progress overlay in mainview. Fixed position SVG overlay showing suite name, progress bar, pass/fail counts, current task. Green for pass, red for fail.","status":"closed","priority":1,"type":"feature","labels":["tbench","hud","ui"],"deps":[],"commits":["5732ff29"],"comments":[],"createdAt":"2025-12-04T08:49:40.146Z","updatedAt":"2025-12-04T09:01:18.768Z","closedAt":"2025-12-04T09:01:18.768Z","closeReason":"TB progress widget integrated into render() - displays progress bar, pass/fail stats, current task"}
{"id":"oa-1f8384","title":"Add RPC handler for TB run triggering","description":"Add bidirectional RPC to src/bun/index.ts to trigger TB runs from UI. Add startTBRun request handler accepting suitePath, taskIds, timeout, maxTurns. Spawn tbench-local.ts subprocess. Add loadTBSuite request.","status":"closed","priority":2,"type":"feature","labels":["tbench","hud","rpc"],"deps":[],"commits":["035b673e"],"comments":[],"createdAt":"2025-12-04T08:49:54.128Z","updatedAt":"2025-12-04T09:03:49.871Z","closedAt":"2025-12-04T09:03:49.871Z","closeReason":"Added loadTBSuite, startTBRun, stopTBRun RPC handlers in bun and mainview"}
{"id":"oa-44ffa1","title":"Add keyboard shortcut for demo run","description":"Add Ctrl+T keyboard shortcut to trigger a demo TB run from mainview. Call RPC startTBRun with demo config (single easy task). Show notification that run started.","status":"closed","priority":2,"type":"feature","labels":["tbench","hud","ui"],"deps":[],"commits":["c3f746ed"],"comments":[],"createdAt":"2025-12-04T08:49:55.525Z","updatedAt":"2025-12-04T09:09:44.504Z","closedAt":"2025-12-04T09:09:44.504Z","closeReason":"Added Ctrl+L (load), Ctrl+T (start), Ctrl+X (stop) keyboard shortcuts"}
{"id":"oa-50dc74","title":"Add view mode switcher","description":"Add ability to switch between Flow view and TB view in mainview. Add viewMode state (flow/tbench). Ctrl+1 for Flow, Ctrl+2 for TB. Conditionally render based on mode. Persist preference.","status":"closed","priority":2,"type":"feature","labels":["tbench","hud","ui"],"deps":[],"commits":["6d10c6b8"],"comments":[],"createdAt":"2025-12-04T08:49:57.030Z","updatedAt":"2025-12-04T09:17:24.021Z","closedAt":"2025-12-04T09:17:24.021Z","closeReason":"Added view mode switcher with Ctrl+1/Ctrl+2, Flow/TB buttons, localStorage persistence"}
{"id":"oa-4815c0","title":"Create TB view HTML/CSS structure","description":"Create TB view layout in src/tbench-view/. Suite header with name/version/count, main panel for progress/output, sidebar for task list, stats bar at bottom. Dark theme matching HUD style.","status":"closed","priority":2,"type":"feature","labels":["tbench","ui"],"deps":[],"commits":["0d7c16e0"],"comments":[],"createdAt":"2025-12-04T08:49:58.814Z","updatedAt":"2025-12-04T14:01:34.804Z","closedAt":"2025-12-04T14:01:34.804Z","closeReason":"Added TB view HTML/CSS skeleton"}
{"id":"oa-bd4cc3","title":"Implement category/task tree component","description":"Create collapsible tree view showing categories and tasks with status. Group by category, show status icons (pending/running/passed/failed), difficulty badge, click for detail view, category pass rate.","status":"closed","priority":2,"type":"feature","labels":["tbench","ui"],"deps":[],"commits":["3aee8031104c29b51b9f96738ec3d54f8fe94ce2"],"comments":[],"createdAt":"2025-12-04T08:50:10.587Z","updatedAt":"2025-12-04T09:30:48.962Z","closedAt":"2025-12-04T09:30:48.962Z","closeReason":"Implemented category/task tree with collapsible categories, status icons, difficulty badges, and category stats"}
{"id":"oa-8b6113","title":"Implement real-time output viewer","description":"Create streaming output viewer for current task. Auto-scrolling text, real-time agent output, color-code by source, max 1000 line buffer, copy button, clear on task change.","status":"closed","priority":2,"type":"feature","labels":["tbench","ui"],"deps":[],"commits":["3aee8031104c29b51b9f96738ec3d54f8fe94ce2"],"comments":[],"createdAt":"2025-12-04T08:50:11.549Z","updatedAt":"2025-12-04T09:27:04.489Z","closedAt":"2025-12-04T09:27:04.489Z","closeReason":"Implemented real-time output viewer with streaming buffer, auto-scroll, copy/clear buttons"}
{"id":"oa-9aaa01","title":"Implement run progress panel","description":"Create progress panel showing overall run status. Progress bar with percentage, current task info, elapsed time, pass/fail/timeout/error counters, abort button.","status":"closed","priority":2,"type":"feature","labels":["tbench","ui"],"deps":[],"commits":["6d10c6b8"],"comments":[],"createdAt":"2025-12-04T08:50:13.196Z","updatedAt":"2025-12-04T09:17:25.448Z","closedAt":"2025-12-04T09:17:25.448Z","closeReason":"Full-screen TB dashboard with progress bar, stats, task list, current task info"}
{"id":"oa-e52575","title":"Implement run trigger dialog","description":"Create modal dialog for configuring TB runs. Suite selector, task selection (all/category/difficulty/manual), timeout/max turns options, baseline comparison selector, start/cancel buttons.","status":"closed","priority":3,"type":"feature","labels":["tbench","ui"],"deps":[],"commits":["c3f746ed"],"comments":[],"createdAt":"2025-12-04T08:50:31.616Z","updatedAt":"2025-12-04T09:09:45.506Z","closedAt":"2025-12-04T09:09:45.506Z","closeReason":"Implemented run trigger UI with suite path input, task selector, and start/stop buttons"}
{"id":"oa-f4ef9d","title":"Implement run history storage","description":"Store and retrieve historical TB run results. Store in .openagents/tbench/runs/ as JSON. Include runId, suite, config, results, summary. Load history on startup, limit to last 50 runs.","status":"closed","priority":3,"type":"feature","labels":["tbench","storage"],"deps":[],"commits":["5c1a39a7ec1ace2f81ee5fda277b2f2f5debb75b"],"comments":[],"createdAt":"2025-12-04T08:50:32.451Z","updatedAt":"2025-12-04T19:57:41.357Z","closedAt":"2025-12-04T19:57:41.357Z","closeReason":"Already implemented in src/tbench-hud/persistence.ts - stores runs in .openagents/tb-runs/ with full metadata and task results"}
{"id":"oa-b86a0a","title":"Implement run comparison view","description":"Show comparison between current run and baseline. Pass rate delta, avg duration delta, improved/regressed/unchanged task lists, delta highlighting (green=better, red=worse).","status":"closed","priority":3,"type":"feature","labels":["tbench","ui"],"deps":[],"commits":["2a61aa5d51a729e02a8ab5d786a38713f68a7274"],"comments":[],"createdAt":"2025-12-04T08:50:33.442Z","updatedAt":"2025-12-04T20:01:27.522Z","closedAt":"2025-12-04T20:01:27.522Z","closeReason":"Implemented comparison view with pass rate delta, duration delta, improved/regressed task lists, and color-coded delta highlighting"}
{"id":"oa-42f76e","title":"Add TB node visualization in flow graph","description":"Optionally show TB tasks as nodes in flow graph. New tbTask node type, TB theme colors (green), build TB flow tree, suite->category->task hierarchy, status-based styling.","status":"closed","priority":3,"type":"feature","labels":["tbench","flow","ui"],"deps":[],"commits":["5c1a39a7ec1ace2f81ee5fda277b2f2f5debb75b"],"comments":[],"createdAt":"2025-12-04T08:50:35.119Z","updatedAt":"2025-12-04T19:57:42.790Z","closedAt":"2025-12-04T19:57:42.790Z","closeReason":"Already implemented in src/flow/tb-map.ts - TB nodes with tb-task, tb-run-summary, tb-run-expanded types and green theme styling"}
{"id":"oa-c0e825","title":"Write tests for TB HUD components","description":"Add tests for TB state management and event handling. Test message type guards, state reducer, emit helpers, RPC handlers. Mock HudClient for testing.","status":"closed","priority":3,"type":"task","labels":["tbench","testing"],"deps":[],"commits":["48990dabeff1b1eece08bb8deda81bdb2fec2b5e"],"comments":[],"createdAt":"2025-12-04T08:50:36.291Z","updatedAt":"2025-12-04T17:31:25.749Z","closedAt":"2025-12-04T17:31:25.749Z","closeReason":"Added TB HUD protocol/emitter/buffer tests"}
{"id":"oa-aa06e9","title":"Document TB HUD visualization","description":"Document TB visualization features in docs/tbench/README.md. Explain view modes, keyboard shortcuts, triggering runs from UI, screenshots, troubleshooting.","status":"closed","priority":3,"type":"task","labels":["tbench","docs"],"deps":[],"commits":["f82c193d0c0f62c1de8f3a189228b4cad96ba7a8","2142906943a641919e8cf80dde381c4a1db9ba13"],"comments":[],"createdAt":"2025-12-04T08:50:37.969Z","updatedAt":"2025-12-04T16:12:49.466Z","closedAt":"2025-12-04T16:12:49.466Z","closeReason":"Documented TB HUD and stabilized parallel runner regression install handling"}
{"id":"oa-801269","title":"Fix Healer synchronous integration in orchestrator","description":"## Problem\n\nHealer is fully implemented (168 tests passing) but integration is broken. Healer runs asynchronously AFTER orchestrator decides to fail, so it never gets a chance to act.\n\n## Solution\n\nMove Healer invocation from async emit() callback to synchronous Effect.gen block in orchestrator's orientation phase, using yield* pattern.\n\n## Implementation\n\nPhase 1: Init Script Integration\n- Create full Healer service with ClaudeCodeInvoker\n- Thread service to orchestrator via config\n- Replace safe-mode (lines 280-370) with Healer\n- Remove async callback (lines 860-882)\n\nSee: .claude/plans/staged-enchanting-castle.md\n\n## Success Criteria\n\n- Init typecheck failures invoke Healer synchronously\n- Orchestrator continues after successful healing\n- All tests pass\n- Manual test with typecheck error succeeds","status":"closed","priority":0,"type":"bug","labels":["healer","orchestrator","p0"],"deps":[],"commits":["bc33581fc5a960f62338aafad307b6776e7e87a1"],"comments":[],"createdAt":"2025-12-04T08:55:10.539Z","updatedAt":"2025-12-04T09:06:55.607Z","closedAt":"2025-12-04T09:06:55.607Z","closeReason":"Fixed Healer synchronous integration - Healer now runs BEFORE orchestrator decides to fail, using yield* pattern for synchronous execution"}
{"id":"oa-48b30b","title":"Healer Phase 2: Add subtask failure healing","description":"Add Healer invocation after subtask failures (orchestrator.ts ~line 629). When a subtask fails, invoke Healer synchronously to attempt recovery before giving up.","status":"closed","priority":1,"type":"task","labels":["healer","orchestrator","phase2"],"deps":[],"commits":["8524b064636ca700208150ba0ecbfaab6ee8c204"],"comments":[],"createdAt":"2025-12-04T09:15:16.647Z","updatedAt":"2025-12-04T09:17:10.699Z","closedAt":"2025-12-04T09:17:10.699Z","closeReason":"Added Healer invocation after subtask failures with automatic retry on resolution"}
{"id":"oa-ee8094","title":"Healer Phase 2: Add verification failure healing","description":"Add Healer invocation after verification failures (orchestrator.ts ~line 704). When typecheck/tests fail after subtask completion, invoke Healer to fix the issues.","status":"closed","priority":1,"type":"task","labels":["healer","orchestrator","phase2"],"deps":[],"commits":["6d10c6b84a5cf2cdf425086e935aab67511df2a5"],"comments":[],"createdAt":"2025-12-04T09:15:24.190Z","updatedAt":"2025-12-04T09:17:16.371Z","closedAt":"2025-12-04T09:17:16.371Z","closeReason":"Added Healer invocation after verification failures with re-verification on resolution"}
{"id":"oa-1a6f31","title":"Add pre-flight typecheck validation to overnight-parallel","description":"Parallel agents duplicate effort on typecheck errors. overnight-parallel.ts should run typecheck (and optionally invoke Healer) on main repo BEFORE creating worktrees. This ensures all agents start from a clean, passing codebase.","status":"closed","priority":1,"type":"bug","assignee":"codex","labels":["parallel","healer","typecheck"],"deps":[],"commits":["9dba960915640b4ef095bf255ce69823358ece7c"],"comments":[],"createdAt":"2025-12-04T09:36:37.500Z","updatedAt":"2025-12-04T11:05:34.220Z","closedAt":"2025-12-04T11:05:34.220Z","closeReason":"Abort parallel run when main typecheck fails"}
{"id":"oa-c3d1a1","title":"Make mark_task_blocked_with_followup spell idempotent","description":"## Problem\n\nThe `mark_task_blocked_with_followup` spell in `src/healer/spells/blocked.ts` may create duplicate follow-up tasks if Healer runs multiple times for the same failure scenario.\n\nIn durable execution systems, side effects must be **idempotent** - running the same operation twice should produce the same result as running it once. Currently, if Healer is invoked twice for the same failure (e.g., due to a crash and restart), it could create two identical follow-up tasks.\n\n## Solution\n\nBefore creating a follow-up task, check if one already exists:\n\n1. Query `.openagents/tasks.jsonl` for existing tasks that match:\n   - Have a `deps` entry with `type: \"discovered-from\"` pointing to the current task\n   - Have labels or title indicating they were created by Healer for the same scenario\n   - Were created within a reasonable time window (e.g., same session or last hour)\n\n2. If a matching follow-up exists:\n   - Update it instead of creating a new one (e.g., append to description if new info available)\n   - Return success with `changesApplied: false` (no new task created)\n\n3. If no matching follow-up exists:\n   - Create the new task as currently implemented\n\n## Implementation Notes\n\n- Add a helper function like `findExistingHealerFollowup(taskId: string, scenario: HealerScenario): Task | null`\n- Use TaskService to query tasks\n- Consider adding a `healerScenario` field to follow-up task metadata for easier matching\n- Update `HealerSpellResult` to indicate whether a new task was created vs existing updated\n\n## Files to Modify\n\n- `src/healer/spells/blocked.ts` - Main implementation\n- `src/healer/__tests__/spells.test.ts` - Add idempotency tests\n\n## Acceptance Criteria\n\n- [ ] Running `mark_task_blocked_with_followup` twice for same task/scenario creates only one follow-up task\n- [ ] Second invocation returns success but indicates no new task created\n- [ ] Existing follow-up task is updated if new information is available\n- [ ] Tests cover the idempotency behavior","status":"closed","priority":1,"type":"bug","labels":["healer","idempotency","spells"],"deps":[{"id":"oa-850dd5","type":"parent-child"}],"commits":["5f2bf6d10a5c693f5675eab78b31b45a5230bc23"],"comments":[],"createdAt":"2025-12-04T17:18:39.450Z","updatedAt":"2025-12-04T22:03:53.395Z","closedAt":"2025-12-04T17:38:01.717Z","closeReason":"Idempotent follow-up containment spell"}
{"id":"oa-ebfdaa","title":"Make update_progress_with_guidance spell idempotent","description":"## Problem\n\nThe `update_progress_with_guidance` spell in `src/healer/spells/progress.ts` may append duplicate sections to `progress.md` if Healer runs multiple times for the same failure scenario.\n\nIn durable execution systems, side effects must be **idempotent** - the same operation should be safe to retry. Currently, if Healer is invoked twice (e.g., crash and restart), progress.md could end up with:\n\n```markdown\n### Healer Summary\n...first invocation content...\n\n### Healer Summary  \n...second invocation content (duplicate)...\n```\n\n## Solution\n\nReplace or update existing Healer sections rather than appending:\n\n1. When writing to progress.md, check if a \"Healer Summary\" section already exists\n2. If it exists for the **same scenario**:\n   - Replace it with updated content\n   - Or merge new information into existing section\n3. If it exists for a **different scenario**:\n   - Keep both (different healing attempts are distinct)\n4. If no Healer section exists:\n   - Append as currently implemented\n\n## Implementation Approach\n\nOption A: Use markers for replacement\n```markdown\n<!-- HEALER:InitScriptTypecheckFailure:START -->\n### Healer Summary (InitScriptTypecheckFailure)\n...content...\n<!-- HEALER:InitScriptTypecheckFailure:END -->\n```\n\nOption B: Parse and replace by section header\n- Look for `### Healer Summary` or `### Healer:` sections\n- Match by scenario in the header\n- Replace content between this header and the next `###` header\n\n## Files to Modify\n\n- `src/healer/spells/progress.ts` - Main implementation\n- `src/healer/__tests__/spells.test.ts` - Add idempotency tests\n\n## Acceptance Criteria\n\n- [ ] Running `update_progress_with_guidance` twice for same scenario produces single section\n- [ ] Content is updated/replaced, not duplicated\n- [ ] Different scenarios can have separate sections\n- [ ] Tests verify idempotent behavior with same and different scenarios","status":"closed","priority":1,"type":"bug","labels":["healer","idempotency","spells"],"deps":[{"id":"oa-850dd5","type":"parent-child"}],"commits":["053f6d4e4585b24fb92e543ac6cbeb09999add06"],"comments":[],"createdAt":"2025-12-04T17:18:41.740Z","updatedAt":"2025-12-04T22:03:53.622Z","closedAt":"2025-12-04T18:04:59.844Z","closeReason":"Implemented idempotent upsertHealerSummarySection with HTML comment markers"}
{"id":"oa-23428c","title":"Add Healer invocation deduplication in HealerService","description":"## Problem\n\nWhile individual spells can be made idempotent, there's a higher-level issue: the entire Healer invocation could be duplicated if triggered multiple times for the same failure event.\n\nCurrently, HealerCounters track invocation counts per session/subtask for rate limiting, but don't prevent duplicate healing for the **exact same failure**.\n\n## Solution\n\nAdd invocation deduplication at the HealerService level:\n\n1. Generate a unique \"healing key\" for each failure:\n   ```typescript\n   type HealingKey = `${taskId}:${subtaskId}:${scenario}:${errorHash}`;\n   ```\n\n2. Before executing spells, check if this exact failure was already healed:\n   - Store completed healing keys in `HealerCounters` or a separate dedup map\n   - If key exists and healing was successful (`resolved` or `contained`), skip re-healing\n   - If key exists but healing was `unresolved`, allow retry with incremented attempt count\n\n3. Persist healing state across potential crashes:\n   - Write healing attempts to `.openagents/healer-state.json` or similar\n   - On orchestrator restart, load previous healing state\n   - Prevents duplicate healing after crash recovery\n\n## Implementation\n\n```typescript\n// In src/healer/types.ts\ninterface HealingAttempt {\n  key: string;\n  scenario: HealerScenario;\n  taskId: string;\n  subtaskId?: string;\n  timestamp: string;\n  outcome: HealerOutcomeStatus;\n  spellsTried: HealerSpellId[];\n}\n\n// In HealerCounters or new structure\nhealingAttempts: Map<string, HealingAttempt>;\n```\n\n```typescript\n// In src/healer/service.ts maybeRun()\nconst healingKey = buildHealingKey(event, state);\nconst previousAttempt = counters.healingAttempts.get(healingKey);\n\nif (previousAttempt?.outcome === \"resolved\" || previousAttempt?.outcome === \"contained\") {\n  return { ...previousAttempt, status: \"skipped\", reason: \"Already healed\" };\n}\n```\n\n## Files to Modify\n\n- `src/healer/types.ts` - Add HealingAttempt type, update HealerCounters\n- `src/healer/service.ts` - Add deduplication logic in maybeRun()\n- `src/healer/policy.ts` - Add `buildHealingKey()` helper\n- `src/healer/__tests__/service.test.ts` - Test deduplication\n\n## Acceptance Criteria\n\n- [ ] Same failure event triggers Healer only once (even if event fires multiple times)\n- [ ] Successful healing is not re-attempted\n- [ ] Failed healing (`unresolved`) can be retried\n- [ ] Healing state survives orchestrator restart\n- [ ] Tests cover deduplication scenarios","status":"closed","priority":2,"type":"feature","labels":["healer","idempotency","service"],"deps":[{"id":"oa-850dd5","type":"parent-child"}],"commits":["43e30d2018b8ef059143428b7125cfa9e4beaed8","9a2b1b302d18cb0fa83249ea73f8b9434c212b84"],"comments":[],"createdAt":"2025-12-04T17:18:43.293Z","updatedAt":"2025-12-04T23:57:45.667Z","closedAt":"2025-12-04T23:57:45.667Z","closeReason":"Implemented healer invocation deduplication with persistence"}
{"id":"oa-4cce8f","title":"Add orchestrator checkpoints for crash recovery","description":"## Background\n\nIn durable execution systems (like Temporal, Restate), workflows persist state at key points so they can resume from the last checkpoint after a crash, rather than restarting from the beginning.\n\nCurrently, the OpenAgents orchestrator persists some state (progress.md, subtasks/*.json) but doesn't have formal checkpoints. On crash, recovery relies on:\n- Subtask status (done/pending/in_progress)\n- Progress file blockers\n- Claude Code session resumption\n\nThis works but could be more robust with explicit checkpointing.\n\n## Proposal\n\nAdd explicit checkpoint persistence at orchestrator phase transitions:\n\n```\norient → [checkpoint] → select_task → [checkpoint] → decompose → [checkpoint] → \nexecute_subtask_1 → [checkpoint] → execute_subtask_2 → [checkpoint] → \nverify → [checkpoint] → commit → [checkpoint] → done\n```\n\n## Implementation\n\n1. **Define checkpoint structure:**\n   ```typescript\n   // src/agent/orchestrator/checkpoint.ts\n   interface OrchestratorCheckpoint {\n     sessionId: string;\n     phase: OrchestratorPhase;\n     timestamp: string;\n     taskId?: string;\n     completedSubtasks: string[];\n     currentSubtaskId?: string;\n     gitState: {\n       branch: string;\n       lastCommit: string;\n       isDirty: boolean;\n     };\n     healerState?: HealingAttempt[];\n   }\n   ```\n\n2. **Persist checkpoints:**\n   - Write to `.openagents/checkpoint.json` at each phase transition\n   - Atomic write (write to temp file, then rename)\n   - Include enough state to resume from that point\n\n3. **Recovery on startup:**\n   - Check for existing checkpoint.json\n   - If found and session incomplete, offer to resume\n   - Skip already-completed phases\n   - Re-execute from last checkpoint\n\n4. **Checkpoint cleanup:**\n   - Delete checkpoint.json on successful session completion\n   - Keep last N checkpoints for debugging (optional)\n\n## Files to Create/Modify\n\n- `src/agent/orchestrator/checkpoint.ts` (new) - Checkpoint types and helpers\n- `src/agent/orchestrator/orchestrator.ts` - Add checkpoint calls at phase transitions\n- `src/agent/orchestrator/types.ts` - Add OrchestratorCheckpoint type\n\n## Acceptance Criteria\n\n- [ ] Checkpoint written at each major phase transition\n- [ ] Orchestrator can resume from checkpoint after crash\n- [ ] Completed subtasks are not re-executed\n- [ ] Checkpoint is cleaned up on successful completion\n- [ ] Manual recovery possible via checkpoint inspection","status":"open","priority":3,"type":"feature","labels":["orchestrator","resilience","checkpoints"],"deps":[{"id":"oa-850dd5","type":"parent-child"}],"commits":[],"comments":[],"createdAt":"2025-12-04T17:18:44.618Z","updatedAt":"2025-12-04T22:03:39.775Z","closedAt":null}
{"id":"oa-c83546","title":"Add ATIF trajectory persistence for Healer replay","description":"## Background\n\nIn durable execution systems, recovery works by \"replaying\" from a persisted log. The system re-executes from the beginning but uses memoized results from the log instead of actually re-running completed operations.\n\nThe OpenAgents ATIF (Agent Trajectory Interchange Format) already captures execution history but is currently used for observability, not recovery. This task explores using ATIF for replay-based Healer recovery.\n\n## Current State\n\n- `src/healer/atif.ts` creates trajectories from HealerEvents\n- `HealerEventCollector` captures events during execution\n- Trajectories include spell executions and outcomes\n- But: trajectories are created AFTER execution, not used FOR recovery\n\n## Proposal\n\nEnable replay-based recovery for Healer:\n\n1. **Persist HealerContext before spell execution:**\n   ```typescript\n   // Before executing spells\n   const contextSnapshot = serializeHealerContext(ctx);\n   await writeHealerSnapshot(sessionId, contextSnapshot);\n   ```\n\n2. **Persist each spell result immediately:**\n   ```typescript\n   // After each spell\n   const spellResult = yield* executeSpell(spellId, ctx);\n   await appendSpellResult(sessionId, spellId, spellResult);\n   ```\n\n3. **On recovery, replay from persisted state:**\n   ```typescript\n   // On Healer start\n   const snapshot = await loadHealerSnapshot(sessionId);\n   if (snapshot) {\n     // Skip spells that already succeeded\n     const completedSpells = snapshot.spellResults\n       .filter(r => r.success)\n       .map(r => r.spellId);\n     spells = spells.filter(s => !completedSpells.includes(s));\n   }\n   ```\n\n4. **Integrate with ATIF:**\n   - Healer trajectory becomes both observability AND recovery source\n   - `HealerEventCollector` writes events to disk as they happen (not just at end)\n   - Recovery loads trajectory and replays\n\n## Files to Create/Modify\n\n- `src/healer/snapshot.ts` (new) - Snapshot persistence helpers\n- `src/healer/replay.ts` (new) - Replay logic\n- `src/healer/service.ts` - Integrate snapshot/replay\n- `src/healer/atif.ts` - Support incremental trajectory persistence\n\n## Acceptance Criteria\n\n- [ ] HealerContext is persisted before spell execution\n- [ ] Spell results are persisted immediately after completion\n- [ ] Healer can resume from persisted state after crash\n- [ ] Completed spells are not re-executed on replay\n- [ ] ATIF trajectory serves dual purpose (observability + recovery)","status":"open","priority":3,"type":"feature","labels":["healer","atif","replay","resilience"],"deps":[{"id":"oa-850dd5","type":"parent-child"}],"commits":[],"comments":[],"createdAt":"2025-12-04T17:18:46.641Z","updatedAt":"2025-12-04T22:03:40.002Z","closedAt":null}
{"id":"oa-26fa00","title":"Document local vs remote context for subagent operations","description":"## Background\n\nIn durable execution systems, there's an important distinction between:\n\n- **Local-context operations**: Database queries, file I/O, bash commands. The calling function must stay active because these operations run in-process.\n\n- **Remote-context operations**: Calls to other durable functions, external services, timers. The caller can \"suspend\" because work continues independently elsewhere.\n\nThis distinction explains why some operations in OpenAgents can naturally resume (Claude Code sessions) while others cannot (bash commands mid-execution).\n\n## Current State in OpenAgents\n\n**Local-context (cannot suspend mid-operation):**\n- `bashTool` - Shell commands run synchronously\n- `readTool`, `writeTool`, `editTool` - File operations\n- `runVerification` - Test/typecheck execution\n- Healer spells like `rewind_uncommitted_changes`\n\n**Remote-context (can suspend/resume):**\n- Claude Code subagent invocations (have `sessionId` for resumption)\n- Potentially: external API calls with idempotency keys\n\n## Task\n\nCreate documentation explaining this architectural pattern:\n\n1. **Add section to `docs/subagents/README.md`** or create `docs/architecture/execution-context.md`:\n   - Explain local vs remote context distinction\n   - List which OpenAgents operations fall into each category\n   - Explain why Claude Code can resume but bash cannot\n   - Document implications for error handling and recovery\n\n2. **Add code comments** in key files:\n   - `src/agent/orchestrator/subagent-router.ts` - Note that this is a \"remote-context\" call\n   - `src/healer/spells/*.ts` - Note that spells are \"local-context\"\n   - `src/tools/bash.ts` - Note that bash is local-context, cannot suspend\n\n3. **Update Healer spec** (`docs/subagents/healer.md`):\n   - Explain that spells are local-context operations\n   - This is why spell idempotency is critical (no automatic replay)\n\n## Acceptance Criteria\n\n- [ ] Documentation explains local vs remote context pattern\n- [ ] Key files have clarifying comments\n- [ ] Developers understand why some ops can resume and others cannot","status":"closed","priority":4,"type":"task","labels":["docs","architecture","subagents"],"deps":[{"id":"oa-850dd5","type":"parent-child"}],"commits":["4eca89f2a4487d909109684fa2ea41704282ca41"],"comments":[],"createdAt":"2025-12-04T17:18:48.101Z","updatedAt":"2025-12-05T01:08:43.336Z","closedAt":"2025-12-05T01:08:43.336Z","closeReason":"Documented local vs remote context and added comments"}
{"id":"oa-5b3d83","title":"Fix commit/task-update race condition with two-phase commit","description":"## Problem\n\nThere is a race condition in the orchestrator between creating a commit and updating the task status. If the orchestrator crashes in this window, the system is left in an inconsistent state.\n\nFrom `src/agent/orchestrator/orchestrator.ts` (around line 800-834):\n\n```typescript\n// Phase 6: Commit\nconst sha = yield* createCommit(taskId, commitMessage, config.cwd);\nemit({ type: \"commit_created\", sha, message: commitMessage });\n\n// [CRASH WINDOW] - If crash occurs here:\n// - Commit exists in git history\n// - Task is still \"in_progress\" in tasks.jsonl\n// - On restart, orchestrator might try to work on task again\n\n// Phase 7: Push\nyield* pushToRemote(branch, config.cwd);\n\n// Phase 8: Update Task\nyield* updateTask({ tasksPath, id: taskResult.id, update: { status: \"closed\" }});\n```\n\n**Failure scenario:**\n1. Orchestrator creates commit with SHA `abc123`\n2. Crash before task update\n3. On restart, task is still `in_progress`\n4. Orchestrator picks up task, does more work, creates another commit\n5. Result: duplicate work, confusing git history\n\n## Solution: Two-Phase Commit Pattern\n\nImplement a two-phase commit with idempotency checking:\n\n### Phase 1: Mark commit pending\n\n```typescript\n// Before creating commit, record intent\nyield* updateTask({\n  tasksPath,\n  id: taskId,\n  update: {\n    status: \"commit_pending\",  // New status\n    pendingCommit: {\n      expectedSha: null,  // Will be filled after commit\n      message: commitMessage,\n      timestamp: new Date().toISOString()\n    }\n  }\n});\n```\n\n### Phase 2: Create commit and verify\n\n```typescript\nconst sha = yield* createCommit(taskId, commitMessage, config.cwd);\n\n// Verify commit matches expectation\nyield* updateTask({\n  tasksPath,\n  id: taskId,\n  update: {\n    status: \"closed\",\n    pendingCommit: null,\n    commits: [...existingCommits, sha]\n  }\n});\n```\n\n### Recovery logic on startup\n\n```typescript\n// In orchestrator initialization\nconst pendingTasks = yield* findTasksWithStatus(\"commit_pending\");\nfor (const task of pendingTasks) {\n  // Check if commit actually exists\n  const commitExists = yield* checkCommitExists(task.pendingCommit.expectedSha);\n  if (commitExists) {\n    // Commit succeeded, just update status\n    yield* updateTask({ id: task.id, status: \"closed\" });\n  } else {\n    // Commit failed, reset to in_progress for retry\n    yield* updateTask({ id: task.id, status: \"in_progress\", pendingCommit: null });\n  }\n}\n```\n\n## Implementation Details\n\n1. **Add new task status**: Add `\"commit_pending\"` to the TaskStatus union in `src/tasks/schema.ts`\n\n2. **Add pendingCommit field**: Optional field on Task schema for tracking commit intent\n\n3. **Update orchestrator phases**: Wrap commit/push/update in two-phase pattern\n\n4. **Add recovery check**: On orchestrator startup, check for and resolve pending commits\n\n5. **Handle push separately**: Push is idempotent (pushing same SHA twice is fine), so it can remain outside the transaction\n\n## Files to Modify\n\n- `src/tasks/schema.ts` - Add `commit_pending` status, `pendingCommit` field\n- `src/agent/orchestrator/orchestrator.ts` - Implement two-phase commit\n- `src/agent/orchestrator/recovery.ts` (new) - Recovery logic for pending commits\n- `src/tasks/service.ts` - Add `findTasksWithStatus()` helper\n\n## Acceptance Criteria\n\n- [ ] Crash between commit and task update leaves system in recoverable state\n- [ ] On restart, pending commits are detected and resolved\n- [ ] No duplicate commits created on crash recovery\n- [ ] Tests simulate crash scenarios and verify recovery","status":"closed","priority":0,"type":"bug","labels":["orchestrator","idempotency","critical"],"deps":[{"id":"oa-850dd5","type":"parent-child"}],"commits":["053f6d4e4585b24fb92e543ac6cbeb09999add06"],"comments":[],"createdAt":"2025-12-04T17:38:34.890Z","updatedAt":"2025-12-04T22:03:53.166Z","closedAt":"2025-12-04T18:04:52.016Z","closeReason":"Implemented two-phase commit pattern with recovery"}
{"id":"oa-254afa","title":"Add orchestrator phase checkpoints for crash recovery","description":"## Background\n\nThe Golden Loop orchestrator executes multiple phases:\n```\nOrient → Select Task → Decompose → Execute Subtasks → Verify → Commit → Update → Log\n```\n\nCurrently, if the orchestrator crashes mid-execution, it must restart from the beginning. There's no mechanism to resume from the last successful phase.\n\nIn durable execution systems (Temporal, Restate, DBOS), workflows persist state at key points (\"checkpoints\") so they can resume from the last checkpoint after a crash.\n\n## Current State\n\nSome state IS persisted:\n- `progress.md` - Human-readable session summary\n- `.openagents/subtasks/{taskId}.json` - Subtask status\n- Claude Code `sessionId` - For LLM conversation resumption\n\nBut there's no formal checkpoint that captures:\n- Current orchestrator phase\n- Task being worked on\n- Git state at checkpoint time\n- Verification results\n\n## Proposed Solution\n\n### Checkpoint Schema\n\n```typescript\n// src/agent/orchestrator/checkpoint.ts\ninterface OrchestratorCheckpoint {\n  version: 1;\n  sessionId: string;\n  timestamp: string;\n  \n  // Current position in workflow\n  phase: OrchestratorPhase;\n  phaseStartedAt: string;\n  \n  // Task context\n  taskId: string;\n  taskTitle: string;\n  \n  // Subtask progress\n  completedSubtaskIds: string[];\n  currentSubtaskId: string | null;\n  \n  // Git state\n  git: {\n    branch: string;\n    headCommit: string;\n    isDirty: boolean;\n    stagedFiles: string[];\n  };\n  \n  // Verification results (if past verify phase)\n  verification?: {\n    typecheckPassed: boolean;\n    testsPassed: boolean;\n    verifiedAt: string;\n  };\n  \n  // Healer invocations in this session\n  healerInvocations: Array<{\n    scenario: string;\n    outcome: string;\n    timestamp: string;\n  }>;\n}\n\ntype OrchestratorPhase = \n  | \"init\"\n  | \"orient\"\n  | \"select_task\"\n  | \"decompose\"\n  | \"execute_subtasks\"\n  | \"verify\"\n  | \"commit\"\n  | \"update_task\"\n  | \"log\"\n  | \"complete\";\n```\n\n### Checkpoint Persistence\n\n```typescript\n// Write checkpoint at each phase transition\nconst writeCheckpoint = (checkpoint: OrchestratorCheckpoint) =>\n  Effect.gen(function* () {\n    const path = `${config.cwd}/.openagents/checkpoint.json`;\n    const tempPath = `${path}.tmp`;\n    \n    // Atomic write: write to temp, then rename\n    yield* fs.writeFileString(tempPath, JSON.stringify(checkpoint, null, 2));\n    yield* fs.rename(tempPath, path);\n  });\n\n// Clear checkpoint on successful completion\nconst clearCheckpoint = () =>\n  Effect.gen(function* () {\n    const path = `${config.cwd}/.openagents/checkpoint.json`;\n    yield* fs.remove(path).pipe(Effect.ignore);\n  });\n```\n\n### Recovery on Startup\n\n```typescript\n// In orchestrator initialization\nconst maybeResume = Effect.gen(function* () {\n  const checkpointPath = `${config.cwd}/.openagents/checkpoint.json`;\n  \n  const checkpointExists = yield* fs.exists(checkpointPath);\n  if (!checkpointExists) return Option.none();\n  \n  const checkpoint = yield* fs.readFileString(checkpointPath)\n    .pipe(Effect.map(JSON.parse));\n  \n  // Validate checkpoint is recent (within last 24 hours)\n  const age = Date.now() - new Date(checkpoint.timestamp).getTime();\n  if (age > 24 * 60 * 60 * 1000) {\n    yield* clearCheckpoint();\n    return Option.none();\n  }\n  \n  // Offer to resume\n  return Option.some(checkpoint);\n});\n```\n\n### Phase-Specific Resume Logic\n\n```typescript\nconst resumeFromCheckpoint = (checkpoint: OrchestratorCheckpoint) =>\n  Effect.gen(function* () {\n    switch (checkpoint.phase) {\n      case \"execute_subtasks\":\n        // Skip completed subtasks, resume from current\n        return yield* executeSubtasksFromCheckpoint(checkpoint);\n        \n      case \"verify\":\n        // Re-run verification (it's idempotent)\n        return yield* runVerificationPhase(checkpoint.taskId);\n        \n      case \"commit\":\n        // Check if commit exists, skip if so\n        return yield* resumeCommitPhase(checkpoint);\n        \n      // ... other phases\n    }\n  });\n```\n\n## Implementation Plan\n\n1. **Define checkpoint schema** in new `src/agent/orchestrator/checkpoint.ts`\n\n2. **Add checkpoint writes** at each phase transition in `orchestrator.ts`:\n   - After `orient` completes\n   - After `select_task` returns task\n   - After `decompose` creates subtasks\n   - After each subtask completes\n   - After `verify` completes\n   - After `commit` (covered by separate task)\n   - After `update_task`\n\n3. **Add recovery logic** in orchestrator startup:\n   - Check for existing checkpoint\n   - Validate checkpoint (age, git state match)\n   - Resume from appropriate phase\n\n4. **Add checkpoint cleanup** on successful completion\n\n5. **Add tests** for checkpoint persistence and recovery\n\n## Files to Create/Modify\n\n- `src/agent/orchestrator/checkpoint.ts` (new) - Checkpoint types and helpers\n- `src/agent/orchestrator/orchestrator.ts` - Add checkpoint writes and recovery\n- `src/agent/orchestrator/types.ts` - OrchestratorPhase type\n- `src/agent/orchestrator/__tests__/checkpoint.test.ts` (new) - Tests\n\n## Acceptance Criteria\n\n- [ ] Checkpoint written at each phase transition\n- [ ] Checkpoint uses atomic write (temp file + rename)\n- [ ] Recovery detects and validates existing checkpoints\n- [ ] Orchestrator can resume from checkpoint after crash\n- [ ] Completed subtasks are not re-executed\n- [ ] Checkpoint cleared on successful completion\n- [ ] Stale checkpoints (>24h) are discarded\n- [ ] Tests verify recovery from each phase","status":"closed","priority":1,"type":"feature","labels":["orchestrator","checkpoints","resilience"],"deps":[{"id":"oa-850dd5","type":"parent-child"}],"commits":["ca4aeb106"],"comments":[],"createdAt":"2025-12-04T17:38:37.214Z","updatedAt":"2025-12-04T22:03:53.857Z","closedAt":"2025-12-04T21:41:36.922Z","closeReason":"Checkpoint crash recovery implemented and pushed - commits ca4aeb106, fe2bbee40","pendingCommit":{"message":"Add orchestrator phase checkpoints for crash recovery","timestamp":"2025-12-04T21:34:12.075Z","branch":"agent/oa-254afa"}}
{"id":"oa-59c504","title":"Add idempotency keys to usage record storage","description":"## Problem\n\nThe usage record storage in `src/usage/store.ts` appends records without checking for duplicates. If the orchestrator crashes after appending a usage record but before completing the session, restart could append the same record again.\n\nFrom `orchestrator.ts:264`:\n```typescript\nreturn appendUsageRecord({ rootDir: config.cwd, record });\n```\n\n**Failure scenario:**\n1. Orchestrator completes subtask, appends usage record for tokens used\n2. Crash before session completion\n3. On restart, orchestrator replays and appends same usage record\n4. Result: inflated token/cost accounting\n\n## Solution: Idempotency Keys\n\nAdd an idempotency key to each usage record and check before appending.\n\n### Record Schema Update\n\n```typescript\n// src/usage/schema.ts\ninterface UsageRecord {\n  // Existing fields\n  timestamp: string;\n  taskId: string;\n  subtaskId?: string;\n  provider: string;\n  model: string;\n  promptTokens: number;\n  completionTokens: number;\n  totalTokens: number;\n  costUsd?: number;\n  \n  // New: Idempotency key\n  idempotencyKey: string;  // e.g., `${sessionId}:${subtaskId}:${stepIndex}`\n}\n```\n\n### Idempotency Key Generation\n\n```typescript\n// Generate deterministic key for each usage event\nconst generateIdempotencyKey = (params: {\n  sessionId: string;\n  subtaskId?: string;\n  stepIndex: number;\n  timestamp: string;\n}): string => {\n  const base = `${params.sessionId}:${params.subtaskId ?? 'main'}:${params.stepIndex}`;\n  // Add timestamp prefix for easy debugging\n  return `${params.timestamp.slice(0, 10)}:${base}`;\n};\n```\n\n### Deduplication on Append\n\n```typescript\n// src/usage/store.ts\nconst appendUsageRecord = (params: {\n  rootDir: string;\n  record: UsageRecord;\n}) => Effect.gen(function* () {\n  const storePath = `${params.rootDir}/.openagents/usage.jsonl`;\n  \n  // Check if record with this key already exists\n  const existingRecords = yield* loadUsageRecords(storePath);\n  const isDuplicate = existingRecords.some(\n    r => r.idempotencyKey === params.record.idempotencyKey\n  );\n  \n  if (isDuplicate) {\n    // Skip silently - this is expected on recovery\n    return { appended: false, reason: \"duplicate\" };\n  }\n  \n  // Append new record\n  yield* appendToJsonl(storePath, params.record);\n  return { appended: true };\n});\n```\n\n### Optimized Deduplication (for large files)\n\nFor repos with many usage records, loading all to check is expensive. Use a bloom filter or recent-records cache:\n\n```typescript\n// Keep last N idempotency keys in memory\nconst recentKeys = new Set<string>();\nconst MAX_RECENT_KEYS = 1000;\n\nconst checkDuplicate = (key: string, storePath: string) =>\n  Effect.gen(function* () {\n    // Fast path: check in-memory cache\n    if (recentKeys.has(key)) return true;\n    \n    // Slow path: check last 100 lines of file\n    const recentRecords = yield* readLastNLines(storePath, 100);\n    return recentRecords.some(r => r.idempotencyKey === key);\n  });\n```\n\n## Files to Modify\n\n- `src/usage/schema.ts` - Add idempotencyKey field\n- `src/usage/store.ts` - Add deduplication logic\n- `src/agent/orchestrator/orchestrator.ts` - Generate idempotency keys for usage records\n- `src/usage/__tests__/store.test.ts` - Test deduplication\n\n## Acceptance Criteria\n\n- [ ] Usage records include idempotencyKey field\n- [ ] Duplicate records (same key) are not appended\n- [ ] Idempotency check is efficient for large usage files\n- [ ] Tests verify deduplication behavior\n- [ ] Existing usage files without keys continue to work (backwards compatible)","status":"closed","priority":1,"type":"bug","labels":["usage","idempotency"],"deps":[{"id":"oa-850dd5","type":"parent-child"}],"commits":["092dadb01"],"comments":[],"createdAt":"2025-12-04T17:38:39.830Z","updatedAt":"2025-12-04T22:03:54.084Z","closedAt":"2025-12-04T19:44:57.877Z","closeReason":"Added idempotency keys for usage records"}
{"id":"oa-5df6be","title":"Add step result memoization for non-deterministic orchestrator operations","description":"## Background\n\nIn durable execution systems, recovery works by \"replaying\" from the beginning but using memoized results for completed steps. This ensures deterministic control flow even when operations have non-deterministic outputs.\n\nCurrently, MechaCoder's orchestrator has several operations whose results vary between runs:\n\n| Operation | Why Non-Deterministic | Current Behavior |\n|-----------|----------------------|------------------|\n| `runInitScript()` | Git status, test results change | Re-runs on restart |\n| `pickNextTask()` | Task status can change | Re-queries on restart |\n| `decomposeTask()` | LLM output varies | Re-generates subtasks |\n| `buildHealerContext()` | Error output, git state | Re-builds context |\n\nIf the orchestrator crashes and restarts, these operations may return different results, leading to different execution paths.\n\n## Problem Example\n\n1. Orchestrator runs, `pickNextTask()` returns task A\n2. Orchestrator works on task A, crashes mid-subtask\n3. Meanwhile, another process closes task A\n4. Orchestrator restarts, `pickNextTask()` returns task B\n5. Result: Task A left half-done, task B started\n\n## Proposed Solution: Step Result Memoization\n\nStore results of non-deterministic \"steps\" and replay them on recovery.\n\n### Step Result Schema\n\n```typescript\n// src/agent/orchestrator/step-results.ts\ninterface StepResult {\n  stepId: string;           // e.g., \"select_task\", \"decompose\", \"init_script\"\n  sessionId: string;        // Links to orchestrator session\n  timestamp: string;\n  result: unknown;          // The memoized result\n  inputHash?: string;       // Optional: hash of inputs for validation\n}\n\ninterface StepResultStore {\n  sessionId: string;\n  steps: StepResult[];\n}\n```\n\n### Step Wrapper\n\n```typescript\n// Wrap non-deterministic operations\nconst durableStep = <A>(\n  stepId: string,\n  operation: () => Effect.Effect<A, Error, R>\n) => Effect.gen(function* () {\n  // Check for memoized result\n  const memoized = yield* getMemoizedResult<A>(sessionId, stepId);\n  if (Option.isSome(memoized)) {\n    emit({ type: \"step_replayed\", stepId });\n    return memoized.value;\n  }\n  \n  // Execute and memoize\n  const result = yield* operation();\n  yield* memoizeResult(sessionId, stepId, result);\n  emit({ type: \"step_executed\", stepId });\n  return result;\n});\n```\n\n### Usage in Orchestrator\n\n```typescript\n// Before (non-deterministic)\nconst task = yield* pickNextTask(tasksPath);\n\n// After (durable)\nconst task = yield* durableStep(\"select_task\", () => \n  pickNextTask(tasksPath)\n);\n```\n\n### Storage Location\n\nStore in `.openagents/step-results.json` alongside checkpoint:\n\n```json\n{\n  \"sessionId\": \"sess-abc123\",\n  \"steps\": [\n    {\n      \"stepId\": \"select_task\",\n      \"timestamp\": \"2025-12-04T10:00:00Z\",\n      \"result\": { \"id\": \"oa-task1\", \"title\": \"...\" }\n    },\n    {\n      \"stepId\": \"decompose\",\n      \"timestamp\": \"2025-12-04T10:01:00Z\",\n      \"result\": [\n        { \"id\": \"sub-1\", \"description\": \"...\" },\n        { \"id\": \"sub-2\", \"description\": \"...\" }\n      ]\n    }\n  ]\n}\n```\n\n### Replay Mode\n\nOn recovery with existing checkpoint:\n\n```typescript\nconst maybeReplay = Effect.gen(function* () {\n  const stepResults = yield* loadStepResults(sessionId);\n  if (stepResults.length > 0) {\n    // Enter replay mode - durableStep will use memoized results\n    yield* setReplayMode(true, stepResults);\n  }\n});\n```\n\n## Which Steps to Memoize\n\n| Step | Should Memoize? | Reason |\n|------|-----------------|--------|\n| `runInitScript` | Yes | Different output on restart |\n| `pickNextTask` | Yes | Task state changes |\n| `decomposeTask` | Yes | LLM non-determinism |\n| `runVerification` | No | Want fresh test results |\n| `createCommit` | No | Different SHA each time (covered by two-phase) |\n| `buildHealerContext` | Yes | State-dependent |\n\n## Implementation Plan\n\n1. Create `src/agent/orchestrator/step-results.ts` with schema and helpers\n2. Add `durableStep` wrapper function\n3. Wrap key orchestrator operations with `durableStep`\n4. Add replay mode detection in orchestrator startup\n5. Clear step results on session completion\n6. Add tests for memoization and replay\n\n## Files to Create/Modify\n\n- `src/agent/orchestrator/step-results.ts` (new) - Step result types and storage\n- `src/agent/orchestrator/durable.ts` (new) - durableStep wrapper\n- `src/agent/orchestrator/orchestrator.ts` - Wrap non-deterministic operations\n- `src/agent/orchestrator/__tests__/step-results.test.ts` (new) - Tests\n\n## Acceptance Criteria\n\n- [ ] Non-deterministic operations wrapped with durableStep\n- [ ] Step results persisted to .openagents/step-results.json\n- [ ] On recovery, memoized results are used instead of re-executing\n- [ ] Replay mode correctly identifies which steps to replay\n- [ ] Step results cleared on successful session completion\n- [ ] Tests verify memoization and replay behavior","status":"closed","priority":2,"type":"feature","labels":["orchestrator","replay","memoization"],"deps":[{"id":"oa-850dd5","type":"parent-child"}],"commits":["76539bd6f049581d79fa69c76734d4a4762c8c0d"],"comments":[],"createdAt":"2025-12-04T17:40:06.299Z","updatedAt":"2025-12-05T00:29:27.619Z","closedAt":"2025-12-05T00:29:27.619Z","closeReason":"Implemented step result memoization persistence and cleanup"}
{"id":"oa-a1d5b1","title":"Extend ATIF trajectories to support recovery replay","description":"## Background\n\nThe ATIF (Agent Trajectory Interchange Format) schema in `src/atif/schema.ts` captures complete execution history:\n- Every step with timestamps\n- Tool calls and results\n- Metrics (tokens, cost)\n- Subagent references\n\nCurrently, ATIF trajectories are created AFTER execution for observability and debugging. However, the trajectory format is very close to what's needed for replay-based recovery.\n\nIn durable execution systems, the execution log serves dual purposes:\n1. **Observability**: Understanding what happened\n2. **Recovery**: Replaying to restore state\n\n## Current ATIF Schema (Relevant Parts)\n\n```typescript\nconst Step = S.Struct({\n  step_id: S.Number,\n  timestamp: S.String,\n  source: StepSource,  // \"user\" | \"agent\" | \"system\"\n  message: S.Unknown,\n  tool_calls: S.optional(S.Array(ToolCall)),\n  observation: S.optional(Observation),  // Tool results\n  metrics: S.optional(Metrics),\n});\n\nconst Trajectory = S.Struct({\n  schema_version: S.Literal(ATIF_SCHEMA_VERSION),\n  session_id: S.String,\n  agent: Agent,\n  steps: S.Array(Step),\n  final_metrics: S.optional(FinalMetrics),\n});\n```\n\n## Proposed Extensions for Recovery\n\n### 1. Add Step Status\n\n```typescript\nconst StepStatus = S.Literal(\n  \"pending\",      // Not yet executed\n  \"executing\",    // Currently running\n  \"completed\",    // Finished successfully\n  \"failed\",       // Failed with error\n  \"replayed\"      // Restored from previous execution\n);\n\nconst Step = S.Struct({\n  // ... existing fields\n  status: S.optional(StepStatus),\n  completed_at: S.optional(S.String),\n  error: S.optional(S.String),\n});\n```\n\n### 2. Add Checkpoint Markers\n\n```typescript\nconst CheckpointMarker = S.Struct({\n  checkpoint_id: S.String,\n  phase: S.String,\n  timestamp: S.String,\n  resumable: S.Boolean,\n});\n\nconst Trajectory = S.Struct({\n  // ... existing fields\n  checkpoints: S.optional(S.Array(CheckpointMarker)),\n  recovery_info: S.optional(S.Struct({\n    recovered_from_session: S.optional(S.String),\n    recovered_at_step: S.optional(S.Number),\n    recovery_timestamp: S.optional(S.String),\n  })),\n});\n```\n\n### 3. Incremental Persistence\n\nCurrent: Trajectory written after execution completes\nNeeded: Steps written as they execute\n\n```typescript\n// src/atif/incremental.ts\nconst appendStep = (sessionId: string, step: Step) =>\n  Effect.gen(function* () {\n    const path = trajectoryPath(sessionId);\n    const trajectory = yield* loadOrCreateTrajectory(sessionId);\n    trajectory.steps.push(step);\n    yield* writeTrajectory(path, trajectory);\n  });\n\n// Called after each orchestrator step\nyield* appendStep(sessionId, {\n  step_id: nextStepId(),\n  timestamp: timestamp(),\n  source: \"agent\",\n  message: \"Executing subtask: implement-feature\",\n  tool_calls: [...],\n  status: \"executing\",\n});\n```\n\n### 4. Recovery from Trajectory\n\n```typescript\n// src/atif/recovery.ts\nconst recoverFromTrajectory = (sessionId: string) =>\n  Effect.gen(function* () {\n    const trajectory = yield* loadTrajectory(sessionId);\n    \n    // Find last completed checkpoint\n    const lastCheckpoint = trajectory.checkpoints\n      ?.filter(c => c.resumable)\n      .sort((a, b) => b.timestamp.localeCompare(a.timestamp))[0];\n    \n    if (!lastCheckpoint) {\n      return { canRecover: false, reason: \"No resumable checkpoint\" };\n    }\n    \n    // Find steps after checkpoint\n    const checkpointStep = trajectory.steps.find(\n      s => s.extra?.checkpoint_id === lastCheckpoint.checkpoint_id\n    );\n    \n    // Mark incomplete steps for replay\n    const stepsToReplay = trajectory.steps\n      .filter(s => s.step_id > checkpointStep.step_id)\n      .filter(s => s.status !== \"completed\");\n    \n    return {\n      canRecover: true,\n      checkpoint: lastCheckpoint,\n      stepsToReplay,\n      completedSteps: trajectory.steps.filter(s => s.status === \"completed\"),\n    };\n  });\n```\n\n## Integration with Orchestrator\n\n```typescript\n// In orchestrator.ts\nconst runWithTrajectory = Effect.gen(function* () {\n  const sessionId = generateSessionId();\n  \n  // Check for existing trajectory to recover from\n  const recovery = yield* recoverFromTrajectory(sessionId);\n  if (recovery.canRecover) {\n    emit({ type: \"recovering\", checkpoint: recovery.checkpoint });\n    // Load completed step results for replay\n    yield* loadCompletedStepsForReplay(recovery.completedSteps);\n  }\n  \n  // Run orchestrator phases, appending to trajectory\n  for (const phase of phases) {\n    yield* appendStep(sessionId, { ...phaseStartStep });\n    const result = yield* runPhase(phase);\n    yield* appendStep(sessionId, { ...phaseCompleteStep, status: \"completed\" });\n    \n    // Write checkpoint after key phases\n    if (isCheckpointPhase(phase)) {\n      yield* appendCheckpoint(sessionId, phase);\n    }\n  }\n});\n```\n\n## Benefits\n\n1. **Single source of truth**: Trajectory is both log and recovery state\n2. **Full audit trail**: Every step captured with timing\n3. **Debugging**: Can see exactly where recovery started\n4. **ML training**: Trajectories already in ATIF format for fine-tuning\n\n## Files to Modify\n\n- `src/atif/schema.ts` - Add status, checkpoint fields\n- `src/atif/incremental.ts` (new) - Incremental write helpers\n- `src/atif/recovery.ts` (new) - Recovery logic\n- `src/agent/orchestrator/orchestrator.ts` - Integrate trajectory-based recovery\n- `src/atif/__tests__/recovery.test.ts` (new) - Tests\n\n## Acceptance Criteria\n\n- [ ] ATIF schema extended with step status and checkpoint markers\n- [ ] Steps written incrementally during execution\n- [ ] Recovery can load trajectory and identify resume point\n- [ ] Completed steps are replayed (not re-executed)\n- [ ] New trajectory includes recovery_info when recovered\n- [ ] Tests verify trajectory-based recovery","status":"closed","priority":2,"type":"feature","labels":["atif","replay","recovery"],"deps":[{"id":"oa-850dd5","type":"parent-child"}],"commits":["bb9bb19a8d3af19a2dc9d7d8371e62cf5093a872","476e0f85d"],"comments":[],"createdAt":"2025-12-04T17:40:08.705Z","updatedAt":"2025-12-05T00:42:47.108Z","closedAt":"2025-12-05T00:42:47.108Z","closeReason":"Added ATIF recovery metadata, incremental persistence helpers, and replay planning tests"}
{"id":"oa-013645","title":"Add durable coordination for parallel runner worktree merges","description":"## Background\n\nThe parallel runner (`mechacoder:parallel`) spawns multiple orchestrators in isolated worktrees:\n\n```\n.worktrees/oa-task1/  ← Agent 1 working here\n.worktrees/oa-task2/  ← Agent 2 working here\n.worktrees/oa-task3/  ← Agent 3 working here\n```\n\nAfter agents complete, their changes are merged to main sequentially. Currently, this coordination happens in memory - if the parent process crashes, the merge state is lost.\n\n## Problem Scenarios\n\n### Scenario 1: Crash during merge sequence\n\n1. Agent 1 completes, merge to main succeeds\n2. Agent 2 completes, merge in progress\n3. Parent process crashes\n4. On restart: unclear which agents completed, which merged\n\n### Scenario 2: Partial batch completion\n\n1. Batch of 4 agents started\n2. Agents 1, 2 complete successfully\n3. Agent 3 fails\n4. Agent 4 still running\n5. Parent crashes\n6. On restart: should resume agent 4? retry agent 3? merge 1,2?\n\n## Proposed Solution: Durable Coordination State\n\n### Coordination Schema\n\n```typescript\n// src/agent/parallel/coordination.ts\ninterface ParallelRunState {\n  runId: string;\n  startedAt: string;\n  config: {\n    maxAgents: number;\n    maxTasks: number;\n    targetDir: string;\n  };\n  \n  // Batch tracking\n  batches: BatchState[];\n  currentBatchIndex: number;\n  \n  // Overall progress\n  tasksCompleted: number;\n  tasksFailed: number;\n  \n  // Merge queue\n  pendingMerges: MergeRequest[];\n  completedMerges: MergeResult[];\n}\n\ninterface BatchState {\n  batchIndex: number;\n  startedAt: string;\n  completedAt?: string;\n  \n  agents: AgentState[];\n}\n\ninterface AgentState {\n  taskId: string;\n  worktreePath: string;\n  status: \"pending\" | \"running\" | \"completed\" | \"failed\" | \"merged\";\n  \n  startedAt?: string;\n  completedAt?: string;\n  \n  // Commit info for merge\n  commitSha?: string;\n  branch?: string;\n  \n  error?: string;\n}\n\ninterface MergeRequest {\n  taskId: string;\n  worktreePath: string;\n  commitSha: string;\n  queuedAt: string;\n}\n\ninterface MergeResult {\n  taskId: string;\n  mergedAt: string;\n  mainCommitSha: string;\n  success: boolean;\n  error?: string;\n}\n```\n\n### Coordination File\n\nStore in `.openagents/parallel-run.json`:\n\n```json\n{\n  \"runId\": \"run-abc123\",\n  \"startedAt\": \"2025-12-04T22:00:00Z\",\n  \"config\": { \"maxAgents\": 4, \"maxTasks\": 50 },\n  \"batches\": [\n    {\n      \"batchIndex\": 0,\n      \"startedAt\": \"2025-12-04T22:00:00Z\",\n      \"completedAt\": \"2025-12-04T22:30:00Z\",\n      \"agents\": [\n        { \"taskId\": \"oa-task1\", \"status\": \"merged\", \"commitSha\": \"abc123\" },\n        { \"taskId\": \"oa-task2\", \"status\": \"merged\", \"commitSha\": \"def456\" }\n      ]\n    },\n    {\n      \"batchIndex\": 1,\n      \"startedAt\": \"2025-12-04T22:30:00Z\",\n      \"agents\": [\n        { \"taskId\": \"oa-task3\", \"status\": \"completed\", \"commitSha\": \"ghi789\" },\n        { \"taskId\": \"oa-task4\", \"status\": \"running\" }\n      ]\n    }\n  ],\n  \"currentBatchIndex\": 1,\n  \"tasksCompleted\": 2,\n  \"tasksFailed\": 0,\n  \"pendingMerges\": [\n    { \"taskId\": \"oa-task3\", \"commitSha\": \"ghi789\", \"queuedAt\": \"...\" }\n  ],\n  \"completedMerges\": [...]\n}\n```\n\n### Recovery Logic\n\n```typescript\n// src/agent/parallel/recovery.ts\nconst recoverParallelRun = Effect.gen(function* () {\n  const statePath = `${cwd}/.openagents/parallel-run.json`;\n  \n  const stateExists = yield* fs.exists(statePath);\n  if (!stateExists) return Option.none();\n  \n  const state = yield* loadParallelState(statePath);\n  \n  // 1. Process pending merges first\n  for (const merge of state.pendingMerges) {\n    yield* processMerge(merge);\n  }\n  \n  // 2. Check for running agents that may have completed\n  const currentBatch = state.batches[state.currentBatchIndex];\n  for (const agent of currentBatch.agents) {\n    if (agent.status === \"running\") {\n      // Check if worktree has commits\n      const hasCommits = yield* checkWorktreeForCommits(agent.worktreePath);\n      if (hasCommits) {\n        agent.status = \"completed\";\n        agent.commitSha = yield* getWorktreeHeadCommit(agent.worktreePath);\n        state.pendingMerges.push({ taskId: agent.taskId, ... });\n      }\n    }\n  }\n  \n  // 3. Save updated state\n  yield* saveParallelState(statePath, state);\n  \n  return Option.some(state);\n});\n```\n\n### Integration with Parallel Runner\n\n```typescript\n// In parallel.ts\nconst runParallel = Effect.gen(function* () {\n  // Check for existing run to recover\n  const existingState = yield* recoverParallelRun();\n  const state = Option.isSome(existingState) \n    ? existingState.value \n    : createNewParallelState(config);\n  \n  // Main loop with state persistence\n  while (state.tasksCompleted < config.maxTasks) {\n    // Start new batch\n    const batch = yield* startBatch(state);\n    yield* saveParallelState(state);\n    \n    // Wait for agents\n    const results = yield* awaitBatch(batch);\n    yield* updateBatchState(state, results);\n    yield* saveParallelState(state);\n    \n    // Process merges\n    yield* processPendingMerges(state);\n    yield* saveParallelState(state);\n  }\n  \n  // Cleanup on success\n  yield* clearParallelState();\n});\n```\n\n## Implementation Plan\n\n1. Define coordination schema in `src/agent/parallel/coordination.ts`\n2. Add state persistence helpers\n3. Add recovery logic in `src/agent/parallel/recovery.ts`\n4. Integrate with parallel runner\n5. Add merge queue processing\n6. Add cleanup on successful completion\n7. Add tests\n\n## Files to Create/Modify\n\n- `src/agent/parallel/coordination.ts` (new) - State schema and types\n- `src/agent/parallel/recovery.ts` (new) - Recovery logic\n- `src/agent/parallel.ts` - Integrate coordination state\n- `src/agent/parallel/__tests__/recovery.test.ts` (new) - Tests\n\n## Acceptance Criteria\n\n- [ ] Parallel run state persisted to .openagents/parallel-run.json\n- [ ] State updated after each significant operation\n- [ ] Recovery detects existing run and resumes\n- [ ] Pending merges processed on recovery\n- [ ] Running agents checked for completion on recovery\n- [ ] State cleared on successful run completion\n- [ ] Tests verify recovery scenarios","status":"closed","priority":2,"type":"feature","labels":["parallel","orchestrator","resilience"],"deps":[{"id":"oa-850dd5","type":"parent-child"}],"commits":["83cee3e4e306ec633a4b6c63e85fc9b1199121b6"],"comments":[],"createdAt":"2025-12-04T17:40:10.413Z","updatedAt":"2025-12-05T03:53:20.721Z","closedAt":"2025-12-05T03:53:20.721Z","closeReason":"Added durable parallel run state persistence and recovery"}
{"id":"oa-e0d9b0","title":"Model orchestrator as Effect saga with compensation","description":"## Background\n\nIn distributed systems, a \"saga\" is a pattern for managing long-running transactions that span multiple services or steps. Each step has a \"compensating action\" that can undo it if a later step fails.\n\nThe MechaCoder orchestrator is essentially a saga:\n- Multiple steps that must complete in sequence\n- Each step has side effects (file changes, commits, task updates)\n- If a late step fails, earlier steps may need to be undone\n\n## Current Architecture\n\nThe orchestrator runs phases sequentially:\n```\ninit → orient → select_task → decompose → execute_subtasks → verify → commit → update → log\n```\n\nIf `verify` fails after subtasks have made changes, there's no automatic rollback. The Healer attempts recovery, but it's reactive rather than built into the flow.\n\n## Saga Pattern\n\nEach step has:\n1. **Action**: The forward operation\n2. **Compensation**: How to undo if later steps fail\n\n```typescript\ninterface SagaStep<A, R> {\n  name: string;\n  action: () => Effect.Effect<A, Error, R>;\n  compensation: (result: A) => Effect.Effect<void, Error, R>;\n}\n```\n\n## Proposed Orchestrator as Saga\n\n```typescript\n// src/agent/orchestrator/saga.ts\nconst orchestratorSaga: SagaStep<unknown, OrchestratorEnv>[] = [\n  {\n    name: \"select_task\",\n    action: () => pickNextTask(tasksPath),\n    compensation: (task) => releaseTask(task.id),  // Mark back as open\n  },\n  {\n    name: \"decompose\",\n    action: () => decomposeTask(task),\n    compensation: (subtasks) => deleteSubtasksFile(task.id),\n  },\n  {\n    name: \"execute_subtasks\",\n    action: () => executeAllSubtasks(subtasks),\n    compensation: (results) => revertChanges(results),  // git checkout\n  },\n  {\n    name: \"verify\",\n    action: () => runVerification(),\n    compensation: () => Effect.void,  // No side effects to undo\n  },\n  {\n    name: \"commit\",\n    action: () => createCommit(message),\n    compensation: (sha) => resetToParent(sha),  // git reset HEAD~1\n  },\n  {\n    name: \"push\",\n    action: () => pushToRemote(),\n    compensation: () => Effect.void,  // Can't easily undo push\n  },\n  {\n    name: \"update_task\",\n    action: () => closeTask(taskId),\n    compensation: () => reopenTask(taskId),\n  },\n];\n```\n\n## Saga Executor\n\n```typescript\n// src/agent/orchestrator/saga-executor.ts\nconst runSaga = <R>(steps: SagaStep<unknown, R>[]) =>\n  Effect.gen(function* () {\n    const completed: Array<{ step: SagaStep<unknown, R>; result: unknown }> = [];\n    \n    for (const step of steps) {\n      try {\n        emit({ type: \"saga_step_start\", step: step.name });\n        const result = yield* step.action();\n        completed.push({ step, result });\n        emit({ type: \"saga_step_complete\", step: step.name });\n      } catch (error) {\n        emit({ type: \"saga_step_failed\", step: step.name, error });\n        \n        // Run compensations in reverse order\n        for (const { step: completedStep, result } of completed.reverse()) {\n          try {\n            emit({ type: \"saga_compensation_start\", step: completedStep.name });\n            yield* completedStep.compensation(result);\n            emit({ type: \"saga_compensation_complete\", step: completedStep.name });\n          } catch (compError) {\n            emit({ type: \"saga_compensation_failed\", step: completedStep.name, error: compError });\n            // Log but continue with other compensations\n          }\n        }\n        \n        return yield* Effect.fail(new SagaFailedError(step.name, error, completed));\n      }\n    }\n    \n    return completed.map(c => c.result);\n  });\n```\n\n## Benefits\n\n1. **Automatic rollback**: Failed steps trigger compensation\n2. **Clear transaction boundaries**: Each step's scope is explicit\n3. **Debuggable**: Can see exactly which compensations ran\n4. **Testable**: Can test individual steps and compensations\n\n## Compensation Examples\n\n### select_task compensation\n```typescript\ncompensation: (task) => \n  updateTask({ id: task.id, status: \"open\", assignee: null })\n```\n\n### execute_subtasks compensation\n```typescript\ncompensation: (results) => Effect.gen(function* () {\n  // Revert git changes\n  yield* runCommand(\"git checkout .\");\n  yield* runCommand(\"git clean -fd\");\n  // Mark subtasks as pending\n  for (const subtask of results.subtasks) {\n    yield* updateSubtask(subtask.id, { status: \"pending\" });\n  }\n})\n```\n\n### commit compensation\n```typescript\ncompensation: (sha) => Effect.gen(function* () {\n  // Only compensate if commit hasn't been pushed\n  const isPushed = yield* checkIfPushed(sha);\n  if (!isPushed) {\n    yield* runCommand(\"git reset --soft HEAD~1\");\n  }\n})\n```\n\n## Integration with Existing System\n\nThis would be a significant refactor. Recommend:\n1. Start with new `saga.ts` and `saga-executor.ts` modules\n2. Keep existing orchestrator working\n3. Add feature flag to use saga-based orchestrator\n4. Gradually migrate once saga approach is validated\n\n## Files to Create\n\n- `src/agent/orchestrator/saga.ts` - SagaStep type and orchestrator saga definition\n- `src/agent/orchestrator/saga-executor.ts` - runSaga implementation\n- `src/agent/orchestrator/compensations.ts` - Compensation action implementations\n- `src/agent/orchestrator/__tests__/saga.test.ts` - Tests\n\n## Acceptance Criteria\n\n- [ ] SagaStep type defined with action and compensation\n- [ ] Orchestrator phases modeled as saga steps\n- [ ] runSaga executor runs steps and compensates on failure\n- [ ] Compensations run in reverse order\n- [ ] Saga execution emits events for observability\n- [ ] Tests verify compensation behavior\n- [ ] Feature flag to enable saga-based orchestrator","status":"open","priority":3,"type":"feature","labels":["orchestrator","saga","architecture"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-04T17:40:59.330Z","updatedAt":"2025-12-04T17:40:59.330Z","closedAt":null}
{"id":"oa-850dd5","title":"Create epic: Durable execution patterns for MechaCoder","description":"## Overview\n\nThis epic tracks the implementation of durable execution patterns across MechaCoder, inspired by systems like Temporal, Restate, and DBOS.\n\nThe goal is to make MechaCoder more resilient to crashes and restarts by:\n1. Making operations idempotent\n2. Adding checkpoints for recovery\n3. Persisting step results for replay\n4. Using the saga pattern for automatic rollback\n\n## Background\n\nAnalysis of durable execution systems revealed several patterns applicable to MechaCoder:\n\n1. **Idempotency**: Side effects must be safe to retry\n2. **Checkpointing**: Save state at key points for recovery\n3. **Memoization**: Store step results to replay on recovery\n4. **Sagas**: Automatic compensation when steps fail\n5. **Durable promises**: Write-once containers that persist\n\n## Child Tasks\n\n### P0 - Critical\n- `oa-5b3d83` - Fix commit/task-update race condition with two-phase commit\n\n### P1 - High Priority\n- `oa-c3d1a1` - Make mark_task_blocked_with_followup spell idempotent\n- `oa-ebfdaa` - Make update_progress_with_guidance spell idempotent\n- `oa-254afa` - Add orchestrator phase checkpoints for crash recovery\n- `oa-59c504` - Add idempotency keys to usage record storage\n\n### P2 - Medium Priority\n- `oa-23428c` - Add Healer invocation deduplication in HealerService\n- `oa-5df6be` - Add step result memoization for non-deterministic operations\n- `oa-a1d5b1` - Extend ATIF trajectories to support recovery replay\n- `oa-013645` - Add durable coordination for parallel runner worktree merges\n\n### P3 - Lower Priority\n- `oa-4cce8f` - Add orchestrator checkpoints for crash recovery (Healer-specific)\n- `oa-c83546` - Add ATIF trajectory persistence for Healer replay\n- Saga pattern for orchestrator (this task)\n\n### P4 - Documentation\n- `oa-26fa00` - Document local vs remote context for subagent operations\n- Comprehensive durable execution lessons document (docs/research/)\n\n## Success Criteria\n\n- [ ] Orchestrator can recover from crash at any phase\n- [ ] No duplicate commits, tasks, or usage records after crash recovery\n- [ ] Healer spells are idempotent\n- [ ] Parallel runner can resume after coordinator crash\n- [ ] ATIF trajectories serve both observability and recovery\n- [ ] Architecture documented for future development\n\n## References\n\n- Jack Vanlightly's \"Demystifying Determinism in Durable Execution\"\n- Jack Vanlightly's \"The Durable Function Tree\"\n- Anthropic's \"Effective Harnesses for Long-Running Agents\"\n- docs/research/durable-execution-lessons.md (to be created)","status":"closed","priority":1,"type":"epic","labels":["architecture","resilience","durable-execution"],"deps":[],"commits":["93ddf8413ad7653fe89e5c3069673caa32ab8f31"],"comments":[],"createdAt":"2025-12-04T17:41:01.043Z","updatedAt":"2025-12-04T22:07:45.596Z","closedAt":"2025-12-04T22:07:45.596Z","closeReason":"Completed by MechaCoder parallel agent","pendingCommit":null}
{"id":"oa-827430","title":"Add RPC endpoints for TB run history in browser webview","description":"The mainview runs in a browser webview which cannot use Node.js fs APIs. Need to add RPC endpoints in the Electrobun main process to: 1) Load recent TB runs from .openagents/tb-runs/, 2) Load full run details (tasks) for expanded view. The mainview should call these via RPC instead of importing persistence.ts directly.","status":"closed","priority":2,"type":"feature","labels":["hud","rpc","terminal-bench"],"deps":[],"commits":["2a907632bdea7124861732e7fa3973fb79ffa927"],"comments":[],"createdAt":"2025-12-04T17:42:12.719Z","updatedAt":"2025-12-04T19:54:30.327Z","closedAt":"2025-12-04T19:54:30.327Z","closeReason":"Added RPC endpoints loadRecentTBRuns and loadTBRunDetails in src/bun/index.ts. Updated mainview to use RPC for loading TB run history and details."}
{"id":"oa-612af7","title":"Add in-app debug log pane with console capture","description":"Create a toggleable debug log pane in the HUD that captures and displays console.log/error/warn output. This avoids needing to open the browser dev tools console.\n\nImplementation:\n1. Override console.log/error/warn to capture logs into a buffer\n2. Forward to original console methods (so browser console still works)\n3. Create a collapsible pane UI (similar to Agent Output pane)\n4. Add keyboard shortcut to toggle visibility (e.g., Ctrl+` or F12)\n5. Color-code by log level (log=gray, warn=yellow, error=red)\n6. Auto-scroll to bottom, with scroll-lock option\n7. Clear button to reset buffer\n8. Max buffer size to prevent memory issues\n\nNice to have:\n- Filter by log level\n- Search/filter logs\n- Copy logs to clipboard\n- Timestamp display toggle","status":"open","priority":3,"type":"feature","labels":["hud","dx","debug"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-04T17:52:40.719Z","updatedAt":"2025-12-04T17:52:40.719Z","closedAt":null}
{"id":"oa-0b3bed","title":"Research: A-Mem: Agentic Memory for LLM Agents","description":"## Research Paper: A-Mem: Agentic Memory for LLM Agents\n\nFind and summarize this academic paper for the OpenAgents research collection.\n\n### Details\n- **Year:** 2025\n- **URLs:**\n  - https://arxiv.org/abs/2502.12110\n- **Priority:** HIGH\n- **Source:** docs/research/analysis/related-work-reflection.md\n\n### Output\nCreate a summary at `docs/research/paper-summaries/<slug>-summary.md` following the standard format.\n\n### Acceptance Criteria\n- [ ] Paper content retrieved (abstract and/or full text)\n- [ ] Summary follows voyager-summary.md template\n- [ ] Includes 'Relevance to MechaCoder' section\n- [ ] Citation in BibTeX format","status":"closed","priority":1,"type":"task","labels":["research","paper"],"deps":[],"commits":["a8c23347c65c91bc14638b5610925974eb268d93"],"comments":[],"createdAt":"2025-12-04T19:28:55.428Z","updatedAt":"2025-12-04T19:48:56.065Z","closedAt":"2025-12-04T19:48:56.065Z","closeReason":"Summary created at docs/research/paper-summaries/a-mem-summary.md"}
{"id":"oa-df2a15","title":"Research: Reflexion: Language Agents with Verbal Reinforcement Learning","description":"## Research Paper: Reflexion: Language Agents with Verbal Reinforcement Learning\n\nFind and summarize this academic paper for the OpenAgents research collection.\n\n### Details\n- **Year:** 2023\n- **URLs:**\n  - https://arxiv.org/abs/2303.11366\n- **Priority:** HIGH\n- **Source:** docs/research/analysis/related-work-reflection.md\n\n### Output\nCreate a summary at `docs/research/paper-summaries/<slug>-summary.md` following the standard format.\n\n### Acceptance Criteria\n- [ ] Paper content retrieved (abstract and/or full text)\n- [ ] Summary follows voyager-summary.md template\n- [ ] Includes 'Relevance to MechaCoder' section\n- [ ] Citation in BibTeX format","status":"closed","priority":1,"type":"task","labels":["research","paper"],"deps":[],"commits":["a8c23347c65c91bc14638b5610925974eb268d93"],"comments":[],"createdAt":"2025-12-04T19:28:55.468Z","updatedAt":"2025-12-04T19:48:57.704Z","closedAt":"2025-12-04T19:48:57.704Z","closeReason":"Summary created at docs/research/paper-summaries/reflexion-summary.md"}
{"id":"oa-e83ee7","title":"Research: Odyssey: Empowering Minecraft Agents","description":"## Research Paper: Odyssey: Empowering Minecraft Agents\n\nFind and summarize this academic paper for the OpenAgents research collection.\n\n### Details\n- **Year:** 2025\n- **URLs:**\n  - https://ijcai.org/proceedings/2025/0022.pdf\n- **Priority:** HIGH\n- **Source:** docs/research/analysis/related-work-reflection.md\n\n### Output\nCreate a summary at `docs/research/paper-summaries/<slug>-summary.md` following the standard format.\n\n### Acceptance Criteria\n- [ ] Paper content retrieved (abstract and/or full text)\n- [ ] Summary follows voyager-summary.md template\n- [ ] Includes 'Relevance to MechaCoder' section\n- [ ] Citation in BibTeX format","status":"closed","priority":1,"type":"task","labels":["research","paper"],"deps":[],"commits":["a8c23347c65c91bc14638b5610925974eb268d93"],"comments":[],"createdAt":"2025-12-04T19:28:55.480Z","updatedAt":"2025-12-04T19:48:58.944Z","closedAt":"2025-12-04T19:48:58.944Z","closeReason":"Summary created at docs/research/paper-summaries/odyssey-summary.md"}
{"id":"oa-5586bb","title":"Research: PLAP: Parameterized Skills for Planning","description":"## Research Paper: PLAP: Parameterized Skills for Planning\n\nFind and summarize this academic paper for the OpenAgents research collection.\n\n### Details\n- **Year:** 2025\n- **URLs:**\n  - https://arxiv.org/abs/2509.13127\n- **Priority:** HIGH\n- **Source:** docs/research/analysis/related-work-reflection.md\n\n### Output\nCreate a summary at `docs/research/paper-summaries/<slug>-summary.md` following the standard format.\n\n### Acceptance Criteria\n- [ ] Paper content retrieved (abstract and/or full text)\n- [ ] Summary follows voyager-summary.md template\n- [ ] Includes 'Relevance to MechaCoder' section\n- [ ] Citation in BibTeX format","status":"closed","priority":1,"type":"task","labels":["research","paper"],"deps":[],"commits":["a8c23347c65c91bc14638b5610925974eb268d93"],"comments":[],"createdAt":"2025-12-04T19:28:55.490Z","updatedAt":"2025-12-04T19:49:00.697Z","closedAt":"2025-12-04T19:49:00.697Z","closeReason":"Summary created at docs/research/paper-summaries/plap-summary.md"}
{"id":"oa-e67e26","title":"Research: Memory-of-Thought Prompting","description":"## Research Paper: Memory-of-Thought Prompting\n\nFind and summarize this academic paper for the OpenAgents research collection.\n\n### Details\n- **Year:** 2023\n- **URLs:**\n  - https://(need to find)\n- **Priority:** MEDIUM\n- **Source:** docs/research/analysis/related-work-reflection.md\n\n### Output\nCreate a summary at `docs/research/paper-summaries/<slug>-summary.md` following the standard format.\n\n### Acceptance Criteria\n- [ ] Paper content retrieved (abstract and/or full text)\n- [ ] Summary follows voyager-summary.md template\n- [ ] Includes 'Relevance to MechaCoder' section\n- [ ] Citation in BibTeX format","status":"closed","priority":2,"type":"task","labels":["research","paper"],"deps":[],"commits":["3d617620caba829eceff5e639a7ffc6048dba299"],"comments":[],"createdAt":"2025-12-04T19:28:55.500Z","updatedAt":"2025-12-05T00:54:18.679Z","closedAt":"2025-12-05T00:54:18.679Z","closeReason":"Added Memory-of-Thought summary"}
{"id":"oa-be64e5","title":"Research: R2-MGA","description":"## Research Paper: R2-MGA\n\nFind and summarize this academic paper for the OpenAgents research collection.\n\n### Details\n- **Year:** 2025\n- **URLs:**\n  - https://chatpaper.com/paper/161990\n- **Priority:** MEDIUM\n- **Source:** docs/research/analysis/related-work-reflection.md\n\n### Output\nCreate a summary at `docs/research/paper-summaries/<slug>-summary.md` following the standard format.\n\n### Acceptance Criteria\n- [ ] Paper content retrieved (abstract and/or full text)\n- [ ] Summary follows voyager-summary.md template\n- [ ] Includes 'Relevance to MechaCoder' section\n- [ ] Citation in BibTeX format","status":"closed","priority":2,"type":"task","labels":["research","paper"],"deps":[],"commits":["73ba31455b6492882a4cd4f607241a8b2d84ce85"],"comments":[],"createdAt":"2025-12-04T19:28:55.510Z","updatedAt":"2025-12-05T01:01:54.529Z","closedAt":"2025-12-05T01:01:54.529Z","closeReason":"Added R2-MGA summary"}
{"id":"oa-9200dd","title":"Research: Titans","description":"## Research Paper: Titans\n\nFind and summarize this academic paper for the OpenAgents research collection.\n\n### Details\n- **Year:** 2023\n- **URLs:**\n  - https://(Google paper, need to find)\n- **Priority:** MEDIUM\n- **Source:** docs/research/analysis/related-work-reflection.md\n\n### Output\nCreate a summary at `docs/research/paper-summaries/<slug>-summary.md` following the standard format.\n\n### Acceptance Criteria\n- [ ] Paper content retrieved (abstract and/or full text)\n- [ ] Summary follows voyager-summary.md template\n- [ ] Includes 'Relevance to MechaCoder' section\n- [ ] Citation in BibTeX format","status":"blocked","priority":2,"type":"task","labels":["research","paper"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-04T19:28:55.517Z","updatedAt":"2025-12-05T01:24:33.804Z","closedAt":null,"closeReason":"Source paper not found after search"}
{"id":"oa-36e88a","title":"Fix typecheck regressions after two-phase commit updates","description":"","status":"closed","priority":1,"type":"bug","labels":["typecheck","orchestrator","healer"],"deps":[],"commits":["e3a3e5212"],"comments":[],"createdAt":"2025-12-04T19:34:53.980Z","updatedAt":"2025-12-04T19:35:48.845Z","closedAt":"2025-12-04T19:35:48.845Z","closeReason":"Fixed typecheck regressions"}
{"id":"oa-ab5fdd","title":"Research: Process MEDIUM priority papers (Memory-of-Thought, R2-MGA, Titans)","description":"Run researcher:auto --priority MEDIUM to process the 3 remaining MEDIUM priority papers from the related-work-reflection.md document. Papers: Memory-of-Thought Prompting (2023), R2-MGA (2025), Titans (2023). After completion, run researcher:synthesize to update the analysis document.","status":"closed","priority":2,"type":"task","labels":["research","paper"],"deps":[],"commits":["492273866c168035759b274bc2759184097aee24"],"comments":[],"createdAt":"2025-12-04T19:49:58.410Z","updatedAt":"2025-12-05T04:51:28.973Z","closedAt":"2025-12-05T04:51:28.973Z","closeReason":"Processed remaining MEDIUM papers and synthesized analysis"}
{"id":"oa-9cbfb1","title":"Add Reflexion pattern to Golden Loop v2","description":"Implement verbal self-reflection on test failures, based on Reflexion paper (Shinn et al., NeurIPS 2023).\n\n## Background\nReflexion achieves 91% pass@1 on HumanEval vs GPT-4's baseline 80% by having agents generate natural language self-reflections on failures and storing them in episodic memory for future attempts.\n\n## Implementation\n\n### 1. Add reflection phase after test failures\nCurrent: Understand → Implement → Test → [FAIL] → Retry\nProposed: Understand → Implement → Test → [FAIL] → **Reflect** → Retry with reflection\n\n### 2. Reflection prompt template\n```\nYou attempted: {action}\nResult: {error_or_failure}\nTest output: {test_results}\n\nAnalyze what went wrong and provide a specific, actionable reflection:\n1. What was the root cause of the failure?\n2. What assumption was wrong?\n3. What should be done differently?\n```\n\n### 3. Memory management\n- Store last 2-3 reflections in sliding window (paper shows diminishing returns beyond this)\n- Include both LAST_ATTEMPT and REFLEXION in retry context (best performing strategy)\n\n## Files to modify\n- src/agent/orchestrator/golden-loop.ts (or equivalent)\n- Possibly src/healer/ (similar reflection logic exists)\n\n## Success criteria\n- [ ] Reflection prompt fires after test/typecheck failures\n- [ ] Last 2-3 reflections stored in subtask context\n- [ ] Reflections included in retry prompts\n- [ ] Can measure retry success rate with/without reflection\n\n## References\n- docs/research/paper-summaries/reflexion-summary.md\n- docs/research/analysis/no-gradient-lifelong-learning.md (Research Updates section)","status":"closed","priority":1,"type":"feature","labels":["golden-loop","research","reflexion"],"deps":[],"commits":["8a7f294a143fecf34393833e3901d9eb30d1cd3f","9778aec2f4fdc40024b11b21b5db63b3433a5070"],"comments":[],"createdAt":"2025-12-04T19:52:03.481Z","updatedAt":"2025-12-04T23:29:43.490Z","closedAt":"2025-12-04T23:27:08.632Z","closeReason":"Added Reflexion handling for test failures"}
{"id":"oa-7803b9","title":"Add Reflexion pattern to Golden Loop v2","description":"","status":"closed","priority":1,"type":"feature","labels":["reflexion","golden-loop","effect"],"deps":[],"commits":["673bde866937f147dcd649680cdbbb3c1e14ed7c"],"comments":[],"createdAt":"2025-12-04T20:05:28.393Z","updatedAt":"2025-12-05T04:40:11.957Z","closedAt":"2025-12-05T04:40:11.957Z","closeReason":"Added reflexion support to parallel runner"}
{"id":"oa-defe31","title":"Add button to start single random TB task","description":"Add a UI button that starts a single random task from the loaded suite instead of running all tasks. Useful for quick testing and debugging individual tasks.","status":"closed","priority":2,"type":"feature","labels":["tbench","ui"],"deps":[],"commits":["8f67f664ba5158cba5849d1d5fc60abb268465f2"],"comments":[],"createdAt":"2025-12-04T20:19:38.465Z","updatedAt":"2025-12-04T20:22:57.329Z","closedAt":"2025-12-04T20:22:57.329Z","closeReason":"Added Random button to TB controls with Ctrl+R shortcut. Picks random task from loaded suite and starts single-task run."}
{"id":"oa-15bf18","title":"Benchmark and optimize parallel agent resource limits","description":"Determine the optimal resource constraints for containerized MechaCoder agents to maximize concurrency without destabilizing the host system.\n\n**Objectives:**\n1. **Determine Minimal Footprint:** Run a stress test (e.g., using `mechacoder:parallel`) to find the minimum RAM/CPU required for a single agent to successfully compile, test, and run Claude Code without OOM errors.\n2. **Determine Max Concurrency:** Calculate the maximum safe `maxAgents` value for a standard dev machine based on those minimums.\n3. **Apply Configurations:** \n   - Update default values in `ParallelExecutionConfig` (src/tasks/schema.ts).\n   - If applicable, set Docker container limits (memory/cpus) in `src/sandbox/` or the parallel runner to prevent one agent from starving others.\n\n**Acceptance Criteria:**\n- Validated minimum RAM requirement defined (e.g., is 2GB enough? 4GB?).\n- Updated `project.json` schema defaults to reflect safe concurrency limits.\n- Confirmed that parallel runs do not crash the host due to resource exhaustion.","status":"closed","priority":2,"type":"task","labels":["performance","parallel-runner","docker","infra"],"deps":[],"commits":["92ef5dc96fb71f9d9d037b79de1b9fee1bed6162"],"comments":[],"createdAt":"2025-12-04T20:50:24.875Z","updatedAt":"2025-12-05T06:10:06.075Z","closedAt":"2025-12-05T06:10:06.075Z","closeReason":"Set safer parallel defaults and documented memory-based auto-capping"}
{"id":"oa-976adf","title":"Implement Claude Code credential injection for MechaCoder sandboxes","description":"","status":"closed","priority":1,"type":"feature","labels":["sandbox","credentials","mechacoder"],"deps":[],"commits":["75b245318fcfe34f37b3ef99924f5985aa014f7e"],"comments":[],"createdAt":"2025-12-04T20:52:21.305Z","updatedAt":"2025-12-04T20:57:20.410Z","closedAt":"2025-12-04T20:57:20.410Z","closeReason":"Implemented Claude Code credential injection for MechaCoder sandboxes"}
{"id":"oa-3d1f76","title":"Implement Claude Code credential injection for TerminalBench sandboxes","description":"","status":"closed","priority":2,"type":"feature","labels":["sandbox","credentials","tbench"],"deps":[],"commits":["5c457054ec58664b5fd5f6590ac1b8de21cecacf"],"comments":[],"createdAt":"2025-12-04T20:52:22.808Z","updatedAt":"2025-12-05T05:47:01.002Z","closedAt":"2025-12-05T05:47:01.002Z","closeReason":"Injected Claude credentials for Harbor TerminalBench runs"}
{"id":"oa-d597cd","title":"Segment tests for container vs host execution","description":"","status":"closed","priority":1,"type":"task","labels":["testing","sandbox","infrastructure"],"deps":[],"commits":["282d314820deda2f6fc8582462802226f4ce6dab"],"comments":[],"createdAt":"2025-12-04T21:04:11.898Z","updatedAt":"2025-12-04T21:15:08.467Z","closedAt":"2025-12-04T21:15:08.467Z","closeReason":"Implemented test segmentation: added test:container script with 397 container-safe tests, added sandboxTestCommands to ProjectConfig schema, updated orchestrator to use sandbox test commands when sandbox is enabled"}
{"id":"oa-44b85a","title":"Add streaming callbacks to ContainerBackend","description":"Add onStdout/onStderr callbacks to ContainerRunOptions in backend.ts, implement collectWithCallback in macos-container.ts, update public API in index.ts","status":"closed","priority":1,"type":"feature","labels":["sandbox","streaming"],"deps":[],"commits":["fcbc6985f7db2ca1934fdae35f46963845035b69"],"comments":[],"createdAt":"2025-12-04T21:18:57.710Z","updatedAt":"2025-12-04T21:20:56.754Z","closedAt":"2025-12-04T21:20:56.754Z","closeReason":"Added ContainerRunOptions with onStdout/onStderr callbacks, implemented collectWithCallback in macos-container.ts, updated public API"}
{"id":"oa-5bcd0b","title":"Add container event types to HUD protocol","description":"Add ContainerStartMessage, ContainerOutputMessage, ContainerCompleteMessage, ContainerErrorMessage to protocol.ts with type guards","status":"closed","priority":1,"type":"feature","labels":["hud","streaming"],"deps":[],"commits":["fcbc6985f7db2ca1934fdae35f46963845035b69"],"comments":[],"createdAt":"2025-12-04T21:18:59.490Z","updatedAt":"2025-12-04T21:22:02.409Z","closedAt":"2025-12-04T21:22:02.409Z","closeReason":"Added ContainerStartMessage, ContainerOutputMessage, ContainerCompleteMessage, ContainerErrorMessage to HUD protocol with type guards"}
{"id":"oa-a6eead","title":"Wire container event emission in sandbox-runner","description":"Add emitHud to SandboxRunnerConfig, emit container_start/output/complete events with executionId correlation in runCommand()","status":"closed","priority":1,"type":"feature","labels":["sandbox","streaming"],"deps":[],"commits":["b32396458b524106c909fac0ffa0a10158153d73"],"comments":[],"createdAt":"2025-12-04T21:19:00.305Z","updatedAt":"2025-12-04T21:24:18.698Z","closedAt":"2025-12-04T21:24:18.698Z","closeReason":"Added emitHud to SandboxRunnerConfig, emit container_start/output/complete events with executionId correlation"}
{"id":"oa-7af9dc","title":"Add streaming support to host execution","description":"Implement runOnHostWithCallbacks() that streams stdout/stderr via callbacks when sandbox is unavailable","status":"closed","priority":1,"type":"feature","labels":["sandbox","streaming"],"deps":[],"commits":["b32396458b524106c909fac0ffa0a10158153d73"],"comments":[],"createdAt":"2025-12-04T21:19:01.368Z","updatedAt":"2025-12-04T21:24:20.379Z","closedAt":"2025-12-04T21:24:20.379Z","closeReason":"Implemented runOnHostWithCallbacks with streaming stdout/stderr support"}
{"id":"oa-ba7772","title":"Add emitHud to createHudCallbacks","description":"Add emitHud() direct emitter to createHudCallbacks() in emit.ts for container events","status":"closed","priority":1,"type":"feature","labels":["hud","streaming"],"deps":[],"commits":["b32396458b524106c909fac0ffa0a10158153d73"],"comments":[],"createdAt":"2025-12-04T21:19:02.437Z","updatedAt":"2025-12-04T21:25:02.795Z","closedAt":"2025-12-04T21:25:02.795Z","closeReason":"Added emitHud direct emitter to createHudCallbacks for container events"}
{"id":"oa-81ce6b","title":"Implement multi-pane container output UI","description":"Add ContainerPane state, message handlers for container events, multi-pane grid rendering with stdout/stderr colors in mainview","status":"closed","priority":1,"type":"feature","labels":["ui","streaming"],"deps":[],"commits":["d2c0cc91e75a0020da064ff51656da7214130f5c"],"comments":[],"createdAt":"2025-12-04T21:19:04.392Z","updatedAt":"2025-12-04T21:34:14.452Z","closedAt":"2025-12-04T21:34:14.452Z","closeReason":"Implemented multi-pane container output UI with streaming support"}
{"id":"oa-69c61d","title":"Wire emitHud through orchestrator","description":"Pass emitHud from createHudCallbacks through orchestrator to sandbox runner config","status":"closed","priority":1,"type":"feature","labels":["orchestrator","streaming"],"deps":[],"commits":["6f1916f0d21257810e503cae189021fc0dfd23eb"],"comments":[],"createdAt":"2025-12-04T21:19:05.491Z","updatedAt":"2025-12-04T21:26:49.682Z","closedAt":"2025-12-04T21:26:49.682Z","closeReason":"Added emitHud to OrchestratorConfig and wired through to sandbox runner"}
{"id":"oa-bc898e","title":"Integration tests for container streaming","description":"Test streaming output from container execution through to UI event handlers","status":"closed","priority":2,"type":"task","assignee":"codex","labels":["testing","streaming"],"deps":[],"commits":["a1b1d1a1c42a8ad49800d8bd4c5b05feec586884"],"comments":[],"createdAt":"2025-12-04T21:19:06.547Z","updatedAt":"2025-12-05T01:49:21.285Z","closedAt":"2025-12-05T01:49:21.285Z","closeReason":"Added HUD container streaming integration test"}
{"id":"oa-e1c8d4","title":"Worktree runner should honor defaultBranch when merging","description":"Worktree runner currently checks out/pulls/pushes hard-coded main in mergeToMain; update to use ProjectConfig.defaultBranch (or workBranch if present) so repos not using main don’t break or merge to the wrong branch.","status":"closed","priority":1,"type":"bug","labels":["worktree","orchestrator"],"deps":[],"commits":["74b93e50ee3af5389dc2ff993c36621b6148df7e"],"comments":[],"createdAt":"2025-12-04T21:20:20.954Z","updatedAt":"2025-12-04T22:15:05.900Z","closedAt":"2025-12-04T22:15:05.900Z","closeReason":"Use configured branch for worktree merges"}
{"id":"oa-628a9e","title":"Add install timeout/args pass-through for worktree bun install","description":"Worktree runner always executes 'bun install' with no timeout, lockfile flags, or use of ParallelExecutionConfig.installArgs/installTimeoutMs. Add configurable install args/timeout and surface failures clearly to avoid hangs and drift.","status":"closed","priority":2,"type":"task","assignee":"codex","labels":["worktree","parallel"],"deps":[],"commits":["edb658a8457bf966a9d180d305b93014f908140f"],"comments":[],"createdAt":"2025-12-04T21:20:24.805Z","updatedAt":"2025-12-05T02:40:25.579Z","closedAt":"2025-12-05T02:40:25.579Z","closeReason":"Added install args/timeout support to worktree runner"}
{"id":"oa-9936c8","title":"Refactor verification runner to async with streaming and structured failures","description":"orchestrator runVerification currently wraps execSync per command, blocking the event loop and losing structured status/output. Refactor to async execution with timeouts, streamed/stdout capture, and clearer error propagation while preserving sandbox fallback.","status":"closed","priority":2,"type":"task","labels":["orchestrator","testing"],"deps":[],"commits":["33814cedbf5ec878d90e5741f4aca7a0c5ffba0d"],"comments":[],"createdAt":"2025-12-04T21:20:29.053Z","updatedAt":"2025-12-05T05:34:47.774Z","closedAt":"2025-12-05T05:34:47.774Z","closeReason":"Refactored verification runner to async streaming with structured failures"}
{"id":"oa-f0dd88","title":"Scope commit staging and safe message building in orchestrator","description":"createCommit uses git add -A and interpolates commit message into a quoted shell command. Harden by scoping staged paths to task changes (or explicit list) and building commit messages via stdin to avoid quoting pitfalls, preventing unrelated workspace files from being included.","status":"closed","priority":2,"type":"task","labels":["git","orchestrator"],"deps":[],"commits":["ebbefadcaec550f3379ac02ae6f21a2fee1c816e"],"comments":[],"createdAt":"2025-12-04T21:20:33.914Z","updatedAt":"2025-12-05T05:14:14.386Z","closedAt":"2025-12-05T05:14:14.386Z","closeReason":"Scoped commit staging and commit message handling"}
{"id":"oa-0a7d42","title":"Make failure cleanup guardrail non-destructive","description":"overnight guardrail auto-runs 'git checkout -- .' and 'git clean -fd' after failures, deleting untracked files and contradicting safety guidance. Make cleanup opt-in and limited to tracked files (no clean -fd), or gate via config flag with clear logging.","status":"closed","priority":1,"type":"bug","labels":["overnight","safety"],"deps":[],"commits":["d30b21ccd5d5aa8bb3f6baf8d9e88cdfcd179d01"],"comments":[],"createdAt":"2025-12-04T21:20:38.535Z","updatedAt":"2025-12-04T22:25:21.829Z","closedAt":"2025-12-04T22:25:21.829Z","closeReason":"Guardrail uses tracked-file revert only by default; delete-untracked opt-in"}
{"id":"oa-abafe0","title":"Wire e2eCommands into orchestrator verification","description":"ProjectConfig includes e2eCommands but orchestrator never runs them; Golden Loop acceptance requires tests+e2e. Add e2e execution when configured (and by label if needed) with proper reporting and failure handling.","status":"in_progress","priority":1,"type":"bug","labels":["orchestrator","testing"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-04T21:20:42.214Z","updatedAt":"2025-12-04T22:28:10.408Z","closedAt":null}
{"id":"oa-dde836","title":"Add timeout and leveled logging to OpenRouter client","description":"OpenRouter chat requests log verbosely to console and lack abort/timeout handling; add configurable timeout/AbortController, leveled logger, and minimal default logging to avoid noisy production output and hung requests.","status":"closed","priority":2,"type":"task","labels":["llm","network"],"deps":[],"commits":["5d47dce82eeccc7216539d4aac0c31075f5acd96"],"comments":[],"createdAt":"2025-12-04T21:20:45.930Z","updatedAt":"2025-12-05T04:02:50.072Z","closedAt":"2025-12-05T04:02:50.072Z","closeReason":"Added timeout/AbortController and leveled logging to OpenRouter client"}
{"id":"oa-e6cad6","title":"Harden sandbox bootstrap download flow","description":"sandbox/bootstrap downloads latest container installer from GitHub without timeout, UA, checksum/signature verification, or cleanup. Add request timeout, user-agent, checksum validation, and temporary file cleanup to reduce supply-chain risk.","status":"closed","priority":3,"type":"chore","labels":["sandbox","security"],"deps":[],"commits":["bd067995b6e5ad9faf30494cfd9004bfc05e99c8"],"comments":[],"createdAt":"2025-12-04T21:20:49.845Z","updatedAt":"2025-12-05T01:12:40.393Z","closedAt":"2025-12-05T01:12:40.393Z","closeReason":"Added timeout, UA, checksum, cleanup to sandbox bootstrap"}
{"id":"oa-bfe8af","title":"Add non-macOS sandbox detection (Docker/Seatbelt)","description":"detectBackend currently returns noop on non-macOS with TODOs for Docker/Seatbelt, so sandboxed verification never runs off macOS. Implement Docker/Seatbelt detection and selection to enable containers on Linux/other hosts.","status":"closed","priority":3,"type":"task","labels":["sandbox"],"deps":[],"commits":["23896af5badd27cc39bb030b26feadb63bc8c191"],"comments":[],"createdAt":"2025-12-04T21:20:55.112Z","updatedAt":"2025-12-05T05:27:04.566Z","closedAt":"2025-12-05T05:27:04.566Z","closeReason":"Enable non-macOS container detection"}
{"id":"oa-10a362","title":"Require token for HUD status-stream by default","description":"StatusStreamServer starts when a port is provided even without a token, exposing HUD events unauthenticated on localhost/LAN. Default to disabled unless a token is set, and refuse to start when token is missing; improve auth checks/tests.","status":"closed","priority":1,"type":"bug","labels":["hud","security"],"deps":[],"commits":["db0622a2640aa6ec056788f1f50cd7d0cf6f6c50"],"comments":[],"createdAt":"2025-12-04T21:20:59.557Z","updatedAt":"2025-12-04T23:34:56.020Z","closedAt":"2025-12-04T23:34:56.020Z","closeReason":"Require token before starting HUD status stream"}
{"id":"oa-0905bc","title":"Modularize orchestrator into services","description":"Split runOrchestrator into smaller services (git, verification, task lifecycle, subagent coordination) with clear interfaces so orchestrator.ts becomes a thin coordinator and units become independently testable.","status":"open","priority":2,"type":"task","labels":["orchestrator","architecture"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-04T21:27:58.806Z","updatedAt":"2025-12-04T21:27:58.806Z","closedAt":null}
{"id":"oa-9c48cf","title":"Refactor worktree runner into composable steps","description":"Extract worktree-runner concerns (git merge/pull, dependency install, orchestrator wiring) into reusable helpers; keep worktree-runner as a thin orchestrator and reuse git helpers for merge/push with defaultBranch awareness.","status":"open","priority":2,"type":"task","labels":["worktree","architecture"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-04T21:28:03.078Z","updatedAt":"2025-12-04T21:28:03.078Z","closedAt":null}
{"id":"oa-d99f3e","title":"Introduce sandbox backend interface + HUD adapter","description":"Define a clear ContainerBackend interface and a HUD emission adapter so sandbox-runner doesn’t branch on backend specifics. This enables adding Docker/Seatbelt cleanly and keeps HUD wiring separate from backend selection.","status":"open","priority":2,"type":"task","labels":["sandbox","architecture"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-04T21:28:06.760Z","updatedAt":"2025-12-04T21:28:06.760Z","closedAt":null}
{"id":"oa-be48f5","title":"Build unified verification pipeline module","description":"Create a verification pipeline module that assembles typecheck/test/e2e commands, runs them (sandbox or host), streams output, applies timeouts, and returns structured results. Replace scattered buildVerificationCommands/runVerification logic with this module.","status":"open","priority":2,"type":"task","labels":["testing","orchestrator"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-04T21:28:10.869Z","updatedAt":"2025-12-04T21:28:10.869Z","closedAt":null}
{"id":"oa-1ca843","title":"Wrap HUD/status streaming in a transport layer","description":"Create a small HUD transport wrapper that handles auth, event filtering, and optional WS startup so orchestrator only depends on one interface. Consolidate emit/status-stream wiring to reduce duplication between emit.ts and status-stream.ts.","status":"open","priority":2,"type":"task","labels":["hud","architecture"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-04T21:28:14.959Z","updatedAt":"2025-12-04T21:28:14.959Z","closedAt":null}
{"id":"oa-cfbe4b","title":"Split OpenRouter client into config/http/tool modules","description":"Refactor OpenRouter client: separate env/config loading, HTTP client with timeout/retry, and tool/schema conversion into distinct modules to improve reuse and testing; add leveled logging instead of console.log.","status":"open","priority":2,"type":"task","labels":["llm","architecture"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-04T21:28:18.994Z","updatedAt":"2025-12-04T21:28:18.994Z","closedAt":null}
{"id":"oa-32424a","title":"Add TaskRepository abstraction for CLI and orchestrator","description":"Create a TaskRepository facade that exposes ready/pick/update/close operations so CLI and orchestrator share one interface instead of importing helpers piecemeal. Improves testability and reduces duplication.","status":"open","priority":2,"type":"task","labels":["tasks","architecture"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-04T21:28:22.637Z","updatedAt":"2025-12-04T21:28:22.637Z","closedAt":null}
{"id":"oa-c8ce7c","title":"Unify git operations into shared utility","description":"Centralize git commands (rev-parse, add/commit/push, merge/pull) into a shared utility with typed wrappers to remove duplicated execSync calls across orchestrator, worktree, and overnight flows; include tests for edge cases.","status":"open","priority":3,"type":"task","labels":["git","architecture"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-04T21:28:27.795Z","updatedAt":"2025-12-04T21:28:27.795Z","closedAt":null}
{"id":"oa-aa2edd","title":"Replace inline requires with top-level imports and typed helpers","description":"Audit orchestrator/overnight/sandbox code for inline require() usage and duplicate execSync blocks; refactor to top-level imports and shared helpers to align with repo guidance and improve readability.","status":"closed","priority":3,"type":"chore","labels":["lint","architecture"],"deps":[],"commits":["cd6549487ddadca182756f1517d38ea4cf239070"],"comments":[],"createdAt":"2025-12-04T21:28:32.291Z","updatedAt":"2025-12-05T06:24:12.050Z","closedAt":"2025-12-05T06:24:12.050Z","closeReason":"Replaced inline require usages with top-level imports"}
{"id":"oa-0cb979","title":"Epic: Migrate Electrobun to webview-bun with Effect Socket","description":"Replace Electrobun desktop framework with webview-bun, removing RPC layer entirely. Use unified Effect Socket protocol for bidirectional client-server communication. Effect on both frontend (@effect/platform-browser) and backend.","status":"closed","priority":1,"type":"epic","labels":["desktop","refactor","effect"],"deps":[],"commits":["9a69ff1da6fedf0c45067462eefb1e8b0a747b13"],"comments":[],"createdAt":"2025-12-04T22:16:48.055Z","updatedAt":"2025-12-04T22:37:08.291Z","closedAt":"2025-12-04T22:37:08.291Z","closeReason":"All subtasks complete - webview-bun migration finished"}
{"id":"oa-4bf5f6","title":"Add webview-bun dependency and basic window setup","description":"Add webview-bun to package.json. Create src/desktop/main.ts entry point. Basic window creation pointing to localhost server. Files: package.json, src/desktop/main.ts (new)","status":"closed","priority":1,"type":"task","labels":["desktop","webview-bun"],"deps":[],"commits":["fca647ae65badc071ac19c789a34061bd70318aa"],"comments":[],"createdAt":"2025-12-04T22:17:03.545Z","updatedAt":"2025-12-04T22:23:46.946Z","closedAt":"2025-12-04T22:23:46.946Z","closeReason":"Added webview-bun dependency and created src/desktop/main.ts entry point with HTTP server, WebSocket server, and native window setup"}
{"id":"oa-fb528f","title":"Create unified Effect Socket protocol schema","description":"Extend src/hud/protocol.ts with request/response message types. Add schema types for: loadTBSuite, startTBRun, stopTBRun, loadRecentTBRuns, loadTBRunDetails. Define bidirectional message discriminator with correlation IDs. Files: src/hud/protocol.ts, src/desktop/protocol.ts (new)","status":"closed","priority":1,"type":"task","labels":["desktop","effect","protocol"],"deps":[],"commits":["1ed920be35c42b04da96ef8f70d2c0fec24e9b40"],"comments":[],"createdAt":"2025-12-04T22:17:04.823Z","updatedAt":"2025-12-04T22:25:59.637Z","closedAt":"2025-12-04T22:25:59.637Z","closeReason":"Created unified Effect Socket protocol with request/response types, correlation IDs, and type guards"}
{"id":"oa-7c8ae5","title":"Implement Effect Socket server with unified protocol","description":"Replace Bun.serve WebSocket with Effect Socket. Handle both HUD events and request/response messages. Maintain backwards compatibility with existing HudClient. Files: src/hud/server.ts, src/desktop/server.ts (new)","status":"closed","priority":1,"type":"task","labels":["desktop","effect","server"],"deps":[],"commits":["ae80176e88fd95e42d5478ab382b483f593de125"],"comments":[],"createdAt":"2025-12-04T22:17:05.965Z","updatedAt":"2025-12-04T22:29:03.761Z","closedAt":"2025-12-04T22:29:03.761Z","closeReason":"Implemented desktop server with unified protocol, request handlers, and message broadcasting"}
{"id":"oa-11ab05","title":"Implement Effect Socket frontend client","description":"Create @effect/platform-browser Socket client. Build Effect-based message handling for unified protocol. Replace Electrobun RPC calls with socket requests. Files: src/mainview/socket-client.ts (new), src/mainview/index.ts","status":"closed","priority":1,"type":"task","labels":["desktop","effect","frontend"],"deps":[],"commits":["7c47be754c0f1f1f72f9ac7e3af932be0f088b50"],"comments":[],"createdAt":"2025-12-04T22:17:07.311Z","updatedAt":"2025-12-04T22:31:37.263Z","closedAt":"2025-12-04T22:31:37.263Z","closeReason":"Created SocketClient with request/response handling, HUD message events, auto-reconnect, and convenience methods for TB operations"}
{"id":"oa-94fa8c","title":"Port TB controls from RPC to Effect Socket","description":"Move loadTBSuite handler to socket protocol. Move startTBRun/stopTBRun handlers. Move loadRecentTBRuns/loadTBRunDetails handlers. Files: src/bun/index.ts, src/desktop/handlers.ts (new)","status":"closed","priority":1,"type":"task","labels":["desktop","tbench"],"deps":[],"commits":["af5d89694bd20fe0dbb54ac053ad02300ad17c6b"],"comments":[],"createdAt":"2025-12-04T22:17:08.973Z","updatedAt":"2025-12-04T22:34:02.078Z","closedAt":"2025-12-04T22:34:02.078Z","closeReason":"Ported all TB controls from Electrobun RPC to SocketClient: loadTBSuite, startTBRun, stopTBRun, loadRecentTBRuns, loadTBRunDetails"}
{"id":"oa-cac183","title":"Update mainview to use webview-bun","description":"Remove Electroview/Electrobun imports. Wire up Effect Socket client. Update UI event handlers to use socket protocol. Files: src/mainview/index.ts, src/mainview/index.html","status":"closed","priority":1,"type":"task","labels":["desktop","frontend"],"deps":[],"commits":["78141cf940783b74c6a08faf48fffd8fb50a50d8"],"comments":[],"createdAt":"2025-12-04T22:17:10.011Z","updatedAt":"2025-12-04T22:35:19.520Z","closedAt":"2025-12-04T22:35:19.520Z","closeReason":"Mainview updated to use SocketClient instead of Electrobun - Electrobun imports removed, socket client wired up, UI handlers work with socket protocol"}
{"id":"oa-05305f","title":"Remove Electrobun dependencies and config","description":"Remove electrobun from package.json. Delete electrobun.config.ts. Remove types/electrobun.d.ts. Update build scripts. Files: package.json, electrobun.config.ts, types/electrobun.d.ts","status":"closed","priority":1,"type":"task","labels":["desktop","cleanup"],"deps":[],"commits":["f4378fb6c4970f29c6248e948dfb51d35e8fe86e"],"comments":[],"createdAt":"2025-12-04T22:17:11.078Z","updatedAt":"2025-12-04T22:36:27.207Z","closedAt":"2025-12-04T22:36:27.207Z","closeReason":"Removed electrobun dependency, config, and types - updated scripts to use webview-bun"}
{"id":"oa-52b098","title":"Update build/start scripts for webview-bun","description":"Create new build script for webview-bun binary. Update bun start to use new entry point. Add bun build --compile configuration. Files: package.json","status":"closed","priority":1,"type":"task","labels":["desktop","build"],"deps":[],"commits":["9a69ff1da6fedf0c45067462eefb1e8b0a747b13"],"comments":[],"createdAt":"2025-12-04T22:17:12.991Z","updatedAt":"2025-12-04T22:36:59.011Z","closedAt":"2025-12-04T22:36:59.011Z","closeReason":"Build scripts updated in task oa-05305f - dev/start use desktop, build uses bun build --compile"}
{"id":"oa-beda13","title":"Replace polling with WebSocket push for TB run history","description":"Currently refreshTBLayout polls every 60s. Instead, have the server push updates when runs complete/change. Remove setInterval polling entirely.","status":"open","priority":3,"type":"task","labels":["desktop","websocket","optimization"],"deps":[],"commits":[],"comments":[],"createdAt":"2025-12-05T04:21:37.118Z","updatedAt":"2025-12-05T04:21:37.118Z","closedAt":null}
{"id":"oa-7063ea","title":"Colorize desktop logs by source","description":"Add color coding to bun/dev logs so each source prefix (Desktop, DesktopServer, Webview, Worker, etc.) uses a distinct color when running bun dev.","status":"closed","priority":2,"type":"task","labels":["desktop","logging"],"deps":[],"commits":["0653a44bc70b300f79e77fde9a1772fd0fd85b4c"],"comments":[],"createdAt":"2025-12-05T04:30:14.423Z","updatedAt":"2025-12-05T04:37:31.124Z","closedAt":"2025-12-05T04:37:31.124Z","closeReason":"Colorized desktop logs by source"}
{"id":"oa-2eaf5a","title":"Enlarge desktop window size","description":"Make the webview-bun desktop window open much larger (laptop fullscreen-like default).","status":"in_progress","priority":3,"type":"task","labels":["desktop","ui"],"deps":[],"commits":["e94a2996ba797c501e31c7f7985b89810de4f3fb"],"comments":[],"createdAt":"2025-12-05T04:46:41.098Z","updatedAt":"2025-12-05T05:06:29.429Z","closedAt":null}
