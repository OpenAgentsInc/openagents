/* Reset and base styles */
* {
  box-sizing: border-box;
}

html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden;
}

body {
  background-color: #000000;
  color: #ffffff;
  font-family: "Berkeley Mono", "JetBrains Mono", ui-monospace, monospace;
}

/* CSS Variables */
:root {
  --sidebar-width: 16rem;
  --sidebar-collapsed-width: 3rem;
  --header-height: 3.5rem;
  --bg-primary: #000000;
  --bg-secondary: #0a0a0a;
  --bg-sidebar: #050505;
  --border-color: rgba(255, 255, 255, 0.1);
  --text-primary: #ffffff;
  --text-secondary: rgba(255, 255, 255, 0.7);
  --text-muted: rgba(255, 255, 255, 0.5);
  --accent-color: #ffffff;
  --hover-bg: rgba(255, 255, 255, 0.05);
  --active-bg: rgba(255, 255, 255, 0.1);
  
  /* V1 Color Palette */
  --text: #D7D8E5;
  --offblack: #1e1e1e;
  --darkgray: #3D3D40;
  --gray: #8B8585;
  --lightgray: #A7A7A7;
  --white: #fff;
  --black: #000000;
  --input-border: #3D3E42;
  --placeholder: #777A81;
  --active-thread: #262626;
  --sidebar-border: #1E1E1E;
}

/* Layout wrapper */
.layout-wrapper {
  display: flex;
  height: 100vh;
  width: 100vw;
  position: fixed;
  top: 0;
  left: 0;
  overflow: hidden;
}

/* Sidebar */
.sidebar {
  width: 260px;
  background: var(--bg-sidebar);
  border-right: 1px solid var(--sidebar-border);
  position: relative;
  transition: transform 0.15s ease-in-out;
  flex-shrink: 0;
}

.sidebar-open {
  transform: translateX(0);
}

.sidebar-closed {
  transform: translateX(-100%);
}


/* Fixed Toggle Button (Always Visible) */
.sidebar-toggle-fixed {
  position: fixed;
  top: 0.75rem;
  left: 0.75rem;
  z-index: 1000;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  height: 1.875rem;
  width: 1.875rem;
  background: var(--bg-primary);
  border: none;
  border-radius: 0.375rem;
  color: var(--text-muted);
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
}

.sidebar-toggle-fixed:hover {
  background: rgba(255, 255, 255, 0.05);
  color: var(--text-primary);
}

.sidebar-toggle-fixed svg {
  pointer-events: none;
  width: 1rem;
  height: 1rem;
  flex-shrink: 0;
}

.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}


/* Main Content */
.main-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  background: var(--bg-primary);
  overflow: hidden;
  position: relative;
  height: 100vh;
  transition: margin-left 0.15s ease-in-out;
  margin-left: 0;
}

.sidebar-collapsed {
  margin-left: -260px;
}

/* Header */
.main-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: var(--header-height);
  padding: 0 1rem;
  background: transparent;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  z-index: 10;
}

.header-left,
.header-right {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.user-menu {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 2rem;
  height: 2rem;
  padding: 0;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border: 1px solid var(--border-color);
  border-radius: 0.375rem;
  color: var(--text-primary);
  cursor: pointer;
  transition: all 0.2s;
}

.user-menu:hover {
  background: var(--hover-bg);
  border-color: var(--text-secondary);
}

.avatar {
  width: 2rem;
  height: 2rem;
  border-radius: 0.375rem;
  background: var(--text-secondary);
  color: var(--bg-primary);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.875rem;
  font-weight: 600;
}

/* Messages Container */
.messages-container {
  flex: 1;
  overflow-y: auto;
  padding: 80px 20px 120px;
}

.messages-inner {
  max-width: 700px;
  margin: 0 auto;
}

/* Conversation Title */
.conversation-title {
  margin-bottom: 3rem;
  padding-bottom: 1.5rem;
  border-bottom: 1px solid var(--border-color);
}

.conversation-title h1 {
  font-size: 1.25rem;
  font-weight: 600;
  color: var(--text);
  margin: 0;
  line-height: 1.4;
  font-family: var(--font-family-mono);
}

/* OpenCode-style Message Blocks */
.message {
  display: flex;
  margin-bottom: 0.25rem; /* Further reduced vertical spacing */
  max-width: 700px;
  margin-left: auto;
  margin-right: auto;
  width: 100%;
}

.message.user {
  justify-content: flex-end;
  align-items: flex-end;
}

.message.assistant,
.message.tool {
  justify-content: flex-start;
}

.message-block {
  display: inline-block;
  word-wrap: break-word;
  position: relative;
}

/* User message styling */
.message-block.user {
  border: 1px solid rgba(255, 255, 255, 0.5) !important; /* Brighter white border all around */
  border-right-width: 4px !important;
  border-right-color: rgba(255, 255, 255, 0.9) !important; /* Much brighter right accent */
  border-left-width: 1px !important; /* Reset left border width */
  border-left-color: rgba(255, 255, 255, 0.5) !important; /* White left border */
  border-top-color: rgba(255, 255, 255, 0.5) !important; /* White top */
  border-bottom-color: rgba(255, 255, 255, 0.5) !important; /* White bottom */
  background: rgba(255, 255, 255, 0.03); /* Very subtle white background */
  border-radius: 0; /* Rectangular - no rounding */
  max-width: 85%;
  margin-left: auto; /* Push to right */
  margin-right: 1rem; /* Small spacing from right edge */
  padding: 0.75rem 1rem;
  color: rgba(255, 255, 255, 0.9); /* Bright white text */
}

/* Assistant message styling */
.message-block.assistant {
  border: none; /* No borders at all */
  background: transparent; /* Transparent background */
  border-radius: 0; /* Rectangular - no rounding */
  max-width: 85%;
  margin-right: auto;
  margin-left: 1rem;
  padding: 0.75rem 1rem;
}

/* Tool message styling */
.message-block.tool {
  border: 1px solid rgba(255, 255, 255, 0.1) !important; /* 10% opacity white border */
  border-left: 4px solid rgba(255, 255, 255, 0.1) !important; /* Same 10% opacity for left accent */
  border-left-color: rgba(255, 255, 255, 0.1) !important; /* Force white, no purple */
  background: rgba(255, 255, 255, 0.02); /* Extremely subtle white background */
  border-radius: 0; /* Rectangular - no rounding */
  margin-left: 1rem; /* Same as assistant messages */
  margin-right: auto;
  padding: 0.75rem 1rem;
  max-width: 85%;
}

/* Tool result styling */
.message-block.tool-result {
  border: 1px solid rgba(255, 255, 255, 0.1); /* 10% opacity white border */
  border-left: 4px solid rgba(255, 255, 255, 0.1); /* Same 10% opacity for left accent */
  background: rgba(255, 255, 255, 0.02); /* Extremely subtle white background */
  border-radius: 0; /* Rectangular - no rounding */
  margin-left: 1rem; /* Same as assistant messages */
  margin-right: auto;
  padding: 0.75rem 1rem;
  max-width: 85%;
}

.message-block.tool-result-error {
  border: 1px solid rgba(255, 100, 100, 0.1); /* Very faint red border for errors */
  border-left: 4px solid rgba(255, 100, 100, 0.2); /* Slightly brighter red left accent */
  background: rgba(255, 100, 100, 0.03); /* Extremely subtle red background */
  border-radius: 0; /* Rectangular - no rounding */
  margin-left: 1rem; /* Same as assistant messages */
  margin-right: auto;
  padding: 0.75rem 1rem;
  max-width: 85%;
}

/* Message header styles - removed as headers are no longer displayed */
/*
.message-header {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
}

.message-role {
  font-weight: 600;
  color: var(--white);
  font-size: 14px;
  font-family: var(--font-family-mono);
}

.message-role.user {
  color: #9ece6a;
}

.message-role.assistant {
  color: #7aa2f7;
}

.message-role.tool {
  color: var(--lightgray);
}

.message-time {
  font-size: 12px;
  color: var(--gray);
  font-weight: normal;
  font-family: var(--font-family-mono);
}
*/

.message-body {
  color: var(--text);
  line-height: 1.6;
  font-family: var(--font-family-mono);
  font-size: 14px;
  max-width: none;
}

/* Tool message specific styling */
.message-block.tool .message-body {
  font-size: 13px;
  color: var(--lightgray);
}

.tool-section {
  background: rgba(168, 85, 247, 0.05);
  border: 1px solid rgba(168, 85, 247, 0.2);
  border-radius: 6px;
  padding: 0.75rem;
  margin: 0.5rem 0;
  font-family: var(--font-family-mono);
}

.tool-header {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
  font-weight: 600;
  font-size: 13px;
  color: var(--lightgray);
}

.tool-name {
  color: var(--lightgray) !important; /* Light gray, not purple */
  font-weight: normal !important; /* Not bold */
}

.tool-status {
  font-size: 11px;
  padding: 2px 6px;
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 600;
}

.tool-status.success {
  background: rgba(158, 206, 106, 0.1);
  color: #9ece6a;
}

.tool-status.error {
  background: rgba(247, 118, 142, 0.1);
  color: #f7768e;
}

.tool-status.pending {
  background: rgba(224, 175, 104, 0.1);
  color: #e0af68;
}

.tool-content {
  font-size: 12px;
  line-height: 1.4;
  color: var(--text);
  white-space: pre-wrap;
  overflow-x: auto;
}

/* Message body markdown styles */
.message-body code {
  background-color: var(--offblack);
  padding: 2px 4px;
  border-radius: 3px;
  font-size: 14px;
}

.message-body pre[is-="pre"] {
  margin: 16px 0;
  overflow-x: auto;
}

.message-body pre[is-="pre"] code {
  background: none;
  padding: 0;
  font-size: 14px;
  line-height: 1.5;
}

.message-body p {
  margin: 0 0 16px 0;
}

.message-body p:last-child {
  margin-bottom: 0;
}

.message-body ul,
.message-body ol {
  margin: 0 0 16px 0;
  padding-left: 24px;
}

.message-body li {
  margin: 4px 0;
}

.message-body blockquote {
  border-left: 4px solid var(--darkgray);
  padding-left: 16px;
  margin: 16px 0;
  color: var(--gray);
}

.message-body h1,
.message-body h2,
.message-body h3,
.message-body h4,
.message-body h5,
.message-body h6 {
  margin: 24px 0 16px 0;
  font-weight: 600;
}

.message-body h1 {
  font-size: 1.5em;
}

.message-body h2 {
  font-size: 1.3em;
}

.message-body h3 {
  font-size: 1.1em;
}

.message-body a {
  color: var(--white);
  text-decoration: underline;
}

.message-body a:hover {
  color: var(--gray);
}

/* Loading animation */
.dot-flashing {
  position: relative;
  width: 10px;
  height: 10px;
  border-radius: 5px;
  background-color: var(--white);
  color: var(--white);
  animation: dot-flashing 1s infinite linear alternate;
  animation-delay: 0.5s;
  margin: 0 0 0 14px;
  display: inline-block;
}

.dot-flashing::before,
.dot-flashing::after {
  content: "";
  display: inline-block;
  position: absolute;
  top: 0;
}

.dot-flashing::before {
  left: -15px;
  width: 10px;
  height: 10px;
  border-radius: 5px;
  background-color: var(--white);
  color: var(--white);
  animation: dot-flashing 1s infinite alternate;
  animation-delay: 0s;
}

.dot-flashing::after {
  left: 15px;
  width: 10px;
  height: 10px;
  border-radius: 5px;
  background-color: var(--white);
  color: var(--white);
  animation: dot-flashing 1s infinite alternate;
  animation-delay: 1s;
}

@keyframes dot-flashing {
  0% {
    background-color: var(--white);
  }
  50%,
  100% {
    background-color: rgba(255, 255, 255, 0.2);
  }
}

/* Input Area */
.input-area {
  position: fixed;
  bottom: 0;
  left: 260px;
  right: 0;
  z-index: 10;
  pointer-events: none;
  padding: 0;
  transition: left 0.15s ease-in-out;
}

.input-area.sidebar-collapsed-input {
  left: 0;
}

.input-wrapper {
  pointer-events: auto;
  position: relative;
  width: 100%;
  max-width: 768px;
  margin: 0 auto;
}

.input-container {
  position: relative;
}

.input-gradient-wrapper {
  background: transparent;
  padding: 0;
}

.chat-form {
  position: relative;
  display: flex;
  flex-direction: column;
  gap: 8px;
  background: rgba(0, 0, 0, 0.88);
  backdrop-filter: blur(12px);
  border: 1px solid rgba(255, 255, 255, 0.08);
  border-bottom: 0;
  border-radius: 0;
  padding: 12px;
  box-shadow: 
    rgba(0, 0, 0, 0.1) 0px 80px 50px 0px, 
    rgba(0, 0, 0, 0.07) 0px 50px 30px 0px, 
    rgba(0, 0, 0, 0.06) 0px 30px 15px 0px, 
    rgba(0, 0, 0, 0.04) 0px 15px 8px, 
    rgba(0, 0, 0, 0.04) 0px 6px 4px, 
    rgba(0, 0, 0, 0.02) 0px 2px 2px;
}

.input-content {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.input-row {
  display: flex;
  align-items: start;
  flex-grow: 1;
}

.chat-input {
  width: 100%;
  background: transparent;
  border: none;
  color: var(--white);
  font-family: inherit;
  font-size: 16px;
  line-height: 1.5;
  padding: 4px 0;
  resize: none;
  outline: none;
  min-height: 48px;
  max-height: 200px;
}

.chat-input:focus {
  outline: none;
  box-shadow: none;
}

.chat-input::placeholder {
  color: rgba(255, 255, 255, 0.4);
}

/* ProseMirror Editor Styles */
.chat-input-container {
  width: 100%;
  min-height: 48px;
  max-height: 200px;
  overflow-y: auto;
}

.prosemirror-editor {
  width: 100%;
  background: transparent;
  border: none;
  color: var(--white);
  font-family: inherit;
  font-size: 16px;
  line-height: 1.5;
  padding: 4px 0;
  resize: none;
  outline: none;
  min-height: 48px;
}

.prosemirror-editor:focus {
  outline: none;
  box-shadow: none;
}

.prosemirror-editor.disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* ProseMirror paragraph styles */
.prosemirror-editor p {
  margin: 0;
  padding: 0;
}

.prosemirror-editor p + p {
  margin-top: 0.5em;
}

/* ProseMirror placeholder */
.prosemirror-editor.empty::before {
  content: attr(data-placeholder);
  color: rgba(255, 255, 255, 0.4);
  position: absolute;
  pointer-events: none;
}

/* Hide ProseMirror's default focus outline */
.ProseMirror:focus {
  outline: none;
}

.ProseMirror-focused {
  outline: none;
}

.input-actions {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 4px;
}

.left-actions {
  display: flex;
  align-items: center;
  gap: 4px;
  margin-left: -4px;
}

.right-actions {
  margin-right: -4px;
}

/* Model Selector */
.model-selector-container {
  position: relative;
}

.model-selector-button {
  background: transparent;
  border: none;
  border-radius: 8px;
  padding: 8px 8px 8px 8px;
  font-size: 14px;
  font-weight: 500;
  color: var(--text-secondary);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: all 0.2s;
  font-family: inherit;
  margin-bottom: -8px;
}

.model-selector-button:hover {
  background: rgba(255, 255, 255, 0.05);
  color: var(--white);
}

/* Submit Button */
.submit-button {
  background: rgba(162, 59, 103, 0.2);
  border: 1px solid rgba(162, 59, 103, 0.3);
  border-radius: 8px;
  color: rgba(255, 255, 255, 0.9);
  cursor: pointer;
  padding: 0;
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.submit-button:hover:not(:disabled) {
  background: rgba(213, 102, 152, 0.3);
  border-color: rgba(213, 102, 152, 0.4);
}

.submit-button:active:not(:disabled) {
  background: rgba(162, 59, 103, 0.25);
}

.submit-button:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.submit-button svg {
  width: 20px;
  height: 20px;
}

/* Search and Attach Buttons */
.search-button,
.attach-button {
  background: transparent;
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 20px;
  color: var(--text-muted);
  cursor: pointer;
  padding: 6px 12px 6px 8px;
  font-size: 12px;
  font-weight: 500;
  display: flex;
  align-items: center;
  gap: 6px;
  transition: all 0.2s;
  font-family: inherit;
  margin-bottom: -6px;
}

.attach-button {
  padding: 8px;
}

.search-button:hover:not(:disabled),
.attach-button:hover {
  background: rgba(255, 255, 255, 0.05);
  color: var(--text-primary);
  border-color: rgba(255, 255, 255, 0.15);
}

.search-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.search-button svg,
.attach-button svg {
  width: 16px;
  height: 16px;
}

.model-selector-dropdown {
  position: absolute;
  bottom: 100%;
  left: 0;
  margin-bottom: 8px;
  background-color: rgba(0, 0, 0, 0.95);
  backdrop-filter: blur(12px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  min-width: 320px;
  max-height: 400px;
  overflow-y: auto;
  z-index: 100;
  display: none;
  box-shadow: 
    0 20px 25px -5px rgba(0, 0, 0, 0.3), 
    0 10px 10px -5px rgba(0, 0, 0, 0.2);
}

.model-selector-dropdown.open {
  display: block;
}

.model-group {
  padding: 8px 12px;
  font-size: 11px;
  color: var(--gray);
  text-transform: uppercase;
  font-weight: 600;
  border-bottom: 1px solid var(--darkgray);
}

.model-option {
  padding: 8px 12px;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  gap: 2px;
  transition: background-color 0.2s;
}

.model-option:hover:not(.locked) {
  background-color: var(--darkgray);
}

.model-option.selected {
  background-color: var(--active-thread);
}

.model-option.locked {
  opacity: 0.5;
  cursor: not-allowed;
}

.model-option.locked .model-name {
  color: var(--gray);
}

.lock-icon {
  width: 12px;
  height: 12px;
  margin-left: 4px;
  display: inline-block;
  vertical-align: middle;
}

.model-name {
  color: var(--white);
  font-size: 13px;
}

.model-description {
  color: var(--gray);
  font-size: 11px;
}

.api-key-notice {
  padding: 8px 12px;
  background-color: rgba(255, 193, 7, 0.1);
  border-top: 1px solid var(--darkgray);
  font-size: 11px;
  color: var(--lightgray);
}

.api-key-notice a {
  color: var(--white);
  text-decoration: underline;
}

.attach-button {
  background: transparent;
  border: 1px solid var(--darkgray);
  border-radius: 6px;
  color: var(--gray);
  padding: 6px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}

.attach-button:hover {
  background-color: var(--offblack);
  color: var(--white);
}

/* Scrollbar styling */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--text-muted);
}

/* JSONL Ingestion Drag and Drop Styles */
#jsonl-drop-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(4px);
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  visibility: hidden;
  transition: all 0.2s ease;
}

#jsonl-drop-overlay.visible {
  opacity: 1;
  visibility: visible;
}

.drop-overlay-content {
  background: var(--offblack);
  border: 2px dashed var(--input-border);
  border-radius: 12px;
  padding: 3rem;
  text-align: center;
  color: var(--text);
  max-width: 400px;
}

.drop-icon {
  width: 64px;
  height: 64px;
  margin: 0 auto 1rem;
  color: var(--gray);
}

.drop-text {
  font-size: 1.25rem;
  font-weight: 600;
  color: var(--white);
}

/* JSONL Notification Styles */
.jsonl-notification {
  position: fixed;
  top: 20px;
  right: 20px;
  background: var(--offblack);
  border: 1px solid var(--input-border);
  border-radius: 8px;
  padding: 1rem 1.5rem;
  font-size: 0.875rem;
  font-weight: 500;
  z-index: 10000;
  opacity: 0;
  transform: translateX(100%);
  transition: all 0.3s ease;
  max-width: 300px;
}

.jsonl-notification.visible {
  opacity: 1;
  transform: translateX(0);
}

.jsonl-notification.success {
  border-color: #22c55e;
  color: #22c55e;
}

.jsonl-notification.error {
  border-color: #ef4444;
  color: #ef4444;
}

/* Debug button styles */
.message-actions {
  position: absolute;
  right: 0;
  bottom: -30px; /* Position below the message block to avoid overlap */
  display: flex;
  align-items: center;
  gap: 4px;
  opacity: 0;
  transition: opacity 0.2s;
}

.group:hover .message-actions {
  opacity: 1;
}

.debug-button {
  padding: 8px 4px 4px 4px; /* Added 4px more top padding */
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 4px;
  color: var(--gray);
  cursor: pointer;
  font-size: 12px;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.debug-button:hover {
  background: rgba(255, 255, 255, 0.1);
  color: var(--lightgray);
  border-color: rgba(255, 255, 255, 0.2);
}

.debug-button svg {
  width: 16px;
  height: 16px;
}

/* Add minimal padding to messages */
.message {
  padding-bottom: 0.75rem; /* Reduced from 2rem */
}

/* Debug section styles */
.message-debug {
  margin-top: 0.5rem;
  padding: 0.5rem;
  background: rgba(0, 0, 0, 0.5);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 4px;
  font-size: 11px;
  color: var(--lightgray);
  overflow-x: auto;
}

.debug-json {
  margin: 0;
  font-family: var(--font-family-mono);
  font-size: 11px;
  line-height: 1.4;
}