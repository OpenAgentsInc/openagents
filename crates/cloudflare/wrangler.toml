name = "openagents-relay"
main = "build/worker/shim.mjs"
compatibility_date = "2024-12-01"

[build]
command = "cargo install -q worker-build && worker-build --release"

# Durable Objects for stateful relay
[durable_objects]
bindings = [{ name = "RELAY", class_name = "RelayDurableObject" }]

# SQLite storage in Durable Objects
[[migrations]]
tag = "v1"
new_sqlite_classes = ["RelayDurableObject"]

# Workers AI binding for NIP-90 DVM
[ai]
binding = "AI"

# Environment variables
[vars]
ENVIRONMENT = "production"

# Dev environment
[env.dev]
name = "openagents-relay-dev"
[env.dev.vars]
ENVIRONMENT = "development"
