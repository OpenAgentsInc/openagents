[package]
name = "nostr-relay"
version.workspace = true
edition.workspace = true
description = "Nostr relay implementation with SQLite storage"
license = "MIT"

[[bin]]
name = "nostr-relay"
path = "src/main.rs"

[features]
default = ["full"]
full = ["nostr/full"]

[dependencies]
# Nostr core protocol
nostr = { path = "../core" }

# Async runtime
tokio = { version = "1", features = ["full"] }

# WebSocket server
warp = "0.3"
tokio-tungstenite = "0.21"
futures = "0.3"

# Database
rusqlite = { version = "0.31", features = ["bundled"] }
r2d2 = "0.8"
r2d2_sqlite = "0.24"

# Serialization
serde = { version = "1", features = ["derive"] }
serde_json = "1"

# Error handling
thiserror = "2"

# Logging
tracing = "0.1"

# Rate limiting
governor = "0.6"
nonzero_ext = "0.3"
hex.workspace = true

# Random generation for NIP-42 challenges
rand = "0.9"

[dev-dependencies]
tokio-test = "0.4"
tempfile = "3"
criterion = { version = "0.5", features = ["html_reports"] }
proptest = "1.9.0"

[[bench]]
name = "relay_benchmarks"
harness = false

[[bench]]
name = "validation"
harness = false
