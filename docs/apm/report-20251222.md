# APM Historical Report - December 22, 2025

> **STATUS: PENDING RECOLLECTION** - Data collection methodology was fixed. Previous stats removed. Will recollect with accurate tooling.

## What Changed

On December 22, 2025, we discovered and fixed critical gaps in APM data collection:

### Problems Identified

1. **rlog files truncate content** - Messages limited to 200 chars, thinking to 150, tool output to 100
2. **Subagent activity not tracked** - The `x:` line type existed in format spec but was never emitted
3. **No unified view** - Couldn't see full autopilot session including all subagent work
4. **Duration estimates were garbage** - Used fake "15 min/session" averages instead of actual timestamps

### Fixes Implemented

| Change | Files Modified |
|--------|----------------|
| **Dual-format logging** - rlog (human-readable) + JSONL (full data) | `trajectory.rs`, `main.rs`, `lib.rs` |
| **Subagent tracking** - Task tool spawns now emit `x:` lines and track completion | `rlog.rs`, `lib.rs` |
| **JSONL streaming** - Full untruncated SDK messages written alongside rlog | `trajectory.rs`, `lib.rs` |
| **APM parser for autopilot JSONL** - Can now parse autopilot logs same as Claude Code | `apm_parser.rs` |
| **Documentation** - Methodology and format docs updated | `methodology.md`, `format.md` |

### New Data Format

After running autopilot with the new code:

```
docs/logs/20251222/
  123456-task-name.rlog           # Human review (truncated)
  123456-task-name.jsonl          # Full data (APM source)
  123456-task-name.sub-abc123.jsonl  # Subagent sessions
```

### APM Formula (Unchanged)

```
APM = (user_messages + assistant_messages + tool_calls) / duration_minutes
```

Where duration is calculated from **actual timestamps**, not estimates.

---

## Previous Data (Removed)

The stats previously in this report used inconsistent methodology:
- macOS: Estimated durations (15 min/session assumption)
- Linux: Actual timestamps but incomplete action counts
- Autopilot: rlog only captured tools, missing messages entirely

These have been removed. Will recollect once new tooling is deployed.

---

## Next Steps

1. Deploy the updated autopilot code
2. Run autopilot sessions to generate new JSONL files
3. Recollect APM stats using the unified methodology
4. Update this report with accurate data

---

## Files

- Methodology: [`docs/apm/methodology.md`](methodology.md)
- Format spec: [`crates/recorder/docs/format.md`](../../crates/recorder/docs/format.md)
- APM calculation code: [`crates/autopilot-core/src/apm.rs`](../../crates/autopilot-core/src/apm.rs)
- APM parser: [`crates/autopilot-core/src/apm_parser.rs`](../../crates/autopilot-core/src/apm_parser.rs)
