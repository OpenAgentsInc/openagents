# Aperture config with Cloud SQL Postgres (for Cloud Run).
# Password is injected when creating the secret.
listenaddr: "0.0.0.0:8080"
basedir: "/tmp"
debuglevel: "info"
insecure: true

authenticator:
  network: "mainnet"
  disable: false
  lndhost: "openagents.m.voltageapp.io:10009"
  tlspath: "/voltage-tls/tls.cert"
  macdir: "/voltage-mac"

dbbackend: "postgres"
postgres:
  # Use public IP (authorized 0.0.0.0/0 for testing). Prefer Unix socket /cloudsql/... with URL-encoded host for production.
  host: "34.46.174.166"
  port: 5432
  user: "aperture"
  password: "REPLACE_PASSWORD"
  dbname: "aperture"
  maxconnections: 25
  requiressl: true
  skipmigrations: false

services:
  - name: bootstrap
    hostregexp: "^l402-bootstrap\\.openagents\\.local$"
    pathregexp: "^/.*$"
    address: 127.0.0.1:9
    protocol: http
    price: 0
  # EP212 demo route A: under-cap paid success path.
  - name: ep212-demo-under-cap
    hostregexp: "^l402\\.openagents\\.com$"
    pathregexp: "^/ep212/premium-signal$"
    address: openagents.com:443
    protocol: https
    price: 70
  # EP212 demo route B: over-cap quote path used for policy block rehearsals.
  - name: ep212-demo-over-cap
    hostregexp: "^l402\\.openagents\\.com$"
    pathregexp: "^/ep212/expensive-signal$"
    address: openagents.com:443
    protocol: https
    price: 250
  # Staging reconcile path.
  - name: staging
    hostregexp: "^l402\\.openagents\\.com$"
    pathregexp: "^/staging(?:/.*)?$"
    address: 127.0.0.1:9
    protocol: http
    price: 0
