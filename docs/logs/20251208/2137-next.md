
âº Next Step: Fix Verification â†’ Get One Task Solving

  Current Status:
  - âœ… Docker support implemented
  - âœ… Proper images being used
  - âš ï¸ Pytest output parsing broken (shows "0/1 tests" instead of "0/9")
  - âŒ FM wasting turns on read_file loops
  - âŒ No tasks solving yet

  Goal: Get HillClimber solving ONE hard task

  ---
  Immediate Blockers (Fix First)

  1. Fix Pytest Output Parsing (30 min)

  The Docker output shows 47,290 chars with apt-get noise drowning out pytest results:

  Docker output (first 500 chars):
  Selecting previously unselected package liblocale-gettext-perl.
  (Reading database ... (Reading database ... 5%...

  Problem: parsePytestSummary() can't find the test counts in all that noise.

  Fix:
  // src/bench/tb2-docker-runner.ts
  // Extract only the last 2000 chars (where pytest summary lives)
  const pytestOutput = fullOutput.slice(-2000);
  const parsed = parsePytestSummary(pytestOutput);

  Or better: suppress apt-get output:
  apt-get update -qq >/dev/null 2>&1 &&
  apt-get install -y -qq python3 python3-pip >/dev/null 2>&1 &&
  python3 -m pip install -q --break-system-packages pytest 2>&1 | grep -v WARNING &&
  python3 -m pytest tests/ -v 2>&1

  2. Fix FM Read Loop (20 min)

  FM keeps trying read_file on non-existent files. The prompt needs to be clearer:

  Current issue: FM doesn't understand it should write first, then verify.

  Fix in decomposer.ts:
  {
    name: "write-initial-regex",
    description: "Write your first regex attempt to /app/regex.txt",
    checkpoint: "regex.txt file exists with a valid regex pattern",
    hints: [
      "The file doesn't exist yet - you must create it with write_file",
      "Don't try to read the file first - just write your best attempt",
      "Use write_file with path='/app/regex.txt' and content='<your-regex>'",
    ]
  }

  ---
  Strategy: Start with Medium, Prove System, Then Hard

  Phase 1: Get regex-log Solving (Medium) - 2-4 hours

  Why start with medium:
  - Simpler task (single regex file)
  - Fast verification (~1s)
  - Good test of the full pipeline
  - Already have detailed decomposition

  Actions:
  1. Fix pytest parsing â†’ see "0/9 tests"
  2. Fix FM prompting â†’ avoid read loops
  3. Run full solve attempt
  4. Iterate on prompts until 9/9 passes

  Success criteria: regex-log passes (9/9) in <15 turns

  Phase 2: Select and Solve a Hard Task - 4-8 hours

  Hard task candidates:

  | Task                         | Difficulty | Why Good                              | Concerns                        |
  |------------------------------|------------|---------------------------------------|---------------------------------|
  | dna-assembly                 | Hard       | Algorithmic, well-defined constraints | Need domain knowledge           |
  | path-tracing                 | Hard       | Pure algorithm, deterministic         | Image comparison might be flaky |
  | model-extraction-relu-logits | Hard       | Mathematical, interesting             | May need matrix libraries       |
  | video-processing             | Hard       | OpenCV available                      | Video analysis complex          |

  Recommendation: dna-assembly
  - Clear algorithmic task (design primers for Golden Gate assembly)
  - Well-defined validation (melting temp, primer length)
  - No external dependencies (just string manipulation)
  - Deterministic results

  Actions:
  1. Create decomposition for dna-assembly
  2. Add task-specific hints to decomposer
  3. Run solve attempt
  4. Analyze failures, iterate on prompts
  5. Get passing

  ---
  Concrete Next Actions (Right Now)

  Action 1: Fix Pytest Parsing

  # Edit tb2-docker-runner.ts
  # Change line ~130 to extract last 2000 chars

  Action 2: Run Quick Test

  # Verify we now see correct test counts
  bun test src/hillclimber/e2e-regex-log.test.ts 2>&1 | grep "Progress:"
  # Should show: "Progress: 0.0% (0/9 tests)" not "0/1"

  Action 3: Fix FM Prompting

  # Edit decomposer.ts subtask hints
  # Make it crystal clear: write first, don't read

  Action 4: Full Solve Attempt

  # Run HillClimber with fixed prompts
  # Monitor: does FM write file? Does verification show 9 tests? Does progress increase?

  Action 5: Iterate Until Solving

  Repeat:
  1. Run solve
  2. Identify where FM gets stuck
  3. Improve prompts/hints
  4. Try again

  Until: 9/9 tests pass

  ---
  Timeline

  Today (next 2 hours):
  - Fix pytest parsing
  - Fix FM prompting
  - Get 1st clean run showing correct test counts

  Tomorrow:
  - Iterate on regex-log until solving
  - Document what prompts worked

  This Week:
  - Select hard task (dna-assembly)
  - Create decomposition
  - Get solving

  Success Metric:
  âœ… regex-log: 9/9 tests passing in <15 turns
  âœ… dna-assembly: All tests passing in <30 turns
  ðŸ“Š Proof that HillClimber + MAP + FM can solve hard TB2 tasks

  ---
  What Should I Do Right Now?

  Option A: Fix pytest parsing and re-run test (30 min)
  - Immediate unblock
  - See real test counts
  - Validate Docker is actually working

  Option B: Deep dive on FM prompting (2 hours)
  - Analyze why FM loops on read_file
  - Redesign prompts to guide better
  - More strategic

  Option C: Just run full solve and see what happens (15 min)
  - Quick validation
  - See all failure modes at once
  - Then fix systematically

  My recommendation: Option A â†’ Option C â†’ Option B

  1. Fix parsing (quick win)
  2. Run full solve (see real behavior)
  3. Fix prompts based on what we learn

  Should I start with fixing the pytest parsing?
