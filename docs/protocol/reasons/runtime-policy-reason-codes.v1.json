{
  "id": "runtime-policy-reasons.v1",
  "version": "2026-02-19",
  "owner": "openagents-runtime",
  "domains": [
    "policy_allowed",
    "policy_denied",
    "loop_detected",
    "ssrf_block",
    "manifest_validation",
    "comms_failed",
    "coding_failed"
  ],
  "reason_codes": [
    {
      "code": "policy_allowed.default",
      "domain": "policy_allowed",
      "decision": "allowed",
      "description": "Policy evaluation allowed execution with no deny condition triggered."
    },
    {
      "code": "policy_denied.explicit_deny",
      "domain": "policy_denied",
      "decision": "denied",
      "description": "Execution denied because policy input explicitly requested deny."
    },
    {
      "code": "policy_denied.consent_required",
      "domain": "policy_denied",
      "decision": "denied",
      "description": "Execution denied because recipient consent was required but not granted."
    },
    {
      "code": "policy_denied.suppressed_recipient",
      "domain": "policy_denied",
      "decision": "denied",
      "description": "Execution denied because recipient is suppressed and suppression enforcement is enabled."
    },
    {
      "code": "policy_denied.authorization_missing",
      "domain": "policy_denied",
      "decision": "denied",
      "description": "Execution denied because authorization_id is missing."
    },
    {
      "code": "policy_denied.authorization_expired",
      "domain": "policy_denied",
      "decision": "denied",
      "description": "Execution denied because the resolved authorization is expired."
    },
    {
      "code": "policy_denied.authorization_revoked",
      "domain": "policy_denied",
      "decision": "denied",
      "description": "Execution denied because the resolved authorization is revoked."
    },
    {
      "code": "policy_denied.invalid_authorization_mode",
      "domain": "policy_denied",
      "decision": "denied",
      "description": "Execution denied because authorization_mode is invalid."
    },
    {
      "code": "policy_denied.budget_exhausted",
      "domain": "policy_denied",
      "decision": "denied",
      "description": "Execution denied because remaining budget is exhausted."
    },
    {
      "code": "loop_detected.no_progress",
      "domain": "loop_detected",
      "decision": "denied",
      "description": "Execution denied due to loop/no-progress guard."
    },
    {
      "code": "ssrf_block.private_address",
      "domain": "ssrf_block",
      "decision": "denied",
      "description": "Execution denied due to outbound network SSRF policy blocking private address targets."
    },
    {
      "code": "ssrf_block.metadata_endpoint",
      "domain": "ssrf_block",
      "decision": "denied",
      "description": "Execution denied due to outbound network SSRF policy blocking metadata service endpoints."
    },
    {
      "code": "ssrf_block.host_not_allowed",
      "domain": "ssrf_block",
      "decision": "denied",
      "description": "Execution denied because target host failed outbound allowlist policy."
    },
    {
      "code": "ssrf_block.invalid_url",
      "domain": "ssrf_block",
      "decision": "denied",
      "description": "Execution denied because outbound URL was malformed or unsupported."
    },
    {
      "code": "ssrf_block.dns_resolution_failed",
      "domain": "ssrf_block",
      "decision": "denied",
      "description": "Execution denied because DNS resolution for outbound target failed."
    },
    {
      "code": "ssrf_block.dns_pin_mismatch",
      "domain": "ssrf_block",
      "decision": "denied",
      "description": "Execution denied because DNS pinning detected target resolution drift."
    },
    {
      "code": "ssrf_block.redirect_limit_exceeded",
      "domain": "ssrf_block",
      "decision": "denied",
      "description": "Execution denied because outbound redirect chain exceeded configured bound."
    },
    {
      "code": "ssrf_block.redirect_missing_location",
      "domain": "ssrf_block",
      "decision": "denied",
      "description": "Execution denied because redirect response omitted a valid location."
    },
    {
      "code": "ssrf_block.redirect_invalid_location",
      "domain": "ssrf_block",
      "decision": "denied",
      "description": "Execution denied because redirect location was invalid or unsupported."
    },
    {
      "code": "manifest_validation.invalid_schema",
      "domain": "manifest_validation",
      "decision": "denied",
      "description": "Execution denied due to invalid manifest schema."
    },
    {
      "code": "comms_failed.provider_error",
      "domain": "comms_failed",
      "decision": "denied",
      "description": "Comms provider adapter failed to send message."
    },
    {
      "code": "comms_failed.provider_circuit_open",
      "domain": "comms_failed",
      "decision": "denied",
      "description": "Comms provider call denied because provider circuit breaker is open."
    },
    {
      "code": "comms_failed.fallback_exhausted",
      "domain": "comms_failed",
      "decision": "denied",
      "description": "Comms provider call failed and fallback path did not recover."
    },
    {
      "code": "coding_failed.provider_error",
      "domain": "coding_failed",
      "decision": "denied",
      "description": "Coding provider adapter failed to execute operation."
    },
    {
      "code": "coding_failed.provider_circuit_open",
      "domain": "coding_failed",
      "decision": "denied",
      "description": "Coding provider call denied because provider circuit breaker is open."
    }
  ]
}
