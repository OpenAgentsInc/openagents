{
  "version": 3,
  "sources": ["../../../../src/cli/lib/init.ts"],
  "sourcesContent": ["import chalk from \"chalk\";\nimport { Context } from \"../../bundler/context.js\";\nimport { logFinishedStep, logMessage } from \"../../bundler/log.js\";\nimport { DeploymentType } from \"./api.js\";\nimport { writeConvexUrlToEnvFile } from \"./envvars.js\";\nimport { getDashboardUrl } from \"./dashboard.js\";\n\nexport async function finalizeConfiguration(\n  ctx: Context,\n  options: {\n    functionsPath: string;\n    deploymentType: DeploymentType;\n    deploymentName: string;\n    url: string;\n    wroteToGitIgnore: boolean;\n    changedDeploymentEnvVar: boolean;\n  },\n) {\n  const envVarWrite = await writeConvexUrlToEnvFile(ctx, options.url);\n  if (envVarWrite !== null) {\n    logFinishedStep(\n      `${messageForDeploymentType(options.deploymentType, options.url)} and saved its:\\n` +\n        `    name as CONVEX_DEPLOYMENT to .env.local\\n` +\n        `    URL as ${envVarWrite.envVar} to ${envVarWrite.envFile}`,\n    );\n  } else if (options.changedDeploymentEnvVar) {\n    logFinishedStep(\n      `${messageForDeploymentType(options.deploymentType, options.url)} and saved its name as CONVEX_DEPLOYMENT to .env.local`,\n    );\n  }\n  if (options.wroteToGitIgnore) {\n    logMessage(chalk.gray(`  Added \".env.local\" to .gitignore`));\n  }\n  if (options.deploymentType === \"anonymous\") {\n    logMessage(\n      `Run \\`npx convex login\\` at any time to create an account and link this deployment.`,\n    );\n  }\n\n  const anyChanges =\n    options.wroteToGitIgnore ||\n    options.changedDeploymentEnvVar ||\n    envVarWrite !== null;\n  if (anyChanges) {\n    const dashboardUrl = getDashboardUrl(ctx, {\n      deploymentName: options.deploymentName,\n      deploymentType: options.deploymentType,\n    });\n    logMessage(\n      `\\nWrite your Convex functions in ${chalk.bold(options.functionsPath)}\\n` +\n        \"Give us feedback at https://convex.dev/community or support@convex.dev\\n\" +\n        `View the Convex dashboard at ${dashboardUrl}\\n`,\n    );\n  }\n}\n\nfunction messageForDeploymentType(deploymentType: DeploymentType, url: string) {\n  switch (deploymentType) {\n    case \"anonymous\":\n      return `Started running a deployment locally at ${url}`;\n    case \"local\":\n      return `Started running a deployment locally at ${url}`;\n    case \"dev\":\n    case \"prod\":\n    case \"preview\":\n      return `Provisioned a ${deploymentType} deployment`;\n    default: {\n      deploymentType satisfies never;\n      return `Provisioned a ${deploymentType as any} deployment`;\n    }\n  }\n}\n"],
  "mappings": ";AAAA,OAAO,WAAW;AAElB,SAAS,iBAAiB,kBAAkB;AAE5C,SAAS,+BAA+B;AACxC,SAAS,uBAAuB;AAEhC,sBAAsB,sBACpB,KACA,SAQA;AACA,QAAM,cAAc,MAAM,wBAAwB,KAAK,QAAQ,GAAG;AAClE,MAAI,gBAAgB,MAAM;AACxB;AAAA,MACE,GAAG,yBAAyB,QAAQ,gBAAgB,QAAQ,GAAG,CAAC;AAAA;AAAA,aAEhD,YAAY,MAAM,OAAO,YAAY,OAAO;AAAA,IAC9D;AAAA,EACF,WAAW,QAAQ,yBAAyB;AAC1C;AAAA,MACE,GAAG,yBAAyB,QAAQ,gBAAgB,QAAQ,GAAG,CAAC;AAAA,IAClE;AAAA,EACF;AACA,MAAI,QAAQ,kBAAkB;AAC5B,eAAW,MAAM,KAAK,oCAAoC,CAAC;AAAA,EAC7D;AACA,MAAI,QAAQ,mBAAmB,aAAa;AAC1C;AAAA,MACE;AAAA,IACF;AAAA,EACF;AAEA,QAAM,aACJ,QAAQ,oBACR,QAAQ,2BACR,gBAAgB;AAClB,MAAI,YAAY;AACd,UAAM,eAAe,gBAAgB,KAAK;AAAA,MACxC,gBAAgB,QAAQ;AAAA,MACxB,gBAAgB,QAAQ;AAAA,IAC1B,CAAC;AACD;AAAA,MACE;AAAA,iCAAoC,MAAM,KAAK,QAAQ,aAAa,CAAC;AAAA;AAAA,+BAEnC,YAAY;AAAA;AAAA,IAChD;AAAA,EACF;AACF;AAEA,SAAS,yBAAyB,gBAAgC,KAAa;AAC7E,UAAQ,gBAAgB;AAAA,IACtB,KAAK;AACH,aAAO,2CAA2C,GAAG;AAAA,IACvD,KAAK;AACH,aAAO,2CAA2C,GAAG;AAAA,IACvD,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AACH,aAAO,iBAAiB,cAAc;AAAA,IACxC,SAAS;AACP;AACA,aAAO,iBAAiB,cAAqB;AAAA,IAC/C;AAAA,EACF;AACF;",
  "names": []
}
