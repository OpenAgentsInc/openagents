syntax = "proto3";

package openagents.protocol.v1;

// Canonical runtime/control-plane reason taxonomy for policy and guard outcomes.
enum ReasonCode {
  REASON_CODE_UNSPECIFIED = 0;

  REASON_CODE_POLICY_ALLOWED_DEFAULT = 1;

  REASON_CODE_POLICY_DENIED_EXPLICIT_DENY = 100;
  REASON_CODE_POLICY_DENIED_AUTHORIZATION_MISSING = 101;
  REASON_CODE_POLICY_DENIED_INVALID_AUTHORIZATION_MODE = 102;
  REASON_CODE_POLICY_DENIED_BUDGET_EXHAUSTED = 103;
  REASON_CODE_POLICY_DENIED_CONSENT_REQUIRED = 104;
  REASON_CODE_POLICY_DENIED_SUPPRESSED_RECIPIENT = 105;
  REASON_CODE_POLICY_DENIED_AUTHORIZATION_EXPIRED = 106;
  REASON_CODE_POLICY_DENIED_AUTHORIZATION_REVOKED = 107;

  REASON_CODE_LOOP_DETECTED_NO_PROGRESS = 200;
  REASON_CODE_SSRF_BLOCK_PRIVATE_ADDRESS = 300;
  REASON_CODE_SSRF_BLOCK_METADATA_ENDPOINT = 301;
  REASON_CODE_SSRF_BLOCK_HOST_NOT_ALLOWED = 302;
  REASON_CODE_SSRF_BLOCK_INVALID_URL = 303;
  REASON_CODE_SSRF_BLOCK_DNS_RESOLUTION_FAILED = 304;
  REASON_CODE_SSRF_BLOCK_DNS_PIN_MISMATCH = 305;
  REASON_CODE_SSRF_BLOCK_REDIRECT_LIMIT_EXCEEDED = 306;
  REASON_CODE_SSRF_BLOCK_REDIRECT_MISSING_LOCATION = 307;
  REASON_CODE_SSRF_BLOCK_REDIRECT_INVALID_LOCATION = 308;
  REASON_CODE_MANIFEST_VALIDATION_INVALID_SCHEMA = 400;
  REASON_CODE_COMMS_FAILED_PROVIDER_ERROR = 500;
  REASON_CODE_COMMS_FAILED_PROVIDER_CIRCUIT_OPEN = 501;
  REASON_CODE_COMMS_FAILED_FALLBACK_EXHAUSTED = 502;
}
